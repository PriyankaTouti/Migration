GO

/****** Object:  Table [dbo].[MPI_CLONE_LOG]    Script Date: 04-09-2024 12:10:18 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MPI_CLONE_LOG]') AND type in (N'U'))
DROP TABLE [dbo].[MPI_CLONE_LOG]
GO

/****** Object:  Table [dbo].[MPI_CLONE_LOG]    Script Date: 04-09-2024 12:10:18 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MPI_CLONE_LOG](
	[LOGGEDON] [datetime] NULL,
	[USERID] [int] NULL,
	[SQL] [nvarchar](max) NULL,
	[NOTES] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO


CREATE PROC MPI_CLONE_APPLICANT (@USERID INT, @OLDFA INT, @NEWFA INT, @APPLICATIONID INT, @BORROWERTYPE NVARCHAR(32) ) AS            
/*            
  Created On: 22-May-2024; Created By: Shahbaz Shaikh;            
  Details: Clone Applicant and Co-Applicant Data inside newly cloned loan application.     
  EXEC MPI_CLONE_APPLICANT 4981,101790,103095,9472,N'Primary'  
*/            
BEGIN            
              
  /* DECLARING VARIABLES TO BE USED */            
  DECLARE @SUCCESSCOUNT INT, @NEXTID INT,@PRINAME NVARCHAR(100);            
  DECLARE @TODAY DATETIME = GETUTCDATE();            
  DECLARE  @ERRORMESSAGE NVARCHAR(256);        
  TRUNCATE TABLE MPI_CLONE_LOG      
      
  BEGIN TRY      
  BEGIN TRAN      
  /* UPDATING IDLIST FOR APPLICATION */             
  UPDATE IL             
    SET @NEXTID = IL.LASTID + 1,            
     IL.LASTID = LASTID + 1            
  FROM IDLIST IL             
  WHERE IL.OWNERID = 985 AND IL.ITEMID = 403;           
        
  /* BORROWER TYPE */            
  SELECT @BORROWERTYPE = CASE            
   WHEN @BORROWERTYPE = N'Primary' THEN N'P'            
   WHEN @BORROWERTYPE = N'Supporter' THEN N'S'            
   WHEN @BORROWERTYPE = N'Co-Borrower' THEN N'C'            
   ELSE N'C'            
  END;            
            
  /* INSERTING NEW RECORDS INTO APPLICATION TABLE */            
  INSERT INTO APPLICATION (OWNERID, APPLICATIONID,            
    FIRSTNAME, MIDDLENAME, LASTNAME, PRODUCTID,            
    ASSIGNTOID, STATUSCODEID, PHONE, MOBILE, OFFICEPHONE,            
    CURRENTOWNERID, EMAIL, COMMENTS, TERRITORYID, ADDRESS, COUNTRY, STATE, ZIPCODE, CITY, LOCALITY,            
 LASTVIEWEDBY, STATUSID, RATINGID, SALUATIONID, EMPLOYEESTRENGTHID,            
 CREATEDBY, SUBJECT, LAYOUTID, PROCESSID, CREATEDON,            
 LASTMODIFIEDBY, LASTMODIFIEDON, CREATEDBYTYPE, LASTMODIFIEDBYTYPE, ESCALATEDON, LASTACTIONID, ESCALATEDCOUNT, OPENESCALATEDCOUNT,            
 PREVIOUSSTATUSCODEID, STATUSCODECHANGEDON, IMPORTCYCLEID, UNIQUEID,            
    APPLICATIONNAME, ACCOUNTID, ACCOUNTNAME, ISESCALATED, IPADDRESS, SUFFIXID, CAMPAIGNID, INTEGRATIONTASKID,            
    SCHEMEID, PARENTID, RELATEDTOID, RELATEDTONAME, RELATEDTOTYPEID)            
  SELECT LT.OWNERID, @NEXTID,            
    LT.FIRSTNAME, LT.MIDDLENAME, LT.LASTNAME, LT.PRODUCTID,            
    @USERID, 100017/*IDE*/, LT.PHONE, LT.MOBILE, LT.OFFICEPHONE,            
    @USERID, LT.EMAIL, LT.COMMENTS, LT.TERRITORYID, LT.ADDRESS, LT.COUNTRY, LT.STATE, LT.ZIPCODE, LT.CITY, LT.LOCALITY,            
    @USERID, LT.STATUSID, LT.RATINGID, LT.SALUATIONID, LT.EMPLOYEESTRENGTHID,            
 @USERID, LT.SUBJECT, LT.LAYOUTID, LT.PROCESSID, @TODAY,             
 @USERID, @TODAY, LT.CREATEDBYTYPE, LT.LASTMODIFIEDBYTYPE, LT.ESCALATEDON, LT.LASTACTIONID, LT.ESCALATEDCOUNT, LT.OPENESCALATEDCOUNT,            
    LT.PREVIOUSSTATUSCODEID, LT.STATUSCODECHANGEDON, LT.IMPORTCYCLEID, LT.UNIQUEID,            
    LT.APPLICATIONNAME, LT.ACCOUNTID, LT.ACCOUNTNAME, LT.ISESCALATED, LT.IPADDRESS, LT.SUFFIXID, LT.CAMPAIGNID, LT.INTEGRATIONTASKID,            
    LT.SCHEMEID, LT.PARENTID, @NEWFA, LT.RELATEDTONAME, LT.RELATEDTOTYPEID            
  FROM APPLICATION (NOLOCK) LT            
  WHERE LT.OWNERID = 985            
    AND LT.APPLICATIONID = @APPLICATIONID;            
            
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES */            
  INSERT INTO APL_EX1( OWNERID, APL_EX1_ID,            
    APL_EX1_1, APL_EX1_2, APL_EX1_3, APL_EX1_4, APL_EX1_5, APL_EX1_6, APL_EX1_7, APL_EX1_8, APL_EX1_9, APL_EX1_10,            
    APL_EX1_11, APL_EX1_12, APL_EX1_13, APL_EX1_14, APL_EX1_15, APL_EX1_16, APL_EX1_17, APL_EX1_18, APL_EX1_19, APL_EX1_20,            
    APL_EX1_21, APL_EX1_22, APL_EX1_23, APL_EX1_24, APL_EX1_25, APL_EX1_26, APL_EX1_27, APL_EX1_28, APL_EX1_29, APL_EX1_30,            
    APL_EX1_31, APL_EX1_32, APL_EX1_33, APL_EX1_34, APL_EX1_35, APL_EX1_36, APL_EX1_37, APL_EX1_38, APL_EX1_39, APL_EX1_40,            
    APL_EX1_41, APL_EX1_42, APL_EX1_43, APL_EX1_44, APL_EX1_45, APL_EX1_46, APL_EX1_47, APL_EX1_48, APL_EX1_49, APL_EX1_50,            
    APL_EX1_51, APL_EX1_52, APL_EX1_53, APL_EX1_54, APL_EX1_55, APL_EX1_56, APL_EX1_57, APL_EX1_58, APL_EX1_59, APL_EX1_60,            
    APL_EX1_61, APL_EX1_62, APL_EX1_63, APL_EX1_64, APL_EX1_65, APL_EX1_66, APL_EX1_67, APL_EX1_68, APL_EX1_69, APL_EX1_70,          
    APL_EX1_71, APL_EX1_72, APL_EX1_73, APL_EX1_74, APL_EX1_75, APL_EX1_76, APL_EX1_77, APL_EX1_78, APL_EX1_79, APL_EX1_80,            
    APL_EX1_81, APL_EX1_82, APL_EX1_83, APL_EX1_84, APL_EX1_85, APL_EX1_86, APL_EX1_87, APL_EX1_88, APL_EX1_89, APL_EX1_90,            
    APL_EX1_91, APL_EX1_92, APL_EX1_93, APL_EX1_94, APL_EX1_95, APL_EX1_96, APL_EX1_97, APL_EX1_98, APL_EX1_99, APL_EX1_100,            
    APL_EX1_101, APL_EX1_102, APL_EX1_103, APL_EX1_104, APL_EX1_105, APL_EX1_106, APL_EX1_107, APL_EX1_108, APL_EX1_109, APL_EX1_110,            
    APL_EX1_111, APL_EX1_112, APL_EX1_113, APL_EX1_114, APL_EX1_115, APL_EX1_116, APL_EX1_117, APL_EX1_118, APL_EX1_119, APL_EX1_120,            
    APL_EX1_121, APL_EX1_122, APL_EX1_123, APL_EX1_124, APL_EX1_125, APL_EX1_126, APL_EX1_127, APL_EX1_128, APL_EX1_129, APL_EX1_130,            
    APL_EX1_131, APL_EX1_132, APL_EX1_133, APL_EX1_134, APL_EX1_135, APL_EX1_136, APL_EX1_137, APL_EX1_138, APL_EX1_139, APL_EX1_140,            
    APL_EX1_141, APL_EX1_142, APL_EX1_143, APL_EX1_144, APL_EX1_145, APL_EX1_146, APL_EX1_147, APL_EX1_148, APL_EX1_149, APL_EX1_150)            
  SELECT E1.OWNERID, @NEXTID,            
 E1.APL_EX1_1, E1.APL_EX1_2, E1.APL_EX1_3, E1.APL_EX1_4, E1.APL_EX1_5, E1.APL_EX1_6, E1.APL_EX1_7, E1.APL_EX1_8, E1.APL_EX1_9, E1.APL_EX1_10,            
    E1.APL_EX1_11, E1.APL_EX1_12, E1.APL_EX1_13, E1.APL_EX1_14, E1.APL_EX1_15, E1.APL_EX1_16, E1.APL_EX1_17, E1.APL_EX1_18, E1.APL_EX1_19, E1.APL_EX1_20,            
    E1.APL_EX1_21, E1.APL_EX1_22, E1.APL_EX1_23, E1.APL_EX1_24, E1.APL_EX1_25, E1.APL_EX1_26, E1.APL_EX1_27, E1.APL_EX1_28, E1.APL_EX1_29, E1.APL_EX1_30,            
    E1.APL_EX1_31, E1.APL_EX1_32, E1.APL_EX1_33, E1.APL_EX1_34, E1.APL_EX1_35, E1.APL_EX1_36, E1.APL_EX1_37, E1.APL_EX1_38, E1.APL_EX1_39, E1.APL_EX1_40,            
    E1.APL_EX1_41, E1.APL_EX1_42, E1.APL_EX1_43, E1.APL_EX1_44, E1.APL_EX1_45, E1.APL_EX1_46, E1.APL_EX1_47, E1.APL_EX1_48, E1.APL_EX1_49, E1.APL_EX1_50,            
    E1.APL_EX1_51, E1.APL_EX1_52, @BORROWERTYPE, E1.APL_EX1_54, E1.APL_EX1_55, E1.APL_EX1_56, E1.APL_EX1_57, E1.APL_EX1_58, E1.APL_EX1_59, E1.APL_EX1_60,            
    E1.APL_EX1_61, E1.APL_EX1_62, E1.APL_EX1_63, E1.APL_EX1_64, E1.APL_EX1_65, E1.APL_EX1_66, E1.APL_EX1_67, E1.APL_EX1_68, E1.APL_EX1_69, E1.APL_EX1_70,            
    E1.APL_EX1_71, E1.APL_EX1_72, E1.APL_EX1_73, E1.APL_EX1_74, E1.APL_EX1_75, E1.APL_EX1_76, E1.APL_EX1_77, E1.APL_EX1_78, E1.APL_EX1_79, E1.APL_EX1_80,            
    E1.APL_EX1_81, E1.APL_EX1_82, E1.APL_EX1_83, E1.APL_EX1_84, E1.APL_EX1_85, E1.APL_EX1_86, E1.APL_EX1_87, E1.APL_EX1_88, E1.APL_EX1_89, E1.APL_EX1_90,            
    E1.APL_EX1_91, E1.APL_EX1_92, E1.APL_EX1_93, E1.APL_EX1_94, E1.APL_EX1_95, E1.APL_EX1_96, E1.APL_EX1_97, E1.APL_EX1_98, E1.APL_EX1_99, E1.APL_EX1_100,            
    E1.APL_EX1_101, E1.APL_EX1_102, E1.APL_EX1_103, E1.APL_EX1_104, E1.APL_EX1_105, E1.APL_EX1_106, E1.APL_EX1_107, E1.APL_EX1_108, E1.APL_EX1_109, E1.APL_EX1_110,            
    E1.APL_EX1_111, E1.APL_EX1_112, E1.APL_EX1_113, E1.APL_EX1_114, E1.APL_EX1_115, E1.APL_EX1_116, E1.APL_EX1_117, E1.APL_EX1_118, E1.APL_EX1_119, E1.APL_EX1_120,            
    E1.APL_EX1_121, E1.APL_EX1_122, E1.APL_EX1_123, E1.APL_EX1_124, E1.APL_EX1_125, E1.APL_EX1_126, E1.APL_EX1_127, E1.APL_EX1_128, E1.APL_EX1_129, E1.APL_EX1_130,            
    E1.APL_EX1_131, E1.APL_EX1_132, E1.APL_EX1_133, E1.APL_EX1_134, E1.APL_EX1_135, E1.APL_EX1_136, E1.APL_EX1_137, E1.APL_EX1_138, E1.APL_EX1_139, E1.APL_EX1_140,            
    E1.APL_EX1_141, E1.APL_EX1_142, E1.APL_EX1_143, E1.APL_EX1_144, E1.APL_EX1_145, E1.APL_EX1_146, E1.APL_EX1_147, E1.APL_EX1_148, E1.APL_EX1_149, E1.APL_EX1_150            
  FROM APL_EX1 (NOLOCK) E1                 
  WHERE E1.OWNERID = 985            
    AND E1.APL_EX1_ID = @APPLICATIONID;            
            
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES */            
  INSERT INTO APL_EX2( OWNERID, APL_EX2_ID,            
    APL_EX2_1, APL_EX2_2, APL_EX2_3, APL_EX2_4, APL_EX2_5, APL_EX2_6, APL_EX2_7, APL_EX2_8, APL_EX2_9, APL_EX2_10,            APL_EX2_11, APL_EX2_12, APL_EX2_13, APL_EX2_14, APL_EX2_15, APL_EX2_16, APL_EX2_17, APL_EX2_18, APL_EX2_19, APL_EX2_20,          
  
  
  
  
   
   
    APL_EX2_21, APL_EX2_22, APL_EX2_23, APL_EX2_24, APL_EX2_25, APL_EX2_26, APL_EX2_27, APL_EX2_28, APL_EX2_29, APL_EX2_30,            
    APL_EX2_31, APL_EX2_32, APL_EX2_33, APL_EX2_34, APL_EX2_35, APL_EX2_36, APL_EX2_37, APL_EX2_38, APL_EX2_39, APL_EX2_40,            
    APL_EX2_41, APL_EX2_42, APL_EX2_43, APL_EX2_44, APL_EX2_45, APL_EX2_46, APL_EX2_47, APL_EX2_48, APL_EX2_49, APL_EX2_50,            
    APL_EX2_51, APL_EX2_52, APL_EX2_53, APL_EX2_54, APL_EX2_55, APL_EX2_56, APL_EX2_57, APL_EX2_58, APL_EX2_59, APL_EX2_60,            
    APL_EX2_61, APL_EX2_62, APL_EX2_63, APL_EX2_64, APL_EX2_65, APL_EX2_66, APL_EX2_67, APL_EX2_68, APL_EX2_69, APL_EX2_70,            
    APL_EX2_71, APL_EX2_72, APL_EX2_73, APL_EX2_74, APL_EX2_75, APL_EX2_76, APL_EX2_77, APL_EX2_78, APL_EX2_79, APL_EX2_80,            
    APL_EX2_81, APL_EX2_82, APL_EX2_83, APL_EX2_84, APL_EX2_85, APL_EX2_86, APL_EX2_87, APL_EX2_88, APL_EX2_89, APL_EX2_90,            
    APL_EX2_91, APL_EX2_92, APL_EX2_93, APL_EX2_94, APL_EX2_95, APL_EX2_96, APL_EX2_97, APL_EX2_98, APL_EX2_99, APL_EX2_100,            
    APL_EX2_101, APL_EX2_102, APL_EX2_103, APL_EX2_104, APL_EX2_105, APL_EX2_106, APL_EX2_107, APL_EX2_108, APL_EX2_109, APL_EX2_110,            
    APL_EX2_111, APL_EX2_112, APL_EX2_113, APL_EX2_114, APL_EX2_115, APL_EX2_116, APL_EX2_117, APL_EX2_118, APL_EX2_119, APL_EX2_120,            
    APL_EX2_121, APL_EX2_122, APL_EX2_123, APL_EX2_124, APL_EX2_125, APL_EX2_126, APL_EX2_127, APL_EX2_128, APL_EX2_129, APL_EX2_130,            
    APL_EX2_131, APL_EX2_132, APL_EX2_133, APL_EX2_134, APL_EX2_135, APL_EX2_136, APL_EX2_137, APL_EX2_138, APL_EX2_139, APL_EX2_140,            
    APL_EX2_141, APL_EX2_142, APL_EX2_143, APL_EX2_144, APL_EX2_145, APL_EX2_146, APL_EX2_147, APL_EX2_148, APL_EX2_149, APL_EX2_150)            
  SELECT E2.OWNERID, @NEXTID,            
 E2.APL_EX2_1, E2.APL_EX2_2, E2.APL_EX2_3, E2.APL_EX2_4, E2.APL_EX2_5, E2.APL_EX2_6, E2.APL_EX2_7, E2.APL_EX2_8, E2.APL_EX2_9, E2.APL_EX2_10,            
    E2.APL_EX2_11, E2.APL_EX2_12, E2.APL_EX2_13, E2.APL_EX2_14, E2.APL_EX2_15, E2.APL_EX2_16, E2.APL_EX2_17, E2.APL_EX2_18, E2.APL_EX2_19, E2.APL_EX2_20,            
    E2.APL_EX2_21, E2.APL_EX2_22, E2.APL_EX2_23, E2.APL_EX2_24, E2.APL_EX2_25, E2.APL_EX2_26, E2.APL_EX2_27, E2.APL_EX2_28, E2.APL_EX2_29, E2.APL_EX2_30,            
    E2.APL_EX2_31, E2.APL_EX2_32, E2.APL_EX2_33, E2.APL_EX2_34, E2.APL_EX2_35, E2.APL_EX2_36, E2.APL_EX2_37, E2.APL_EX2_38, E2.APL_EX2_39, E2.APL_EX2_40,            
    E2.APL_EX2_41, E2.APL_EX2_42, E2.APL_EX2_43, E2.APL_EX2_44, E2.APL_EX2_45, E2.APL_EX2_46, E2.APL_EX2_47, E2.APL_EX2_48, E2.APL_EX2_49, E2.APL_EX2_50,            
    E2.APL_EX2_51, E2.APL_EX2_52, E2.APL_EX2_53, E2.APL_EX2_54, E2.APL_EX2_55, E2.APL_EX2_56, E2.APL_EX2_57, E2.APL_EX2_58, E2.APL_EX2_59, E2.APL_EX2_60,            
    E2.APL_EX2_61, E2.APL_EX2_62, E2.APL_EX2_63, E2.APL_EX2_64, E2.APL_EX2_65, E2.APL_EX2_66, E2.APL_EX2_67, E2.APL_EX2_68, E2.APL_EX2_69, E2.APL_EX2_70,            
    E2.APL_EX2_71, E2.APL_EX2_72, E2.APL_EX2_73, E2.APL_EX2_74, E2.APL_EX2_75, E2.APL_EX2_76, E2.APL_EX2_77, E2.APL_EX2_78, E2.APL_EX2_79, E2.APL_EX2_80,            
    E2.APL_EX2_81, E2.APL_EX2_82, E2.APL_EX2_83, E2.APL_EX2_84, E2.APL_EX2_85, E2.APL_EX2_86, E2.APL_EX2_87, E2.APL_EX2_88, E2.APL_EX2_89, E2.APL_EX2_90,            
    E2.APL_EX2_91, E2.APL_EX2_92, E2.APL_EX2_93, E2.APL_EX2_94, E2.APL_EX2_95, E2.APL_EX2_96, E2.APL_EX2_97, E2.APL_EX2_98, E2.APL_EX2_99, E2.APL_EX2_100,            
    E2.APL_EX2_101, E2.APL_EX2_102, E2.APL_EX2_103, E2.APL_EX2_104, E2.APL_EX2_105, E2.APL_EX2_106, E2.APL_EX2_107, E2.APL_EX2_108, E2.APL_EX2_109, E2.APL_EX2_110,            
    E2.APL_EX2_111, E2.APL_EX2_112, E2.APL_EX2_113, E2.APL_EX2_114, E2.APL_EX2_115, E2.APL_EX2_116, E2.APL_EX2_117, E2.APL_EX2_118, E2.APL_EX2_119, E2.APL_EX2_120,            
    E2.APL_EX2_121, E2.APL_EX2_122, E2.APL_EX2_123, E2.APL_EX2_124, E2.APL_EX2_125, E2.APL_EX2_126, E2.APL_EX2_127, E2.APL_EX2_128, E2.APL_EX2_129, E2.APL_EX2_130,            
    E2.APL_EX2_131, E2.APL_EX2_132, E2.APL_EX2_133, E2.APL_EX2_134, E2.APL_EX2_135, E2.APL_EX2_136, E2.APL_EX2_137, E2.APL_EX2_138, E2.APL_EX2_139, E2.APL_EX2_140,            
    E2.APL_EX2_141, E2.APL_EX2_142, E2.APL_EX2_143, E2.APL_EX2_144, E2.APL_EX2_145, E2.APL_EX2_146, E2.APL_EX2_147, E2.APL_EX2_148, E2.APL_EX2_149, E2.APL_EX2_150            
  FROM APL_EX2 (NOLOCK) E2                 
  WHERE E2.OWNERID = 985            
    AND E2.APL_EX2_ID = @APPLICATIONID;            
            
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES 3*/            
  INSERT INTO APL_EX3( OWNERID, APL_EX3_ID,            
    APL_EX3_1, APL_EX3_2, APL_EX3_3, APL_EX3_4, APL_EX3_5, APL_EX3_6, APL_EX3_7, APL_EX3_8, APL_EX3_9, APL_EX3_10,            
    APL_EX3_11, APL_EX3_12, APL_EX3_13, APL_EX3_14, APL_EX3_15, APL_EX3_16, APL_EX3_17, APL_EX3_18, APL_EX3_19, APL_EX3_20,            
    APL_EX3_21, APL_EX3_22, APL_EX3_23, APL_EX3_24, APL_EX3_25, APL_EX3_26, APL_EX3_27, APL_EX3_28, APL_EX3_29, APL_EX3_30,            
    APL_EX3_31, APL_EX3_32, APL_EX3_33, APL_EX3_34, APL_EX3_35, APL_EX3_36, APL_EX3_37, APL_EX3_38, APL_EX3_39, APL_EX3_40,            
    APL_EX3_41, APL_EX3_42, APL_EX3_43, APL_EX3_44, APL_EX3_45, APL_EX3_46, APL_EX3_47, APL_EX3_48, APL_EX3_49, APL_EX3_50,            
    APL_EX3_51, APL_EX3_52, APL_EX3_53, APL_EX3_54, APL_EX3_55, APL_EX3_56, APL_EX3_57, APL_EX3_58, APL_EX3_59, APL_EX3_60,            
    APL_EX3_61, APL_EX3_62, APL_EX3_63, APL_EX3_64, APL_EX3_65, APL_EX3_66, APL_EX3_67, APL_EX3_68, APL_EX3_69, APL_EX3_70,            
    APL_EX3_71, APL_EX3_72, APL_EX3_73, APL_EX3_74, APL_EX3_75, APL_EX3_76, APL_EX3_77, APL_EX3_78, APL_EX3_79, APL_EX3_80,            
    APL_EX3_81, APL_EX3_82, APL_EX3_83, APL_EX3_84, APL_EX3_85, APL_EX3_86, APL_EX3_87, APL_EX3_88, APL_EX3_89, APL_EX3_90,            
    APL_EX3_91, APL_EX3_92, APL_EX3_93, APL_EX3_94, APL_EX3_95, APL_EX3_96, APL_EX3_97, APL_EX3_98, APL_EX3_99, APL_EX3_100,            
    APL_EX3_101, APL_EX3_102, APL_EX3_103, APL_EX3_104, APL_EX3_105, APL_EX3_106, APL_EX3_107, APL_EX3_108, APL_EX3_109, APL_EX3_110,            
    APL_EX3_111, APL_EX3_112, APL_EX3_113, APL_EX3_114, APL_EX3_115, APL_EX3_116, APL_EX3_117, APL_EX3_118, APL_EX3_119, APL_EX3_120,            
    APL_EX3_121, APL_EX3_122, APL_EX3_123, APL_EX3_124, APL_EX3_125, APL_EX3_126, APL_EX3_127, APL_EX3_128, APL_EX3_129, APL_EX3_130,            
    APL_EX3_131, APL_EX3_132, APL_EX3_133, APL_EX3_134, APL_EX3_135, APL_EX3_136, APL_EX3_137, APL_EX3_138, APL_EX3_139, APL_EX3_140,            
    APL_EX3_141, APL_EX3_142, APL_EX3_143, APL_EX3_144, APL_EX3_145, APL_EX3_146, APL_EX3_147, APL_EX3_148, APL_EX3_149, APL_EX3_150)            
  SELECT E3.OWNERID, @NEXTID,            
 E3.APL_EX3_1, E3.APL_EX3_2, E3.APL_EX3_3, E3.APL_EX3_4, E3.APL_EX3_5, E3.APL_EX3_6, E3.APL_EX3_7, E3.APL_EX3_8, E3.APL_EX3_9, E3.APL_EX3_10,            
    E3.APL_EX3_11, E3.APL_EX3_12, E3.APL_EX3_13, E3.APL_EX3_14, E3.APL_EX3_15, E3.APL_EX3_16, E3.APL_EX3_17, E3.APL_EX3_18, E3.APL_EX3_19, E3.APL_EX3_20,            
    E3.APL_EX3_21, E3.APL_EX3_22, E3.APL_EX3_23, E3.APL_EX3_24, E3.APL_EX3_25, E3.APL_EX3_26, E3.APL_EX3_27, E3.APL_EX3_28, E3.APL_EX3_29, E3.APL_EX3_30,            
    E3.APL_EX3_31, E3.APL_EX3_32, E3.APL_EX3_33, E3.APL_EX3_34, E3.APL_EX3_35, E3.APL_EX3_36, E3.APL_EX3_37, E3.APL_EX3_38, E3.APL_EX3_39, E3.APL_EX3_40,            
    E3.APL_EX3_41, E3.APL_EX3_42, E3.APL_EX3_43, E3.APL_EX3_44, E3.APL_EX3_45, E3.APL_EX3_46, E3.APL_EX3_47, E3.APL_EX3_48, E3.APL_EX3_49, E3.APL_EX3_50,            
    E3.APL_EX3_51, E3.APL_EX3_52, E3.APL_EX3_53, E3.APL_EX3_54, E3.APL_EX3_55, E3.APL_EX3_56, E3.APL_EX3_57, E3.APL_EX3_58, E3.APL_EX3_59, E3.APL_EX3_60,            
    E3.APL_EX3_61, E3.APL_EX3_62, E3.APL_EX3_63, E3.APL_EX3_64, E3.APL_EX3_65, E3.APL_EX3_66, E3.APL_EX3_67, E3.APL_EX3_68, E3.APL_EX3_69, E3.APL_EX3_70,            
    E3.APL_EX3_71, E3.APL_EX3_72, E3.APL_EX3_73, E3.APL_EX3_74, E3.APL_EX3_75, E3.APL_EX3_76, E3.APL_EX3_77, E3.APL_EX3_78, E3.APL_EX3_79, E3.APL_EX3_80,            
    E3.APL_EX3_81, E3.APL_EX3_82, E3.APL_EX3_83, E3.APL_EX3_84, E3.APL_EX3_85, E3.APL_EX3_86, E3.APL_EX3_87, E3.APL_EX3_88, E3.APL_EX3_89, E3.APL_EX3_90,            
    E3.APL_EX3_91, E3.APL_EX3_92, E3.APL_EX3_93, E3.APL_EX3_94, E3.APL_EX3_95, E3.APL_EX3_96, E3.APL_EX3_97, E3.APL_EX3_98, E3.APL_EX3_99, E3.APL_EX3_100,            
    E3.APL_EX3_101, E3.APL_EX3_102, E3.APL_EX3_103, E3.APL_EX3_104, E3.APL_EX3_105, E3.APL_EX3_106, E3.APL_EX3_107, E3.APL_EX3_108, E3.APL_EX3_109, E3.APL_EX3_110,            
    E3.APL_EX3_111, E3.APL_EX3_112, E3.APL_EX3_113, E3.APL_EX3_114, E3.APL_EX3_115, E3.APL_EX3_116, E3.APL_EX3_117, E3.APL_EX3_118, E3.APL_EX3_119, E3.APL_EX3_120,            
    E3.APL_EX3_121, E3.APL_EX3_122, E3.APL_EX3_123, E3.APL_EX3_124, E3.APL_EX3_125, E3.APL_EX3_126, E3.APL_EX3_127, E3.APL_EX3_128, E3.APL_EX3_129, E3.APL_EX3_130,            
    E3.APL_EX3_131, E3.APL_EX3_132, E3.APL_EX3_133, E3.APL_EX3_134, E3.APL_EX3_135, E3.APL_EX3_136, E3.APL_EX3_137, E3.APL_EX3_138, E3.APL_EX3_139, E3.APL_EX3_140,            
    E3.APL_EX3_141, E3.APL_EX3_142, E3.APL_EX3_143, E3.APL_EX3_144, E3.APL_EX3_145, E3.APL_EX3_146, E3.APL_EX3_147, E3.APL_EX3_148, E3.APL_EX3_149, E3.APL_EX3_150            
  FROM APL_EX3 (NOLOCK) E3                
  WHERE E3.OWNERID = 985            
    AND E3.APL_EX3_ID = @APPLICATIONID;            
            
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES 4*/            
  INSERT INTO APL_EX4( OWNERID, APL_EX4_ID,            
    APL_EX4_1, APL_EX4_2, APL_EX4_3, APL_EX4_4, APL_EX4_5, APL_EX4_6, APL_EX4_7, APL_EX4_8, APL_EX4_9, APL_EX4_10,            
    APL_EX4_11, APL_EX4_12, APL_EX4_13, APL_EX4_14, APL_EX4_15, APL_EX4_16, APL_EX4_17, APL_EX4_18, APL_EX4_19, APL_EX4_20,            
    APL_EX4_21, APL_EX4_22, APL_EX4_23, APL_EX4_24, APL_EX4_25, APL_EX4_26, APL_EX4_27, APL_EX4_28, APL_EX4_29, APL_EX4_30,            
    APL_EX4_31, APL_EX4_32, APL_EX4_33, APL_EX4_34, APL_EX4_35, APL_EX4_36, APL_EX4_37, APL_EX4_38, APL_EX4_39, APL_EX4_40,            
    APL_EX4_41, APL_EX4_42, APL_EX4_43, APL_EX4_44, APL_EX4_45, APL_EX4_46, APL_EX4_47, APL_EX4_48, APL_EX4_49, APL_EX4_50,            
    APL_EX4_51, APL_EX4_52, APL_EX4_53, APL_EX4_54, APL_EX4_55, APL_EX4_56, APL_EX4_57, APL_EX4_58, APL_EX4_59, APL_EX4_60,            
    APL_EX4_61, APL_EX4_62, APL_EX4_63, APL_EX4_64, APL_EX4_65, APL_EX4_66, APL_EX4_67, APL_EX4_68, APL_EX4_69, APL_EX4_70,            
    APL_EX4_71, APL_EX4_72, APL_EX4_73, APL_EX4_74, APL_EX4_75, APL_EX4_76, APL_EX4_77, APL_EX4_78, APL_EX4_79, APL_EX4_80,            
    APL_EX4_81, APL_EX4_82, APL_EX4_83, APL_EX4_84, APL_EX4_85, APL_EX4_86, APL_EX4_87, APL_EX4_88, APL_EX4_89, APL_EX4_90,            
    APL_EX4_91, APL_EX4_92, APL_EX4_93, APL_EX4_94, APL_EX4_95, APL_EX4_96, APL_EX4_97, APL_EX4_98, APL_EX4_99, APL_EX4_100,            
    APL_EX4_101, APL_EX4_102, APL_EX4_103, APL_EX4_104, APL_EX4_105, APL_EX4_106, APL_EX4_107, APL_EX4_108, APL_EX4_109, APL_EX4_110,            
    APL_EX4_111, APL_EX4_112, APL_EX4_113, APL_EX4_114, APL_EX4_115, APL_EX4_116, APL_EX4_117, APL_EX4_118, APL_EX4_119, APL_EX4_120,            
    APL_EX4_121, APL_EX4_122, APL_EX4_123, APL_EX4_124, APL_EX4_125, APL_EX4_126, APL_EX4_127, APL_EX4_128, APL_EX4_129, APL_EX4_130,            
    APL_EX4_131, APL_EX4_132, APL_EX4_133, APL_EX4_134, APL_EX4_135, APL_EX4_136, APL_EX4_137, APL_EX4_138, APL_EX4_139, APL_EX4_140,            
    APL_EX4_141, APL_EX4_142, APL_EX4_143, APL_EX4_144, APL_EX4_145, APL_EX4_146, APL_EX4_147, APL_EX4_148, APL_EX4_149, APL_EX4_150)            
  SELECT E4.OWNERID, @NEXTID,            
 E4.APL_EX4_1, E4.APL_EX4_2, E4.APL_EX4_3, E4.APL_EX4_4, E4.APL_EX4_5, E4.APL_EX4_6, E4.APL_EX4_7, E4.APL_EX4_8, E4.APL_EX4_9, E4.APL_EX4_10,            
    E4.APL_EX4_11, E4.APL_EX4_12, E4.APL_EX4_13, E4.APL_EX4_14, E4.APL_EX4_15, E4.APL_EX4_16, E4.APL_EX4_17, E4.APL_EX4_18, E4.APL_EX4_19, E4.APL_EX4_20,            
    E4.APL_EX4_21, E4.APL_EX4_22, E4.APL_EX4_23, E4.APL_EX4_24, E4.APL_EX4_25, E4.APL_EX4_26, E4.APL_EX4_27, E4.APL_EX4_28, E4.APL_EX4_29, E4.APL_EX4_30,            
    E4.APL_EX4_31, E4.APL_EX4_32, E4.APL_EX4_33, E4.APL_EX4_34, E4.APL_EX4_35, E4.APL_EX4_36, E4.APL_EX4_37, E4.APL_EX4_38, E4.APL_EX4_39, E4.APL_EX4_40,            
    E4.APL_EX4_41, E4.APL_EX4_42, E4.APL_EX4_43, E4.APL_EX4_44, E4.APL_EX4_45, E4.APL_EX4_46, E4.APL_EX4_47, E4.APL_EX4_48, E4.APL_EX4_49, E4.APL_EX4_50,            
    E4.APL_EX4_51, E4.APL_EX4_52, E4.APL_EX4_53, E4.APL_EX4_54, E4.APL_EX4_55, E4.APL_EX4_56, E4.APL_EX4_57, E4.APL_EX4_58, E4.APL_EX4_59, E4.APL_EX4_60,            
    E4.APL_EX4_61, E4.APL_EX4_62, E4.APL_EX4_63, E4.APL_EX4_64, E4.APL_EX4_65, E4.APL_EX4_66, E4.APL_EX4_67, E4.APL_EX4_68, E4.APL_EX4_69, E4.APL_EX4_70,            
    E4.APL_EX4_71, E4.APL_EX4_72, E4.APL_EX4_73, E4.APL_EX4_74, E4.APL_EX4_75, E4.APL_EX4_76, E4.APL_EX4_77, E4.APL_EX4_78, E4.APL_EX4_79, E4.APL_EX4_80,            
    E4.APL_EX4_81, E4.APL_EX4_82, E4.APL_EX4_83, E4.APL_EX4_84, E4.APL_EX4_85, E4.APL_EX4_86, E4.APL_EX4_87, E4.APL_EX4_88, E4.APL_EX4_89, E4.APL_EX4_90,            
    E4.APL_EX4_91, E4.APL_EX4_92, E4.APL_EX4_93, E4.APL_EX4_94, E4.APL_EX4_95, E4.APL_EX4_96, E4.APL_EX4_97, E4.APL_EX4_98, E4.APL_EX4_99, E4.APL_EX4_100,            
    E4.APL_EX4_101, E4.APL_EX4_102, E4.APL_EX4_103, E4.APL_EX4_104, E4.APL_EX4_105, E4.APL_EX4_106, E4.APL_EX4_107, E4.APL_EX4_108, E4.APL_EX4_109, E4.APL_EX4_110,            
    E4.APL_EX4_111, E4.APL_EX4_112, E4.APL_EX4_113, E4.APL_EX4_114, E4.APL_EX4_115, E4.APL_EX4_116, E4.APL_EX4_117, E4.APL_EX4_118, E4.APL_EX4_119, E4.APL_EX4_120,            
    E4.APL_EX4_121, E4.APL_EX4_122, E4.APL_EX4_123, E4.APL_EX4_124, E4.APL_EX4_125, E4.APL_EX4_126, E4.APL_EX4_127, E4.APL_EX4_128, E4.APL_EX4_129, E4.APL_EX4_130,            
    E4.APL_EX4_131, E4.APL_EX4_132, E4.APL_EX4_133, E4.APL_EX4_134, E4.APL_EX4_135, E4.APL_EX4_136, E4.APL_EX4_137, E4.APL_EX4_138, E4.APL_EX4_139, E4.APL_EX4_140,            
    E4.APL_EX4_141, E4.APL_EX4_142, E4.APL_EX4_143, E4.APL_EX4_144, E4.APL_EX4_145, E4.APL_EX4_146, E4.APL_EX4_147, E4.APL_EX4_148, E4.APL_EX4_149, E4.APL_EX4_150            
  FROM APL_EX4 (NOLOCK) E4                
  WHERE E4.OWNERID = 985            
    AND E4.APL_EX4_ID = @APPLICATIONID;            
            
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES 5*/            
  INSERT INTO APL_EX5(OWNERID, APL_EX5_ID,            
    APL_EX5_1, APL_EX5_2, APL_EX5_3, APL_EX5_4, APL_EX5_5, APL_EX5_6, APL_EX5_7, APL_EX5_8, APL_EX5_9, APL_EX5_10,            
    APL_EX5_11, APL_EX5_12, APL_EX5_13, APL_EX5_14, APL_EX5_15, APL_EX5_16, APL_EX5_17, APL_EX5_18, APL_EX5_19, APL_EX5_20,            
    APL_EX5_21, APL_EX5_22, APL_EX5_23, APL_EX5_24, APL_EX5_25, APL_EX5_26, APL_EX5_27, APL_EX5_28, APL_EX5_29, APL_EX5_30,            
    APL_EX5_31, APL_EX5_32, APL_EX5_33, APL_EX5_34, APL_EX5_35, APL_EX5_36, APL_EX5_37, APL_EX5_38, APL_EX5_39, APL_EX5_40,            
    APL_EX5_41, APL_EX5_42, APL_EX5_43, APL_EX5_44, APL_EX5_45, APL_EX5_46, APL_EX5_47, APL_EX5_48, APL_EX5_49, APL_EX5_50,            
    APL_EX5_51, APL_EX5_52, APL_EX5_53, APL_EX5_54, APL_EX5_55, APL_EX5_56, APL_EX5_57, APL_EX5_58, APL_EX5_59, APL_EX5_60,            
    APL_EX5_61, APL_EX5_62, APL_EX5_63, APL_EX5_64, APL_EX5_65, APL_EX5_66, APL_EX5_67, APL_EX5_68, APL_EX5_69, APL_EX5_70,            
    APL_EX5_71, APL_EX5_72, APL_EX5_73, APL_EX5_74, APL_EX5_75, APL_EX5_76, APL_EX5_77, APL_EX5_78, APL_EX5_79, APL_EX5_80,       
    APL_EX5_81, APL_EX5_82, APL_EX5_83, APL_EX5_84, APL_EX5_85, APL_EX5_86, APL_EX5_87, APL_EX5_88, APL_EX5_89, APL_EX5_90,            
    APL_EX5_91, APL_EX5_92, APL_EX5_93, APL_EX5_94, APL_EX5_95, APL_EX5_96, APL_EX5_97, APL_EX5_98, APL_EX5_99, APL_EX5_100,            
    APL_EX5_101, APL_EX5_102, APL_EX5_103, APL_EX5_104, APL_EX5_105, APL_EX5_106, APL_EX5_107, APL_EX5_108, APL_EX5_109, APL_EX5_110,            
    APL_EX5_111, APL_EX5_112, APL_EX5_113, APL_EX5_114, APL_EX5_115, APL_EX5_116, APL_EX5_117, APL_EX5_118, APL_EX5_119, APL_EX5_120,            
    APL_EX5_121, APL_EX5_122, APL_EX5_123, APL_EX5_124, APL_EX5_125, APL_EX5_126, APL_EX5_127, APL_EX5_128, APL_EX5_129, APL_EX5_130,            
    APL_EX5_131, APL_EX5_132, APL_EX5_133, APL_EX5_134, APL_EX5_135, APL_EX5_136, APL_EX5_137, APL_EX5_138, APL_EX5_139, APL_EX5_140,            
    APL_EX5_141, APL_EX5_142, APL_EX5_143, APL_EX5_144, APL_EX5_145, APL_EX5_146, APL_EX5_147, APL_EX5_148, APL_EX5_149, APL_EX5_150)            
  SELECT E5.OWNERID, @NEXTID,            
 E5.APL_EX5_1, E5.APL_EX5_2, E5.APL_EX5_3, E5.APL_EX5_4, E5.APL_EX5_5, E5.APL_EX5_6, E5.APL_EX5_7, E5.APL_EX5_8, E5.APL_EX5_9, E5.APL_EX5_10,            
    E5.APL_EX5_11, E5.APL_EX5_12, E5.APL_EX5_13, E5.APL_EX5_14, E5.APL_EX5_15, E5.APL_EX5_16, E5.APL_EX5_17, E5.APL_EX5_18, E5.APL_EX5_19, E5.APL_EX5_20,            
    E5.APL_EX5_21, E5.APL_EX5_22, E5.APL_EX5_23, E5.APL_EX5_24, E5.APL_EX5_25, E5.APL_EX5_26, E5.APL_EX5_27, E5.APL_EX5_28, E5.APL_EX5_29, E5.APL_EX5_30,            
    E5.APL_EX5_31, E5.APL_EX5_32, E5.APL_EX5_33, E5.APL_EX5_34, E5.APL_EX5_35, E5.APL_EX5_36, E5.APL_EX5_37, E5.APL_EX5_38, E5.APL_EX5_39, E5.APL_EX5_40,            
    E5.APL_EX5_41, E5.APL_EX5_42, E5.APL_EX5_43, E5.APL_EX5_44, E5.APL_EX5_45, E5.APL_EX5_46, E5.APL_EX5_47, E5.APL_EX5_48, E5.APL_EX5_49, E5.APL_EX5_50,            
    E5.APL_EX5_51, E5.APL_EX5_52, E5.APL_EX5_53, E5.APL_EX5_54, E5.APL_EX5_55, E5.APL_EX5_56, E5.APL_EX5_57, E5.APL_EX5_58, E5.APL_EX5_59, E5.APL_EX5_60,            
    E5.APL_EX5_61, E5.APL_EX5_62, E5.APL_EX5_63, E5.APL_EX5_64, E5.APL_EX5_65, E5.APL_EX5_66, E5.APL_EX5_67, E5.APL_EX5_68, E5.APL_EX5_69, E5.APL_EX5_70,            
    E5.APL_EX5_71, E5.APL_EX5_72, E5.APL_EX5_73, E5.APL_EX5_74, E5.APL_EX5_75, E5.APL_EX5_76, E5.APL_EX5_77, E5.APL_EX5_78, E5.APL_EX5_79, E5.APL_EX5_80,            
    E5.APL_EX5_81, E5.APL_EX5_82, E5.APL_EX5_83, E5.APL_EX5_84, E5.APL_EX5_85, E5.APL_EX5_86, E5.APL_EX5_87, E5.APL_EX5_88, E5.APL_EX5_89, E5.APL_EX5_90,            
    E5.APL_EX5_91, E5.APL_EX5_92, E5.APL_EX5_93, E5.APL_EX5_94, E5.APL_EX5_95, E5.APL_EX5_96, E5.APL_EX5_97, E5.APL_EX5_98, E5.APL_EX5_99, E5.APL_EX5_100,            
    E5.APL_EX5_101, E5.APL_EX5_102, E5.APL_EX5_103, E5.APL_EX5_104, E5.APL_EX5_105, E5.APL_EX5_106, E5.APL_EX5_107, E5.APL_EX5_108, E5.APL_EX5_109, E5.APL_EX5_110,            
    E5.APL_EX5_111, E5.APL_EX5_112, E5.APL_EX5_113, E5.APL_EX5_114, E5.APL_EX5_115, E5.APL_EX5_116, E5.APL_EX5_117, E5.APL_EX5_118, E5.APL_EX5_119, E5.APL_EX5_120,            
    E5.APL_EX5_121, E5.APL_EX5_122, E5.APL_EX5_123, E5.APL_EX5_124, E5.APL_EX5_125, E5.APL_EX5_126, E5.APL_EX5_127, E5.APL_EX5_128, E5.APL_EX5_129, E5.APL_EX5_130,            
    E5.APL_EX5_131, E5.APL_EX5_132, E5.APL_EX5_133, E5.APL_EX5_134, E5.APL_EX5_135, E5.APL_EX5_136, E5.APL_EX5_137, E5.APL_EX5_138, E5.APL_EX5_139, E5.APL_EX5_140,            
    E5.APL_EX5_141, E5.APL_EX5_142, E5.APL_EX5_143, E5.APL_EX5_144, E5.APL_EX5_145, E5.APL_EX5_146, E5.APL_EX5_147, E5.APL_EX5_148, E5.APL_EX5_149, E5.APL_EX5_150            
  FROM APL_EX5 (NOLOCK) E5                
  WHERE E5.OWNERID = 985            
    AND E5.APL_EX5_ID = @APPLICATIONID;            
        
 ----------------------------------------- UPDATE / RESET FLAGS AND STATUS FIELDS ----------------------------------------------------        
 UPDATE APL_EX1    
 SET APL_EX1_66 = null, /*app_MOS Last Loan */    
  Apl_ex1_68 = null /*Fraud Check Appl */    
  WHERE OWNERID = 985 AND APL_EX1_ID = @NEXTID      
  UPDATE APL_EX2 /*IDE FLAGS*/        
  SET APL_EX2_1 = 1 /*PENDING*/,        
    APL_EX2_2 = 1 /*PENDING*/,        
    APL_EX2_3 = 1 /*PENDING*/,        
    APL_EX2_4 = 1 /*PENDING*/,        
    APL_EX2_5 = 1 /*PENDING*/,        
    APL_EX2_6 = 1 /*PENDING*/,        
    APL_EX2_7 = 1 /*PENDING*/,    
    Apl_ex2_57 = null, /*app_amount financed percentage */    
 Apl_ex2_38 = NULL, /*app_DOSRIClassification_MDM*/    
 Apl_ex2_39 = NULL /*app_PEP Classification_MDM*/    
  WHERE OWNERID = 985 AND APL_EX2_ID = @NEXTID        
    
  UPDATE APL_EX3 SET    
 Apl_ex3_55 = NULL,    
 Apl_ex3_4 = null, /*app_RBP Decision */    
 Apl_ex3_5 = null, /*app_RBP FLAG */    
 Apl_ex3_71 = null, /*Residence Verification_app */    
 Apl_ex3_72 = null, /*Employment Verification_app */    
 Apl_ex3_73 = null, /*Income Verification_app */    
 Apl_ex3_74 = null, /*Credit Verification_app */    
 Apl_ex3_96 = null /*Age_app */    
  WHERE OWNERID = 985 AND APL_EX3_ID = @NEXTID    
          
  UPDATE APL_EX4        
  SET  APL_EX4_18 = NULL,        
    APL_EX4_25 = NULL,        
    APL_EX4_26 = NULL,        
    APL_EX4_28 = NULL,        
    APL_EX4_30 = NULL,        
    APL_EX4_79 = NULL,    
 Apl_ex4_50 = null /*COFP Flag */    
  WHERE OWNERID = 985 AND APL_EX4_ID = @NEXTID      
    
  UPDATE APL_EX5    
  SET   Apl_ex5_84 = NULL, /*App Score_Apl*/    
  Apl_ex5_88 = NULL, /*App Scoring Method_Apl*/    
  Apl_ex5_89 = NULL, /*App Scoreband*/    
  Apl_ex5_92 = NULL,  /*ASCORE DECISION*/    
  Apl_ex5_145 = 0 /*Credit verification record creation*/  
  WHERE OWNERID = 985 AND APL_EX5_ID = @NEXTID      
    
 update Apl_ex4 set    
 Apl_ex4_87=null,/* App_TU_G003S*/    
 Apl_ex4_89=null,/* App_TU_G001B*/    
 Apl_ex4_90=null,/* App_TU_Total Past Due*/    
 Apl_ex4_91=null,/* App_TU_RP04S*/    
 Apl_ex4_92=null/* App_TU_CO04S*/    
 where ownerid = 985 and Apl_ex4_id = @NEXTID    
    
 update Apl_ex5 set    
  Apl_ex5_45=null,/* App_ResponseCode*/    
  Apl_ex5_46=null,/* App_Responsemessage*/    
  Apl_ex5_47=null,/* App_TU_BCCIS01*/    
  Apl_ex5_48=null,/* App_BCC0001*/    
  Apl_ex5_49=null,/* App_BCC0002*/    
  Apl_ex5_50=null,/* App_BCC0267*/    
  Apl_ex5_51=null,/* App_BCPMTSTR*/    
  Apl_ex5_52=null,/* App_AT103S*/    
  Apl_ex5_53=null,/* App_G310S*/    
  Apl_ex5_54=null,/* App_DM006S*/    
  Apl_ex5_55=null,/* App_HIGHEST_INCOME*/    
  Apl_ex5_56=null,/* App_LOWEST_INCOME*/    
  Apl_ex5_57=null,/* App_UTIL_OFF*/    
  Apl_ex5_58=null,/* App_UTIL_ACTIVE_L6_OFF*/    
  Apl_ex5_59=null,/* App_PAYMENTRATIO_LESSUB_L6_OFF*/    
  Apl_ex5_60=null,/* App_HIGHEST_LIMIT_OFF*/    
  Apl_ex5_61=null,/* App_AT01S*/    
  Apl_ex5_62=null,/* App_AT02S*/    
  Apl_ex5_63=null,/* App_BC01S*/    
  Apl_ex5_64=null,/* App_BC02S*/    
  Apl_ex5_65=null,/* App_G058S*/    
  Apl_ex5_66=null,/* App_G063S*/    
  Apl_ex5_67=null,/* App_G068S*/    
  Apl_ex5_68=null,/* App_TU_Grade*/    
  Apl_ex5_69=null,/* App_ResidentialAddress_AddressLine1*/    
  Apl_ex5_70=null,/* App_ResidentialAddress_AddressLine2*/    
  Apl_ex5_71=null,/* App_BillingAddress_AddressLine1*/    
  Apl_ex5_72=null,/* App_BillingAddress_AddressLine2*/    
  Apl_ex5_73=null,/* App_UnkownType_AddressLine1*/    
  Apl_ex5_74=null,/* App_UnkownType_AddressLine2*/    
  Apl_ex5_75=null,/* App_OtherType_AddressLine1*/    
  Apl_ex5_76=null,/* App_OtherType_AddressLine2*/    
  Apl_ex5_77=null,/* App_BillingAddress_ZipCode*/    
  Apl_ex5_78=null,/* App_UnkownType_ZipCode*/    
  Apl_ex5_79=null,/* App_OtherType_ZipCode*/    
  Apl_ex5_8=null,/*App_TU G002B*/    
  Apl_ex5_80=null,/* Originating Branch code_App*/    
  Apl_ex5_82=null,/* TU_ResidenceAddress_ZipCode_App*/    
  Apl_ex5_90=null,/* TU MAX MOB_Apl*/    
  Apl_ex5_7 = null, /*CRR Result*/    
  Apl_ex5_117 = NULL, /* CIF error Code*/    
  Apl_ex5_118 = NULL, /*CIF error Message*/    
  Apl_ex5_134 = NULL, /*Deviation rework job flag_Apl*/    
  Apl_ex5_33 = NULL, /*CIF Success response_App*/    
  Apl_ex5_10 = null, /*App_R_Addr_Pda */    
  Apl_ex5_104 = null, /*Current Tenure */    
  Apl_ex5_105 = null, /*Loan Amount */    
  Apl_ex5_111 = null, /*Latest NOBPDA */    
  Apl_ex5_132 = null, /*App_Overall Loan Handling */    
  Apl_ex5_32 = null, /*Blacklist Check_app */    
  Apl_ex5_34 = null, /*Loan Term */    
  Apl_ex5_35 = null, /*CB Exist_app */    
  Apl_ex5_38 = null, /*Loan Term Years */    
  Apl_ex5_40 = null, /*Age Number 1 */    
  Apl_ex5_41 = null, /*Age at Maturity New */    
  Apl_ex5_81 = null, /*R_PRODUCT_app*/    
  Apl_ex5_83 = null, /*R_NSCREEN_app*/    
  Apl_ex5_116 = null, /*R_Other Factor*/    
  Apl_ex5_93 = NULL /*DSCR DASHLET*/    
  where ownerid = 985 and apl_ex5_id = @NEXTID    
       
  -------------------------------------------------------------------------------------------------------------------------------------        
       
  EXEC MPI_CLONE_APPLICANT_VERIFICATIONS @USERID, @NEXTID, @APPLICATIONID;      
  EXEC MPI_CLONE_APPLICATION_LIABILITY @USERID, @APPLICATIONID, @NEXTID;      
  EXEC MPI_CLONE_APPLICATION_ATTACHMENT @USERID, @APPLICATIONID, @NEXTID;      
      
      
   /* Updating Primary Borrower's Name on Subject of Financial Application */        
  IF(@BORROWERTYPE = N'PRIMARY' OR @BORROWERTYPE = N'P') BEGIN            
  UPDATE FINANCIALAPPLICATION        
  SET SUBJECT = (SELECT APPLICATIONNAME FROM APPLICATION AP         
        INNER JOIN APL_EX1 A1         
          ON AP.OWNERID = A1.OWNERID         
      AND AP.APPLICATIONID = A1.APL_EX1_ID          
        WHERE AP.OWNERID=985        
          AND AP.RELATEDTOID=@NEWFA        
       AND A1.APL_EX1_53 = N'P'),    
    MobilePhone = (SELECT MOBILE FROM APPLICATION AP         
        INNER JOIN APL_EX1 A1         
          ON AP.OWNERID = A1.OWNERID         
      AND AP.APPLICATIONID = A1.APL_EX1_ID          
        WHERE AP.OWNERID=985        
          AND AP.RELATEDTOID=@NEWFA        
       AND A1.APL_EX1_53 = N'P')  
  WHERE OWNERID = 985 AND CUSTOMOBJECTID = @NEWFA;        
          
  UPDATE FIA_EX3        
  SET FIA_EX3_86 = (SELECT APPLICATIONNAME FROM APPLICATION AP         
        INNER JOIN APL_EX1 A1         
          ON AP.OWNERID = A1.OWNERID         
      AND AP.APPLICATIONID = A1.APL_EX1_ID          
        WHERE AP.OWNERID=985        
          AND AP.RELATEDTOID=@NEWFA        
       AND A1.APL_EX1_53 = N'P')        
  WHERE OWNERID = 985 AND FIA_EX3_ID = @NEWFA;        
 END;      
      
  --------------------------------------- UPDATE FA FLAGS , FIELDS -------------------------------------------------------    
  UPDATE FINANCIALAPPLICATION   
  SET CREATEDBY = @USERID,  
    LASTMODIFIEDBY = @USERID    
  WHERE OWNERID = 985  
 AND CUSTOMOBJECTID = @NEWFA; --UPDATE CREATED BY TO THE USER    
  
  UPDATE FINANCIALAPPLICATIONHISTORY   
  SET CURRENTOWNERID = @USERID,  
   LASTMODIFIEDBY = @USERID,  
   CURRENTOWNERNAME = (SELECT SHORTNAME FROM AZ_USER WHERE APPOWNERID=985 AND USERID = @USERID),  
   LASTMODIFIEDBYNAME = (SELECT SHORTNAME FROM AZ_USER WHERE APPOWNERID=985 AND USERID = @USERID)  
  WHERE OWNERID = 985   
    AND CUSTOMOBJECTID = @NEWFA  
    
  UPDATE F2        
  SET F2.Fia_ex2_47 = A.FIRSTNAME, F2.Fia_ex2_48 =A.MiddleName,F2.Fia_ex2_49 = A.LastName ,F2.Fia_ex2_83 = A.SaluationId      
  FROM FIA_EX2 F2      
  INNER JOIN APPLICATION A ON F2.OWNERID = A.OWNERID AND F2.Fia_ex2_ID = A.RELATEDTOID AND A.RelatedToTypeID = 100286      
  INNER JOIN APL_EX1 A1 ON A.OWNERID = A1.OWNERID AND  A.APPLICATIONID   = A1.APL_EX1_ID      
  WHERE A.OWNERID=985 AND F2.FIA_EX2_ID=@NEWFA AND A1.APL_EX1_53 = N'P'       
    
  UPDATE FIA_EX3 SET    
  Fia_ex3_54 = NULL /*FA_Age*/    
  WHERE OWNERID = 985 AND FIA_EX3_ID = @NEWFA    
    
  /*Collateral fields*/    
  UPDATE FIA_EX4 SET     
  Fia_ex4_113 = NULL,/* FA_Date Diff Number */    
  Fia_ex4_56= NULL,/* Description_FA */    
  Fia_ex4_57= NULL,/* Description 1_FA */    
  Fia_ex4_58= NULL,/* Description 2_FA */    
  Fia_ex4_59= NULL,/* Appraised By_FA */    
  Fia_ex4_60= NULL,/* LTO MV File No_FA */    
  Fia_ex4_61= NULL,/* Registration Cert No_FA */    
  Fia_ex4_62= NULL,/* FA_Premium O R Numner */    
  Fia_ex4_80= NULL,/* FA_Year Model */    
  Fia_ex4_81= NULL,/* FA_Plate Number */    
  Fia_ex4_82= NULL,/* FA_Motor Engine Number */    
  Fia_ex4_83= NULL,/* FA_Chassis or Serial Number */    
  Fia_ex4_84= NULL,/* FA_Engine Displacement */    
  Fia_ex4_85= NULL,/* FA_Primary Color */    
  Fia_ex4_86= NULL,/* FA_Insurance Secured by */    
  Fia_ex4_87= NULL,/* FA_Type of Coverage */    
  Fia_ex4_88= NULL,/* FA_Insurance Policy Number */    
  Fia_ex4_89= NULL,/* FA_Insurance Company */    
  Fia_ex4_90= NULL,/* FA_Coverage Amount */    
  Fia_ex4_91= NULL,/* FA_OD or LD Premium */    
  Fia_ex4_92= NULL,/* FA_Expiry Date */    
  Fia_ex4_93= NULL,/* FA_Date Paid */    
  Fia_ex4_94= NULL,/* FA_First Payment Date */    
  Fia_ex4_95= NULL,/* FA_Maturity Date */    
  Fia_ex4_96= NULL,/* FA_Specific Day */    
  Fia_ex4_97= NULL,/* FA_Loan Term Code */    
  Fia_ex4_98= NULL,/* FA_Payment Frequency */    
  Fia_ex4_99= NULL,/* FA_Frequency Code */     
  Fia_ex4_128 =NULL, /*FA_Computation INAP Loan Term */    
  Fia_ex4_30 =NULL, /*FA_First Payment Date 2 */    
  Fia_ex4_63 =NULL, /*FA_First Transfer Date */    
  Fia_ex4_64 =NULL, /*FA_Expiration Date */    
  Fia_ex4_65 =NULL, /*FA_Check Date */    
  Fia_ex4_66 =NULL, /*FA_Specific Day of Transfer */    
  Fia_ex4_67 =NULL, /*FA_Transfer Frequency */    
  Fia_ex4_68 =NULL, /*FA_Transfer Frequency _PBD */    
  Fia_ex4_69 =NULL, /*FA_No of Submitted Checks_PDB */    
  Fia_ex4_70 =NULL, /*FA_Check Serial No Start No_PBD */    
  Fia_ex4_71 =NULL, /*FA_Transfer Amount _PBD */    
  Fia_ex4_77 =NULL, /*FA_Transfer Frequency Code _PBD */    
  Fia_ex4_78 =NULL, /*FA_Drawee Bank */    
  Fia_ex4_79 =NULL, /*FA_Check Clearing Type */    
  Fia_ex4_107 =NULL, /*LAN Error Code */    
  Fia_ex4_108 =NULL /*LAN Error Message */    
  WHERE OWNERID = 985 AND FIA_EX4_ID = @NEWFA    
    
 /*payment fields*/    
 UPDATE Fia_ex5 SET     
  Fia_ex5_107= NULL,/* Confirmed Mode Of Payment */    
  Fia_ex5_109= NULL,/* FA_Booking Date */    
  Fia_ex5_131= NULL,/* FA_GMI_payment schedule */    
  Fia_ex5_175= NULL,/* FA_NMI */    
  Fia_ex5_177= NULL,/* FA_Expiry Date Computed */    
  Fia_ex5_39= NULL,/* FA_LOS COLLATERAL ID */    
  Fia_ex5_40= NULL,/* FA_COLLATERAL NUMBER */    
  Fia_ex5_42= NULL,/* FA_Confirmed mode of payment */    
  Fia_ex5_44= NULL,/* FA_BSP COLLATERAL CODE */    
  Fia_ex5_45= NULL,/* FA_Loan Term_payments section */    
  Fia_ex5_46= NULL,/* FA_ACQUISITION COST */    
  Fia_ex5_47= NULL,/* FA_APPRAISED VALUE */    
  Fia_ex5_48= NULL,/* FA_LAST APPRAISAL DATE */    
  Fia_ex5_50= NULL,/* FA_MAXIMUM COLLATERAL VALUE */    
  Fia_ex5_51= NULL,/* FA_AMOUNT CURRENTLY PLEDGED */    
  Fia_ex5_52= NULL,/* FA_LOAN TO VALUE PERCENTAGE */    
  Fia_ex5_55= NULL,/* FA_REGISTRATION DATE */    
  Fia_ex5_56= NULL,/* FA_REGISTRATION EXPIRY DATE */    
  Fia_ex5_60= NULL,/* FA_PPD */    
  Fia_ex5_122 =NULL,/*FA_Debit Account No */    
  Fia_ex5_13 =NULL,/*Created On_FA */    
  Fia_ex5_14 =NULL,/*Loan Term in Years */    
  Fia_ex5_57 =NULL,/*Age Number */    
  Fia_ex5_58 =NULL,/*Age at Maturity */    
  Fia_ex5_59 =NULL,/*CB Exist */    
  Fia_ex5_61 =NULL,/*FA_Transfer Amount */    
  Fia_ex5_62 =NULL,/*FA_Order */    
  Fia_ex5_63 =NULL,/*FA_Clearing Bank */    
  Fia_ex5_64 =NULL,/*FA_CUSTODIAN BRANCH */    
  Fia_ex5_79 = NULL,/*Final App Score*/    
  Fia_ex5_83 = NULL,/*Final Scoreband*/    
  Fia_ex5_69 = NULL, /*Final Scoreband*/    
  Fia_ex5_130 = NULL /*Final Scoreband*/    
  WHERE OWNERID = 985 AND FIA_EX5_ID = @NEWFA    
        
  COMMIT;      
  END TRY                
  BEGIN CATCH    
  PRINT 'INSIDE CATCH'  
  IF @@TRANCOUNT > 0      
        BEGIN      
            IF XACT_STATE() <> -1      
            BEGIN      
                ROLLBACK TRANSACTION ;      
            END      
  END;       
   
 /* DELETE FA WHEN THERE IS ERROR */  
  
 SELECT @ERRORMESSAGE = SUBSTRING(ERROR_MESSAGE(), 0, 255);  
   
 INSERT INTO MPI_CLONE_LOG VALUES(@TODAY,@USERID,@ERRORMESSAGE,'Log for Applicant insertion')  
   
  EXEC MPI_CLONE_DELETE_FA_WHEN_ERROR @NEWFA            
 BEGIN            
  THROW 99001, @ERRORMESSAGE, 1;            
 END           
      
  END CATCH        
  PRINT 'ERROR MESSAGE IS - '+ERROR_MESSAGE()  
  PRINT 'TRANCOUNT IS - '+ CAST(@@TRANCOUNT AS NVARCHAR(10))  
  PRINT 'STATE IS - '+ CAST(XACT_STATE() AS NVARCHAR(10))   
END;  
  
CREATE        PROC MPI_CLONE_APPLICANT_VERIFICATIONS ( @USERID INT, @NEW_APPID INT,@APPLICATIONID INT ) AS            
/*            
  Created On: 22-May-2024; Created By: PRATEEK PATHRE;            
  Details: Clone Applicant and Co-Applicant VERIFICATIONS DATA inside newly cloned loan application.     
  EXEC MPI_CLONE_APPLICANT_VERIFICATIONS 1,10725,10724    
*/            
BEGIN         
  DECLARE  @ERRORMESSAGE NVARCHAR(256);        
          
  BEGIN TRY        
  BEGIN TRAN      
  /*SELECT OLD VERIFICATION RECORD IDS OF THE APPLICANT*/          
  SELECT ROW_NUMBER() OVER (order by CUSTOMOBJECTID ASC) AS ROW_NUM,CUSTOMOBJECTID AS CUSTOMOBJECTID, 0 AS NEW_ID INTO #VER_ID FROM VERIFICATION           
  WHERE OWNERID = 985 AND LAYOUTID IN (10204009 /*ID Information*/,10204016 /*Residence Verification*/,10204017/*Employment Verification*/,10204018/*Income Verification*/)          
  AND RELATEDTOID IN (@APPLICATIONID)          
          
  /* FETCH LASTID FROM VERIFICATION */          
  DECLARE @SUCCESSCOUNT INT, @NEXTID INT;         
  DECLARE @TODAY DATETIME = GETUTCDATE();          
  SELECT @NEXTID  = LASTID FROM  IDLIST WHERE OWNERID = 985 AND ITEMID = 100005;          
  UPDATE #VER_ID SET NEW_ID = ROW_NUM + @NEXTID              
              
  /*INSERT ALL RECORDS INTO TEMP*/          
  SELECT * INTO #VER_MAIN  FROM VERIFICATION WHERE OWNERID = 985 AND CUSTOMOBJECTID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
  SELECT * INTO #VER_EX1 FROM VER_EX1  WHERE OWNERID = 985 AND VER_EX1_ID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
  SELECT * INTO #VER_EX2 FROM VER_EX2  WHERE OWNERID = 985 AND VER_EX2_ID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
  SELECT * INTO #VER_EX3 FROM VER_EX3  WHERE OWNERID = 985 AND VER_EX3_ID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
  SELECT * INTO #VER_EX4 FROM VER_EX4  WHERE OWNERID = 985 AND VER_EX4_ID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
  SELECT * INTO #VER_EX5 FROM VER_EX5  WHERE OWNERID = 985 AND VER_EX5_ID IN (SELECT CUSTOMOBJECTID FROM #VER_ID)          
    
  /*UPDATE FLAGS AND STATUS*/  
  UPDATE #VER_MAIN SET STATUSCODEID = 5126 /*DRAFT*/, AssignedToId = @USERID   
  
  UPDATE #VER_EX1 SET Ver_ex1_28 = NULL /*Ver_Dscr*/, Ver_ex1_65 = NULL /*Total Monthly Income veri*/, Ver_ex1_67 = NULL /*Total Monthly Installment veri*/  
  UPDATE #VER_EX5 SET Ver_ex5_38= NULL, /*Gross Revenue*/  
       Ver_ex5_57 = NULL /*Total Monthly Amort*/  
  
  /*UPDATE NEW IDS*/          
  UPDATE L1 SET L1.CUSTOMOBJECTID = L2.NEW_ID,L1.SUBJECT = L2.NEW_ID, L1.RELATEDTOID = @NEW_APPID, L1.CREATEDBY = @USERID, L1.LastModifiedBy = @USERID, L1.CreatedByType = 0, L1.LastModifiedByType = 0, L1.CreatedOn = @TODAY,L1.LastModifiedOn = @TODAY  
  FROM #VER_MAIN L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.CUSTOMOBJECTID = L2.CUSTOMOBJECTID          
          
  UPDATE L1 SET L1.VER_EX1_ID = L2.NEW_ID FROM #VER_EX1 L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.VER_EX1_ID = L2.CUSTOMOBJECTID          
  UPDATE L1 SET L1.VER_EX2_ID = L2.NEW_ID FROM #VER_EX2 L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.VER_EX2_ID = L2.CUSTOMOBJECTID          
  UPDATE L1 SET L1.VER_EX3_ID = L2.NEW_ID FROM #VER_EX3 L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.VER_EX3_ID = L2.CUSTOMOBJECTID          
  UPDATE L1 SET L1.VER_EX4_ID = L2.NEW_ID FROM #VER_EX4 L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.VER_EX4_ID = L2.CUSTOMOBJECTID          
  UPDATE L1 SET L1.VER_EX5_ID = L2.NEW_ID FROM #VER_EX5 L1 INNER JOIN #VER_ID L2 ON L1.OWNERID = 985 AND L1.VER_EX5_ID = L2.CUSTOMOBJECTID          
          
  /*INSERT NEW VERFICATION RECORDS*/          
  INSERT INTO VERIFICATION SELECT * FROM #VER_MAIN          
  INSERT INTO VER_EX1 SELECT * FROM #VER_EX1          
  INSERT INTO VER_EX2 SELECT * FROM #VER_EX2          
  INSERT INTO VER_EX3 SELECT * FROM #VER_EX3          
  INSERT INTO VER_EX4 SELECT * FROM #VER_EX4          
  INSERT INTO VER_EX5 SELECT * FROM #VER_EX5          
          
  UPDATE IDLIST SET LASTID = (SELECT MAX(CUSTOMOBJECTID) FROM VERIFICATION ) WHERE OWNERID = 985 AND ITEMID = 100005          
            
  ---------------------------------------- CLONE RELATED ATTACHMENTS OF THOSE VERIFICATION RECORDS --------------------------------------------          
  DECLARE @DMSID INT;                 
  DECLARE @MAX_DMSID INT;                     
  SELECT @DMSID = MAX(ATTACHMENTID) FROM ATTACHMENTMASTER WHERE OWNERID = 985          
          
  /*INSERT INTO TEMP TABLE*/                
  SELECT ROW_NUMBER() OVER(ORDER BY ATTACHMENTID) AS ROWID,* INTO #TEMP_DMS FROM ATTACHMENTMASTER WHERE OWNERID = 985 AND ITEMTYPE = 100005 AND ITEMID IN (SELECT CUSTOMOBJECTID FROM #VER_ID )          
          
  UPDATE L1 SET L1.ITEMID = L2.NEW_ID FROM #TEMP_DMS L1 INNER JOIN #VER_ID L2 ON L1.ITEMID = L2.CUSTOMOBJECTID          
           
          
  /*INSERT INTO ATTACHMENTMASTER*/                
  INSERT INTO ATTACHMENTMASTER                
  (OWNERID,ATTACHMENTID,ITEMTYPE,ITEMID,ATTACHEDID,ATTACHEDON,ATTACHEDby)                
  SELECT                 
  985,@DMSID+ROWID,100005,ITEMID,ATTACHEDID,@TODAY,ATTACHEDby                
 FROM #TEMP_DMS           
          
  /*UPDATE LAST ID FOR ATTACHMENTMASTER*/                
  UPDATE IDLIST SET LASTID = (SELECT MAX(ATTACHMENTID) FROM ATTACHMENTMASTER WHERE OWNERID = 985) WHERE OWNERID = 985 AND ITEMID = 129 /*ATTACHMENTMASTER*/                
    
    --BEGIN      
 -- THROW 99001, 'ERROR IN VERIFICATION', 1;      
 --END;    
    
  commit;      
  END TRY              
  BEGIN CATCH        
  ROLLBACK;    
  SELECT @ERRORMESSAGE = SUBSTRING(ERROR_MESSAGE(), 0, 255);      
  INSERT INTO MPI_CLONE_LOG VALUES(@TODAY,@USERID,@ERRORMESSAGE,'Log for Verification insertion')      
 BEGIN      
  THROW 99001, @ERRORMESSAGE, 1;      
 END;      
  END CATCH         
          
END; 

CREATE    PROCEDURE MPI_CLONE_APPLICATION(@OLDFA INT,@NEWFA INT, @APPLICATIONID INT, @BorrowerType Nvarchar(20))            
AS             
/*             
 DESCRIPTION - TO CLONE APPLICATIONS OF EXISTING FA ON NEW FA.             
 CREATED ON - 19TH APRIL 2024 | CREATED BY - PRADYUMAN SHARMA          
 MODIFIED ON - 29TH APRIL 2024 | CREATED BY - PRADYUMAN SHARMA        
 MPI_CLONE_APPLICATION 101584,102548           
*/            
BEGIN            
     /* DECLARING VARIABLES TO BE USED */            
     DECLARE @SUCCESSCOUNT INT,@NEXTID INT;            
               
     /* INSERTING APPLICATION ID'S INTO TEMP TABLE */            
     SELECT APPLICATIONID AS APPLICATIONID,        
  0 AS NEWAPPLICATIONID        
     INTO #APLIDTEMP            
     FROM APPLICATION LT WHERE LT.OWNERID = 985 AND APPLICATIONID=@APPLICATIONID  AND LT.RELATEDTOID = @OLDFA            
               
     /* INSERTING RELEVANT APPLICATIONS AND THEIR DATA INTO TEMP TABLE */            
     SELECT *             
     INTO #APLDATATEMP             
     FROM APPLICATION LT WHERE LT.OWNERID = 985 AND APPLICATIONID=@APPLICATIONID  AND LT.RELATEDTOID = @OLDFA ;            
     SET @SUCCESSCOUNT = @@ROWCOUNT;            
               
     /* EXTENSION TABLE 1 */            
     SELECT *             
     INTO #APLEX1TMP            
     FROM APL_EX1 LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND  LT.APL_EX1_ID = AT.APPLICATIONID;            
               
     /* EXTENSION TABLE 2 */            
     SELECT *             
     INTO #APLEX2TMP            
     FROM APL_EX2 LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND  LT.APL_EX2_ID = AT.APPLICATIONID;            
               
     /* EXTENSION TABLE 3 */            
     SELECT *             
     INTO #APLEX3TMP            
     FROM APL_EX3 LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND  LT.APL_EX3_ID = AT.APPLICATIONID;            
               
     /* EXTENSION TABLE 4 */            
     SELECT *             
     INTO #APLEX4TMP            
     FROM APL_EX4 LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND  LT.APL_EX4_ID = AT.APPLICATIONID;            
               
     /* EXTENSION TABLE 5 */            
     SELECT *             
     INTO #APLEX5TMP            
     FROM APL_EX5 LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND  LT.APL_EX5_ID = AT.APPLICATIONID;            
               
     /* GENERATING NEW APPLICATION ID'S FOR TO BE CLONED RECORDS */            
     EXEC GETNEXTIDBLOCK 985,403,@SUCCESSCOUNT,@NEXTID OUT;            
               
     /* UPDATING TEMP TABLES WITH NEWLY GENERATED ID'S */            
     UPDATE LT            
      SET LT.APPLICATIONID = @NEXTID + P.ROWINDEX,            
       LT.RELATEDTOID = @NEWFA            
     FROM #APLDATATEMP LT            
     INNER JOIN(            
     SELECT P.APPLICATIONID,            
         ROW_NUMBER () OVER (ORDER BY P.APPLICATIONID ASC) AS ROWINDEX            
     FROM #APLIDTEMP P            
     ) AS P ON LT.APPLICATIONID = P.APPLICATIONID            
     SET @SUCCESSCOUNT = @@ROWCOUNT;            
        
 /* UPDATING APLID TEMP TABLE WITH NEW APPLICATION ID'S FOR TRACKING PURPOSES */        
 UPDATE LT        
   SET LT.NEWAPPLICATIONID = @NEXTID + P.ROWINDEX        
 FROM #APLIDTEMP LT         
 INNER JOIN(        
 SELECT P.APPLICATIONID,         
  ROW_NUMBER () OVER (ORDER BY P.APPLICATIONID ASC) AS ROWINDEX        
 FROM #APLIDTEMP P        
 ) AS P ON LT.APPLICATIONID = P.APPLICATIONID        
     
 /* UPDATING IDLIST FOR APPLICATION */        
 UPDATE IL        
    SET IL.LASTID = (SELECT MAX(APPLICATIONID) FROM #APLDATATEMP WHERE OWNERID=985)        
 FROM IDLIST IL        
 WHERE IL.OWNERID = 985         
   AND IL.ITEMID = 403;        
          
        
     /* INSERTING NEW RECORDS INTO APPLICATION TABLE */            
     INSERT INTO APPLICATION (OWNERID,            
               APPLICATIONID,            
               FIRSTNAME,            
               MIDDLENAME,            
               LASTNAME,            
       PRODUCTID,            
               ASSIGNTOID,            
               STATUSCODEID,            
               PHONE,            
               MOBILE,            
               OFFICEPHONE,            
               CURRENTOWNERID,            
               EMAIL,            
               COMMENTS,            
               TERRITORYID,            
               ADDRESS,            
               COUNTRY,            
               STATE,            
               ZIPCODE,            
      CITY,            
               LOCALITY,            
               LASTVIEWEDBY,            
               STATUSID,            
               RATINGID,            
               SALUATIONID,            
               EMPLOYEESTRENGTHID,            
               CREATEDBY,            
               SUBJECT,            
               LAYOUTID,            
               PROCESSID,            
               CREATEDON,            
               LASTMODIFIEDBY,            
               LASTMODIFIEDON,            
               CREATEDBYTYPE,            
               LASTMODIFIEDBYTYPE,            
               ESCALATEDON,            
               LASTACTIONID,            
               ESCALATEDCOUNT,            
               OPENESCALATEDCOUNT,            
               PREVIOUSSTATUSCODEID,            
               STATUSCODECHANGEDON,            
               IMPORTCYCLEID,            
               UNIQUEID,            
               APPLICATIONNAME,            
               ACCOUNTID,            
               ACCOUNTNAME,            
               ISESCALATED,            
               IPADDRESS,            
               SUFFIXID,            
               CAMPAIGNID,            
               INTEGRATIONTASKID,            
               SCHEMEID,            
               PARENTID,            
               RELATEDTOID,            
               RELATEDTONAME,            
               RELATEDTOTYPEID)            
              SELECT LT.OWNERID,            
                  LT.APPLICATIONID,            
                  LT.FIRSTNAME,            
                  LT.MIDDLENAME,            
                  LT.LASTNAME,            
                  LT.PRODUCTID,            
                  LT.ASSIGNTOID,            
                  LT.STATUSCODEID,            
                  LT.PHONE,            
                  LT.MOBILE,            
                  LT.OFFICEPHONE,            
                  LT.CURRENTOWNERID,            
                  LT.EMAIL,            
                  LT.COMMENTS,            
                  LT.TERRITORYID,            
                  LT.ADDRESS,            
                  LT.COUNTRY,            
                  LT.STATE,            
                  LT.ZIPCODE,            
                  LT.CITY,            
                  LT.LOCALITY,            
                  LT.LASTVIEWEDBY,            
                  LT.STATUSID,            
                  LT.RATINGID,            
                  LT.SALUATIONID,            
                  LT.EMPLOYEESTRENGTHID,            
                  LT.CREATEDBY,            
                  LT.SUBJECT,            
                  LT.LAYOUTID,            
                  LT.PROCESSID,            
                  LT.CREATEDON,            
                  LT.LASTMODIFIEDBY,            
                  LT.LASTMODIFIEDON,            
                  LT.CREATEDBYTYPE,            
                  LT.LASTMODIFIEDBYTYPE,            
                  LT.ESCALATEDON,            
                  LT.LASTACTIONID,            
                  LT.ESCALATEDCOUNT,            
                  LT.OPENESCALATEDCOUNT,            
                  LT.PREVIOUSSTATUSCODEID,            
                  LT.STATUSCODECHANGEDON,            
                  LT.IMPORTCYCLEID,            
                  LT.UNIQUEID,            
                  LT.APPLICATIONNAME,            
                  LT.ACCOUNTID,            
                  LT.ACCOUNTNAME,          
                  LT.ISESCALATED,            
                  LT.IPADDRESS,            
                  LT.SUFFIXID,            
                  LT.CAMPAIGNID,            
                  LT.INTEGRATIONTASKID,            
                  LT.SCHEMEID,            
                  LT.PARENTID,            
                  LT.RELATEDTOID,            
                  LT.RELATEDTONAME,            
                  LT.RELATEDTOTYPEID            
                FROM #APLDATATEMP LT WHERE LT.OWNERID = 985;            
              
  /* INSERTING NEW RECORDS INTO EXTENSION TABLES */            
  INSERT INTO APL_EX1(OWNERID,            
                       APL_EX1_ID,            
                       APL_EX1_1,            
                       APL_EX1_2,            
                       APL_EX1_3,            
                       APL_EX1_4,            
                       APL_EX1_5,          
                       APL_EX1_6,            
                       APL_EX1_7,            
                       APL_EX1_8,            
                       APL_EX1_9,            
                       APL_EX1_10,            
                       APL_EX1_11,            
                       APL_EX1_12,            
                       APL_EX1_13,            
                       APL_EX1_14,            
                       APL_EX1_15,            
                       APL_EX1_16,            
                       APL_EX1_17,            
                       APL_EX1_18,            
                       APL_EX1_19,            
                       APL_EX1_20,            
                       APL_EX1_21,            
                       APL_EX1_22,            
                       APL_EX1_23,            
                       APL_EX1_24,            
                       APL_EX1_25,            
                       APL_EX1_26,            
                       APL_EX1_27,            
                       APL_EX1_28,            
                       APL_EX1_29,            
                       APL_EX1_30,            
                       APL_EX1_31,            
                       APL_EX1_32,            
                       APL_EX1_33,            
                       APL_EX1_34,            
                       APL_EX1_35,            
                       APL_EX1_36,            
                       APL_EX1_37,            
                       APL_EX1_38,            
                       APL_EX1_39,            
                       APL_EX1_40,            
                       APL_EX1_41,            
                       APL_EX1_42,            
                       APL_EX1_43,            
                       APL_EX1_44,            
                       APL_EX1_45,            
                       APL_EX1_46,            
                       APL_EX1_47,            
                       APL_EX1_48,            
                       APL_EX1_49,            
                       APL_EX1_50,            
                       APL_EX1_51,            
                       APL_EX1_52,            
                       APL_EX1_53,            
                       APL_EX1_54,            
                       APL_EX1_55,            
                       APL_EX1_56,            
                       APL_EX1_57,            
                       APL_EX1_58,            
                       APL_EX1_59,            
                       APL_EX1_60,            
                       APL_EX1_61,            
                       APL_EX1_62,            
                       APL_EX1_63,            
                       APL_EX1_64,            
                       APL_EX1_65,            
                       APL_EX1_66,            
                       APL_EX1_67,            
                       APL_EX1_68,            
                       APL_EX1_69,            
                       APL_EX1_70,            
                       APL_EX1_71,            
                       APL_EX1_72,            
                   APL_EX1_73,            
                       APL_EX1_74,            
                       APL_EX1_75,            
                       APL_EX1_76,            
                       APL_EX1_77,            
                       APL_EX1_78,            
                       APL_EX1_79,            
                       APL_EX1_80,            
                       APL_EX1_81,            
                       APL_EX1_82,            
                       APL_EX1_83,            
                       APL_EX1_84,            
                       APL_EX1_85,            
                       APL_EX1_86,            
                       APL_EX1_87,            
  APL_EX1_88,            
                       APL_EX1_89,            
                       APL_EX1_90,            
                       APL_EX1_91,            
                       APL_EX1_92,            
                       APL_EX1_93,            
                       APL_EX1_94,            
                       APL_EX1_95,            
                       APL_EX1_96,            
                       APL_EX1_97,            
                       APL_EX1_98,            
                       APL_EX1_99,            
                       APL_EX1_100,            
        APL_EX1_101,            
                       APL_EX1_102,            
                       APL_EX1_103,            
                       APL_EX1_104,            
                       APL_EX1_105,            
                       APL_EX1_106,            
                       APL_EX1_107,            
                       APL_EX1_108,            
                       APL_EX1_109,            
                       APL_EX1_110,            
                       APL_EX1_111,            
                       APL_EX1_112,            
                       APL_EX1_113,            
                       APL_EX1_114,            
                       APL_EX1_115,            
                       APL_EX1_116,            
                       APL_EX1_117,            
                       APL_EX1_118,            
                       APL_EX1_119,            
                       APL_EX1_120,            
                       APL_EX1_121,            
                       APL_EX1_122,            
                       APL_EX1_123,            
                       APL_EX1_124,            
                       APL_EX1_125,            
                       APL_EX1_126,            
                       APL_EX1_127,            
                       APL_EX1_128,            
                       APL_EX1_129,            
                       APL_EX1_130,            
                       APL_EX1_131,            
                       APL_EX1_132,            
                       APL_EX1_133,            
                       APL_EX1_134,            
                       APL_EX1_135,            
                       APL_EX1_136,            
                       APL_EX1_137,            
                       APL_EX1_138,            
                       APL_EX1_139,            
                       APL_EX1_140,            
                       APL_EX1_141,            
                       APL_EX1_142,            
                       APL_EX1_143,            
                       APL_EX1_144,            
                       APL_EX1_145,            
                       APL_EX1_146,            
                       APL_EX1_147,            
        APL_EX1_148,            
                       APL_EX1_149,            
                       APL_EX1_150)            
    SELECT LT.OWNERID,            
        DT.NEWAPPLICATIONID,        
        LT.APL_EX1_1,            
        LT.APL_EX1_2,            
        LT.APL_EX1_3,            
        LT.APL_EX1_4,            
        LT.APL_EX1_5,            
        LT.APL_EX1_6,            
        LT.APL_EX1_7,            
        LT.APL_EX1_8,            
        LT.APL_EX1_9,            
        LT.APL_EX1_10,            
        LT.APL_EX1_11,            
        LT.APL_EX1_12,            
        LT.APL_EX1_13,            
        LT.APL_EX1_14,            
        LT.APL_EX1_15,            
        LT.APL_EX1_16,            
        LT.APL_EX1_17,            
        LT.APL_EX1_18,            
        LT.APL_EX1_19,            
        LT.APL_EX1_20,            
        LT.APL_EX1_21,            
        LT.APL_EX1_22,            
        LT.APL_EX1_23,            
        LT.APL_EX1_24,            
        LT.APL_EX1_25,            
        LT.APL_EX1_26,            
        LT.APL_EX1_27,            
        LT.APL_EX1_28,            
        LT.APL_EX1_29,            
        LT.APL_EX1_30,            
        LT.APL_EX1_31,            
        LT.APL_EX1_32,            
        LT.APL_EX1_33,            
        LT.APL_EX1_34,            
        LT.APL_EX1_35,            
        LT.APL_EX1_36,            
        LT.APL_EX1_37,            
        LT.APL_EX1_38,            
        LT.APL_EX1_39,            
        LT.APL_EX1_40,            
        LT.APL_EX1_41,            
        LT.APL_EX1_42,            
        LT.APL_EX1_43,            
        LT.APL_EX1_44,            
        LT.APL_EX1_45,            
        LT.APL_EX1_46,            
        LT.APL_EX1_47,            
        LT.APL_EX1_48,            
        LT.APL_EX1_49,            
        LT.APL_EX1_50,            
        LT.APL_EX1_51,            
        LT.APL_EX1_52,            
        @BorrowerType,  
  --LT.APL_EX1_53,            
          
  LT.APL_EX1_54,            
        LT.APL_EX1_55,            
        LT.APL_EX1_56,            
        LT.APL_EX1_57,            
        LT.APL_EX1_58,            
        LT.APL_EX1_59,            
        LT.APL_EX1_60,            
        LT.APL_EX1_61,            
   LT.APL_EX1_62,            
        LT.APL_EX1_63,            
        LT.APL_EX1_64,            
        LT.APL_EX1_65,            
        LT.APL_EX1_66,            
        LT.APL_EX1_67,            
        LT.APL_EX1_68,            
        LT.APL_EX1_69,            
        LT.APL_EX1_70,            
        LT.APL_EX1_71,            
        LT.APL_EX1_72,            
        LT.APL_EX1_73,            
        LT.APL_EX1_74,            
        LT.APL_EX1_75,            
        LT.APL_EX1_76,            
        LT.APL_EX1_77,            
        LT.APL_EX1_78,            
        LT.APL_EX1_79,            
        LT.APL_EX1_80,            
        LT.APL_EX1_81,            
        LT.APL_EX1_82,            
        LT.APL_EX1_83,            
        LT.APL_EX1_84,            
        LT.APL_EX1_85,            
        LT.APL_EX1_86,            
        LT.APL_EX1_87,            
        LT.APL_EX1_88,            
        LT.APL_EX1_89,            
        LT.APL_EX1_90,            
        LT.APL_EX1_91,            
        LT.APL_EX1_92,            
        LT.APL_EX1_93,            
        LT.APL_EX1_94,            
        LT.APL_EX1_95,            
        LT.APL_EX1_96,            
        LT.APL_EX1_97,            
        LT.APL_EX1_98,            
        LT.APL_EX1_99,            
        LT.APL_EX1_100,            
        LT.APL_EX1_101,            
        LT.APL_EX1_102,            
        LT.APL_EX1_103,            
        LT.APL_EX1_104,            
        LT.APL_EX1_105,            
        LT.APL_EX1_106,            
        LT.APL_EX1_107,            
        LT.APL_EX1_108,            
        LT.APL_EX1_109,            
        LT.APL_EX1_110,            
        LT.APL_EX1_111,            
        LT.APL_EX1_112,            
        LT.APL_EX1_113,            
        LT.APL_EX1_114,            
        LT.APL_EX1_115,            
        LT.APL_EX1_116,            
        LT.APL_EX1_117,            
        LT.APL_EX1_118,            
        LT.APL_EX1_119,            
        LT.APL_EX1_120,            
        LT.APL_EX1_121,            
        LT.APL_EX1_122,            
        LT.APL_EX1_123,            
        LT.APL_EX1_124,            
        LT.APL_EX1_125,            
        LT.APL_EX1_126,            
        LT.APL_EX1_127,           
        LT.APL_EX1_128,            
        LT.APL_EX1_129,            
        LT.APL_EX1_130,            
        LT.APL_EX1_131,            
        LT.APL_EX1_132,            
        LT.APL_EX1_133,            
        LT.APL_EX1_134,            
        LT.APL_EX1_135,            
        LT.APL_EX1_136,            
        LT.APL_EX1_137,            
        LT.APL_EX1_138,            
        LT.APL_EX1_139,            
        LT.APL_EX1_140,            
        LT.APL_EX1_141,            
        LT.APL_EX1_142,            
        LT.APL_EX1_143,            
        LT.APL_EX1_144,            
        LT.APL_EX1_145,            
        LT.APL_EX1_146,            
        LT.APL_EX1_147,            
        LT.APL_EX1_148,            
        LT.APL_EX1_149,            
        LT.APL_EX1_150            
   FROM #APLEX1TMP LT         
   INNER JOIN #APLIDTEMP DT ON LT.APL_EX1_ID = DT.APPLICATIONID         
   WHERE LT.OWNERID = 985;            
              
  INSERT INTO APL_EX2(OWNERID,            
       APL_EX2_ID,            
       APL_EX2_1,            
       APL_EX2_2,            
       APL_EX2_3,            
       APL_EX2_4,            
   APL_EX2_5,            
       APL_EX2_6,            
       APL_EX2_7,            
       APL_EX2_8,            
       APL_EX2_9,            
       APL_EX2_10,            
       APL_EX2_11,            
       APL_EX2_12,            
       APL_EX2_13,            
       APL_EX2_14,            
       APL_EX2_15,            
       APL_EX2_16,            
       APL_EX2_17,            
       APL_EX2_18,            
       APL_EX2_19,            
       APL_EX2_20,            
       APL_EX2_21,            
       APL_EX2_22,            
       APL_EX2_23,            
       APL_EX2_24,            
       APL_EX2_25,            
       APL_EX2_26,            
       APL_EX2_27,            
       APL_EX2_28,            
       APL_EX2_29,            
       APL_EX2_30,            
       APL_EX2_31,            
       APL_EX2_32,            
       APL_EX2_33,            
       APL_EX2_34,            
       APL_EX2_35,            
       APL_EX2_36,            
       APL_EX2_37,            
       APL_EX2_38,            
       APL_EX2_39,            
       APL_EX2_40,            
       APL_EX2_41,            
       APL_EX2_42,            
       APL_EX2_43,            
       APL_EX2_44,            
       APL_EX2_45,            
       APL_EX2_46,            
       APL_EX2_47,            
       APL_EX2_48,            
       APL_EX2_49,            
       APL_EX2_50,            
       APL_EX2_51,            
       APL_EX2_52,            
       APL_EX2_53,            
       APL_EX2_54,            
       APL_EX2_55,            
       APL_EX2_56,            
       APL_EX2_57,            
       APL_EX2_58,            
       APL_EX2_59,            
       APL_EX2_60,            
       APL_EX2_61,            
       APL_EX2_62,            
       APL_EX2_63,            
       APL_EX2_64,            
       APL_EX2_65,            
       APL_EX2_66,            
       APL_EX2_67,            
       APL_EX2_68,            
       APL_EX2_69,            
       APL_EX2_70,            
       APL_EX2_71,            
       APL_EX2_72,            
       APL_EX2_73,            
       APL_EX2_74,            
       APL_EX2_75,            
       APL_EX2_76,            
       APL_EX2_77,            
       APL_EX2_78,            
       APL_EX2_79,            
       APL_EX2_80,            
       APL_EX2_81,            
       APL_EX2_82,            
       APL_EX2_83,            
       APL_EX2_84,            
       APL_EX2_85,            
       APL_EX2_86,            
       APL_EX2_87,            
       APL_EX2_88,            
       APL_EX2_89,            
       APL_EX2_90,            
       APL_EX2_91,            
       APL_EX2_92,            
       APL_EX2_93,            
       APL_EX2_94,            
       APL_EX2_95,            
       APL_EX2_96,            
       APL_EX2_97,            
       APL_EX2_98,            
       APL_EX2_99,            
    APL_EX2_100,            
       APL_EX2_101,            
       APL_EX2_102,            
       APL_EX2_103,            
       APL_EX2_104,            
       APL_EX2_105,            
       APL_EX2_106,            
       APL_EX2_107,            
       APL_EX2_108,            
       APL_EX2_109,            
       APL_EX2_110,            
       APL_EX2_111,            
       APL_EX2_112,            
       APL_EX2_113,            
       APL_EX2_114,            
       APL_EX2_115,            
       APL_EX2_116,            
       APL_EX2_117,            
       APL_EX2_118,            
       APL_EX2_119,            
       APL_EX2_120,            
       APL_EX2_121,            
       APL_EX2_122,            
       APL_EX2_123,            
       APL_EX2_124,            
       APL_EX2_125,            
       APL_EX2_126,            
       APL_EX2_127,            
       APL_EX2_128,            
       APL_EX2_129,            
       APL_EX2_130,            
       APL_EX2_131,            
       APL_EX2_132,            
       APL_EX2_133,            
       APL_EX2_134,            
       APL_EX2_135,            
       APL_EX2_136,            
       APL_EX2_137,            
       APL_EX2_138,            
       APL_EX2_139,            
       APL_EX2_140,            
       APL_EX2_141,            
       APL_EX2_142,            
       APL_EX2_143,            
       APL_EX2_144,            
       APL_EX2_145,            
       APL_EX2_146,            
       APL_EX2_147,            
       APL_EX2_148,            
       APL_EX2_149,            
       APL_EX2_150)            
      SELECT LT.OWNERID,            
       DT.NEWAPPLICATIONID,            
       LT.APL_EX2_1,            
       LT.APL_EX2_2,            
       LT.APL_EX2_3,            
       LT.APL_EX2_4,            
       LT.APL_EX2_5,            
       LT.APL_EX2_6,            
       LT.APL_EX2_7,            
       LT.APL_EX2_8,            
       LT.APL_EX2_9,            
       LT.APL_EX2_10,            
       LT.APL_EX2_11,            
       LT.APL_EX2_12,            
       LT.APL_EX2_13,            
       LT.APL_EX2_14,            
       LT.APL_EX2_15,            
       LT.APL_EX2_16,            
       LT.APL_EX2_17,            
       LT.APL_EX2_18,            
       LT.APL_EX2_19,            
       LT.APL_EX2_20,            
       LT.APL_EX2_21,            
       LT.APL_EX2_22,            
       LT.APL_EX2_23,            
       LT.APL_EX2_24,            
       LT.APL_EX2_25,            
       LT.APL_EX2_26,            
       LT.APL_EX2_27,            
       LT.APL_EX2_28,            
       LT.APL_EX2_29,            
       LT.APL_EX2_30,            
       LT.APL_EX2_31,            
       LT.APL_EX2_32,            
       LT.APL_EX2_33,            
       LT.APL_EX2_34,            
       LT.APL_EX2_35,            
       LT.APL_EX2_36,            
       LT.APL_EX2_37,            
       LT.APL_EX2_38,            
       LT.APL_EX2_39,            
       LT.APL_EX2_40,            
       LT.APL_EX2_41,            
       LT.APL_EX2_42,            
       LT.APL_EX2_43,            
       LT.APL_EX2_44,            
       LT.APL_EX2_45,            
       LT.APL_EX2_46,            
       LT.APL_EX2_47,            
       LT.APL_EX2_48,            
       LT.APL_EX2_49,            
       LT.APL_EX2_50,            
       LT.APL_EX2_51,            
       LT.APL_EX2_52,            
       LT.APL_EX2_53,            
       LT.APL_EX2_54,            
       LT.APL_EX2_55,            
       LT.APL_EX2_56,            
       LT.APL_EX2_57,            
       LT.APL_EX2_58,            
       LT.APL_EX2_59,            
       LT.APL_EX2_60,            
       LT.APL_EX2_61,            
       LT.APL_EX2_62,            
       LT.APL_EX2_63,            
       LT.APL_EX2_64,            
       LT.APL_EX2_65,            
       LT.APL_EX2_66,            
       LT.APL_EX2_67,            
       LT.APL_EX2_68,            
       LT.APL_EX2_69,            
       LT.APL_EX2_70,            
       LT.APL_EX2_71,            
       LT.APL_EX2_72,            
       LT.APL_EX2_73,            
       LT.APL_EX2_74,            
       LT.APL_EX2_75,            
       LT.APL_EX2_76,            
       LT.APL_EX2_77,            
       LT.APL_EX2_78,            
       LT.APL_EX2_79,            
       LT.APL_EX2_80,            
       LT.APL_EX2_81,            
       LT.APL_EX2_82,            
       LT.APL_EX2_83,            
       LT.APL_EX2_84,            
       LT.APL_EX2_85,            
       LT.APL_EX2_86,            
       LT.APL_EX2_87,            
       LT.APL_EX2_88,            
       LT.APL_EX2_89,            
       LT.APL_EX2_90,            
       LT.APL_EX2_91,            
       LT.APL_EX2_92,            
       LT.APL_EX2_93,            
       LT.APL_EX2_94,            
       LT.APL_EX2_95,            
       LT.APL_EX2_96,            
       LT.APL_EX2_97,            
       LT.APL_EX2_98,            
       LT.APL_EX2_99,            
       LT.APL_EX2_100,            
       LT.APL_EX2_101,            
       LT.APL_EX2_102,            
       LT.APL_EX2_103,            
       LT.APL_EX2_104,            
       LT.APL_EX2_105,            
       LT.APL_EX2_106,            
       LT.APL_EX2_107,            
       LT.APL_EX2_108,            
       LT.APL_EX2_109,            
       LT.APL_EX2_110,            
       LT.APL_EX2_111,            
       LT.APL_EX2_112,            
       LT.APL_EX2_113,            
       LT.APL_EX2_114,            
       LT.APL_EX2_115,            
       LT.APL_EX2_116,            
       LT.APL_EX2_117,            
       LT.APL_EX2_118,            
       LT.APL_EX2_119,            
       LT.APL_EX2_120,            
       LT.APL_EX2_121,            
       LT.APL_EX2_122,            
    LT.APL_EX2_123,            
       LT.APL_EX2_124,            
       LT.APL_EX2_125,            
       LT.APL_EX2_126,            
       LT.APL_EX2_127,            
       LT.APL_EX2_128,            
       LT.APL_EX2_129,            
       LT.APL_EX2_130,            
       LT.APL_EX2_131,            
       LT.APL_EX2_132,            
       LT.APL_EX2_133,            
       LT.APL_EX2_134,            
       LT.APL_EX2_135,            
       LT.APL_EX2_136,            
       LT.APL_EX2_137,            
       LT.APL_EX2_138,            
       LT.APL_EX2_139,            
       LT.APL_EX2_140,            
       LT.APL_EX2_141,            
       LT.APL_EX2_142,            
       LT.APL_EX2_143,            
       LT.APL_EX2_144,            
       LT.APL_EX2_145,            
       LT.APL_EX2_146,            
       LT.APL_EX2_147,            
       LT.APL_EX2_148,            
       LT.APL_EX2_149,            
       LT.APL_EX2_150            
        FROM #APLEX2TMP LT         
  INNER JOIN #APLIDTEMP DT ON LT.APL_EX2_ID = DT.APPLICATIONID        
        WHERE LT.OWNERID = 985;            
              
  INSERT INTO APL_EX3(OWNERID,            
       APL_EX3_ID,            
       APL_EX3_1,            
       APL_EX3_2,            
       APL_EX3_3,            
       APL_EX3_4,            
       APL_EX3_5,            
       APL_EX3_6,            
       APL_EX3_7,            
       APL_EX3_8,            
       APL_EX3_9,            
       APL_EX3_10,            
       APL_EX3_11,            
       APL_EX3_12,            
       APL_EX3_13,            
       APL_EX3_14,            
       APL_EX3_15,            
       APL_EX3_16,            
       APL_EX3_17,                   
       APL_EX3_18,            
APL_EX3_19,            
       APL_EX3_20,            
       APL_EX3_21,            
       APL_EX3_22,            
       APL_EX3_23,            
       APL_EX3_24,            
       APL_EX3_25,            
       APL_EX3_26,            
       APL_EX3_27,            
       APL_EX3_28,            
       APL_EX3_29,            
       APL_EX3_30,            
       APL_EX3_31,            
       APL_EX3_32,            
       APL_EX3_33,            
       APL_EX3_34,            
       APL_EX3_35,            
       APL_EX3_36,            
       APL_EX3_37,            
       APL_EX3_38,       
       APL_EX3_39,            
       APL_EX3_40,            
       APL_EX3_41,            
       APL_EX3_42,            
       APL_EX3_43,            
       APL_EX3_44,            
       APL_EX3_45,            
       APL_EX3_46,            
       APL_EX3_47,            
       APL_EX3_48,            
       APL_EX3_49,            
       APL_EX3_50,            
       APL_EX3_51,            
       APL_EX3_52,            
       APL_EX3_53,            
       APL_EX3_54,            
       APL_EX3_55,            
       APL_EX3_56,            
       APL_EX3_57,            
       APL_EX3_58,            
       APL_EX3_59,            
       APL_EX3_60,            
       APL_EX3_61,            
       APL_EX3_62,            
       APL_EX3_63,            
       APL_EX3_64,            
       APL_EX3_65,            
       APL_EX3_66,            
       APL_EX3_67,            
       APL_EX3_68,            
       APL_EX3_69,            
       APL_EX3_70,            
       APL_EX3_71,            
       APL_EX3_72,            
       APL_EX3_73,            
       APL_EX3_74,            
       APL_EX3_75,            
       APL_EX3_76,            
       APL_EX3_77,            
       APL_EX3_78,            
       APL_EX3_79,            
       APL_EX3_80,            
       APL_EX3_81,            
       APL_EX3_82,            
       APL_EX3_83,            
       APL_EX3_84,            
       APL_EX3_85,            
       APL_EX3_86,            
       APL_EX3_87,            
       APL_EX3_88,            
       APL_EX3_89,            
       APL_EX3_90,            
       APL_EX3_91,            
       APL_EX3_92,            
       APL_EX3_93,            
       APL_EX3_94,            
       APL_EX3_95,            
       APL_EX3_96,            
       APL_EX3_97,            
       APL_EX3_98,            
       APL_EX3_99,            
       APL_EX3_100,            
       APL_EX3_101,            
       APL_EX3_102,            
       APL_EX3_103,            
APL_EX3_104,            
       APL_EX3_105,            
       APL_EX3_106,            
       APL_EX3_107,            
       APL_EX3_108,            
       APL_EX3_109,            
       APL_EX3_110,            
       APL_EX3_111,            
       APL_EX3_112,            
       APL_EX3_113,            
       APL_EX3_114,            
       APL_EX3_115,            
       APL_EX3_116,            
       APL_EX3_117,            
       APL_EX3_118,            
       APL_EX3_119,            
       APL_EX3_120,            
       APL_EX3_121,            
       APL_EX3_122,            
       APL_EX3_123,            
       APL_EX3_124,            
       APL_EX3_125,            
       APL_EX3_126,            
       APL_EX3_127,            
       APL_EX3_128,            
       APL_EX3_129,            
       APL_EX3_130,            
       APL_EX3_131,            
       APL_EX3_132,            
       APL_EX3_133,            
       APL_EX3_134,            
       APL_EX3_135,            
       APL_EX3_136,            
       APL_EX3_137,            
       APL_EX3_138,            
       APL_EX3_139,            
       APL_EX3_140,            
       APL_EX3_141,            
       APL_EX3_142,            
       APL_EX3_143,            
       APL_EX3_144,            
       APL_EX3_145,            
       APL_EX3_146,            
       APL_EX3_147,            
       APL_EX3_148,            
       APL_EX3_149,            
       APL_EX3_150)            
      SELECT LT.OWNERID,            
       DT.NEWAPPLICATIONID,            
       LT.APL_EX3_1,            
       LT.APL_EX3_2,            
       LT.APL_EX3_3,            
       LT.APL_EX3_4,            
       LT.APL_EX3_5,            
       LT.APL_EX3_6,            
       LT.APL_EX3_7,            
       LT.APL_EX3_8,            
       LT.APL_EX3_9,            
       LT.APL_EX3_10,            
       LT.APL_EX3_11,            
       LT.APL_EX3_12,            
       LT.APL_EX3_13,            
       LT.APL_EX3_14,            
       LT.APL_EX3_15,            
       LT.APL_EX3_16,     
     LT.APL_EX3_17,            
       LT.APL_EX3_18,            
       LT.APL_EX3_19,            
       LT.APL_EX3_20,            
       LT.APL_EX3_21,            
       LT.APL_EX3_22,            
       LT.APL_EX3_23,            
       LT.APL_EX3_24,            
       LT.APL_EX3_25,            
       LT.APL_EX3_26,            
       LT.APL_EX3_27,            
       LT.APL_EX3_28,            
       LT.APL_EX3_29,            
       LT.APL_EX3_30,            
       LT.APL_EX3_31,            
       LT.APL_EX3_32,            
       LT.APL_EX3_33,            
       LT.APL_EX3_34,            
       LT.APL_EX3_35,            
       LT.APL_EX3_36,            
       LT.APL_EX3_37,            
       LT.APL_EX3_38,            
       LT.APL_EX3_39,            
       LT.APL_EX3_40,            
       LT.APL_EX3_41,            
       LT.APL_EX3_42,            
       LT.APL_EX3_43,            
       LT.APL_EX3_44,            
       LT.APL_EX3_45,            
       LT.APL_EX3_46,            
       LT.APL_EX3_47,            
       LT.APL_EX3_48,            
       LT.APL_EX3_49,            
       LT.APL_EX3_50,            
       LT.APL_EX3_51,            
       LT.APL_EX3_52,            
       LT.APL_EX3_53,            
       LT.APL_EX3_54,            
       LT.APL_EX3_55,            
       LT.APL_EX3_56,            
       LT.APL_EX3_57,            
       LT.APL_EX3_58,            
       LT.APL_EX3_59,            
       LT.APL_EX3_60,            
       LT.APL_EX3_61,            
       LT.APL_EX3_62,            
       LT.APL_EX3_63,            
       LT.APL_EX3_64,            
       LT.APL_EX3_65,            
       LT.APL_EX3_66,            
       LT.APL_EX3_67,            
       LT.APL_EX3_68,            
       LT.APL_EX3_69,            
       LT.APL_EX3_70,            
       LT.APL_EX3_71,            
       LT.APL_EX3_72,            
       LT.APL_EX3_73,            
       LT.APL_EX3_74,            
       LT.APL_EX3_75,            
       LT.APL_EX3_76,            
       LT.APL_EX3_77,            
       LT.APL_EX3_78,            
       LT.APL_EX3_79,            
       LT.APL_EX3_80,            
       LT.APL_EX3_81,            
       LT.APL_EX3_82,            
       LT.APL_EX3_83,            
       LT.APL_EX3_84,            
       LT.APL_EX3_85,            
       LT.APL_EX3_86,            
       LT.APL_EX3_87,            
       LT.APL_EX3_88,            
       LT.APL_EX3_89,            
       LT.APL_EX3_90,            
       LT.APL_EX3_91,            
       LT.APL_EX3_92,            
       LT.APL_EX3_93,            
       LT.APL_EX3_94,            
       LT.APL_EX3_95,            
       LT.APL_EX3_96,            
       LT.APL_EX3_97,            
       LT.APL_EX3_98,            
       LT.APL_EX3_99,            
       LT.APL_EX3_100,            
       LT.APL_EX3_101,            
       LT.APL_EX3_102,            
       LT.APL_EX3_103,            
       LT.APL_EX3_104,            
       LT.APL_EX3_105,            
       LT.APL_EX3_106,            
       LT.APL_EX3_107,            
       LT.APL_EX3_108,            
       LT.APL_EX3_109,            
       LT.APL_EX3_110,            
       LT.APL_EX3_111,            
       LT.APL_EX3_112,            
       LT.APL_EX3_113,            
       LT.APL_EX3_114,            
       LT.APL_EX3_115,            
       LT.APL_EX3_116,            
       LT.APL_EX3_117,            
       LT.APL_EX3_118,            
       LT.APL_EX3_119,            
       LT.APL_EX3_120,            
       LT.APL_EX3_121,            
       LT.APL_EX3_122,            
       LT.APL_EX3_123,            
       LT.APL_EX3_124,            
       LT.APL_EX3_125,            
       LT.APL_EX3_126,            
       LT.APL_EX3_127,            
       LT.APL_EX3_128,            
       LT.APL_EX3_129,            
       LT.APL_EX3_130,            
       LT.APL_EX3_131,            
       LT.APL_EX3_132,            
       LT.APL_EX3_133,            
       LT.APL_EX3_134,            
       LT.APL_EX3_135,            
       LT.APL_EX3_136,            
      LT.APL_EX3_137,            
       LT.APL_EX3_138,            
       LT.APL_EX3_139,            
       LT.APL_EX3_140,            
       LT.APL_EX3_141,            
       LT.APL_EX3_142,            
       LT.APL_EX3_143,            
       LT.APL_EX3_144,            
       LT.APL_EX3_145,            
       LT.APL_EX3_146,            
       LT.APL_EX3_147,            
       LT.APL_EX3_148,            
       LT.APL_EX3_149,            
       LT.APL_EX3_150            
        FROM #APLEX3TMP LT         
  INNER JOIN #APLIDTEMP DT ON LT.APL_EX3_ID = DT.APPLICATIONID         
        WHERE LT.OWNERID = 985;            
            
  INSERT INTO APL_EX4(OWNERID,            
                APL_EX4_ID,            
                APL_EX4_1,            
                APL_EX4_2,            
                APL_EX4_3,            
                APL_EX4_4,            
                APL_EX4_5,            
                APL_EX4_6,            
                APL_EX4_7,            
                APL_EX4_8,            
                APL_EX4_9,            
                APL_EX4_10,            
                APL_EX4_11,            
                APL_EX4_12,            
                APL_EX4_13,            
                APL_EX4_14,            
                APL_EX4_15,            
                APL_EX4_16,            
                APL_EX4_17,            
                APL_EX4_18,            
                APL_EX4_19,            
                APL_EX4_20,            
                APL_EX4_21,            
                APL_EX4_22,            
                APL_EX4_23,            
                APL_EX4_24,            
                APL_EX4_25,            
                APL_EX4_26,            
                APL_EX4_27,            
                APL_EX4_28,            
                APL_EX4_29,            
                APL_EX4_30,            
                APL_EX4_31,            
                APL_EX4_32,            
                APL_EX4_33,            
                APL_EX4_34,            
                APL_EX4_35,            
                APL_EX4_36,            
                APL_EX4_37,            
                APL_EX4_38,            
                APL_EX4_39,            
                APL_EX4_40,            
                APL_EX4_41,            
                APL_EX4_42,            
                APL_EX4_43,            
                APL_EX4_44,            
                APL_EX4_45,     
                APL_EX4_46,            
                APL_EX4_47,            
                APL_EX4_48,            
                APL_EX4_49,            
                APL_EX4_50,            
                APL_EX4_51,            
                APL_EX4_52,            
                APL_EX4_53,            
                APL_EX4_54,            
                APL_EX4_55,            
                APL_EX4_56,            
                APL_EX4_57,            
                APL_EX4_58,            
                APL_EX4_59,            
                APL_EX4_60,            
                APL_EX4_61,            
                APL_EX4_62,            
                APL_EX4_63,            
                APL_EX4_64,            
                APL_EX4_65,            
                APL_EX4_66,            
                APL_EX4_67,            
                APL_EX4_68,            
                APL_EX4_69,            
                APL_EX4_70,            
                APL_EX4_71,            
                APL_EX4_72,            
                APL_EX4_73,            
                APL_EX4_74,            
                APL_EX4_75,            
                APL_EX4_76,            
                APL_EX4_77,            
                APL_EX4_78,            
                APL_EX4_79,            
                APL_EX4_80,            
                APL_EX4_81,            
                APL_EX4_82,            
                APL_EX4_83,            
                APL_EX4_84,            
                APL_EX4_85,            
                APL_EX4_86,            
                APL_EX4_87,            
                APL_EX4_88,            
                APL_EX4_89,            
                APL_EX4_90,            
                APL_EX4_91,            
                APL_EX4_92,            
                APL_EX4_93,            
                APL_EX4_94,            
                APL_EX4_95,            
                APL_EX4_96,            
                APL_EX4_97,            
                APL_EX4_98,            
                APL_EX4_99,            
                APL_EX4_100,            
                APL_EX4_101,            
                APL_EX4_102,            
                APL_EX4_103,            
                APL_EX4_104,            
                APL_EX4_105,            
                APL_EX4_106,            
                APL_EX4_107,            
                APL_EX4_108,            
                APL_EX4_109,            
                APL_EX4_110,         
                APL_EX4_111,            
                APL_EX4_112,            
                APL_EX4_113,            
                APL_EX4_114,            
                APL_EX4_115,            
                APL_EX4_116,            
                APL_EX4_117,            
                APL_EX4_118,            
                APL_EX4_119,            
                APL_EX4_120,            
                APL_EX4_121,            
                APL_EX4_122,            
                APL_EX4_123,            
                APL_EX4_124,            
                APL_EX4_125,            
                APL_EX4_126,            
                APL_EX4_127,            
                APL_EX4_128,            
                APL_EX4_129,            
                APL_EX4_130,            
                APL_EX4_131,            
                APL_EX4_132,            
                APL_EX4_133,            
                APL_EX4_134,            
                APL_EX4_135,            
                APL_EX4_136,            
                APL_EX4_137,            
                APL_EX4_138,            
                APL_EX4_139,            
                APL_EX4_140,            
                APL_EX4_141,            
                APL_EX4_142,            
                APL_EX4_143,            
                APL_EX4_144,            
                APL_EX4_145,            
                APL_EX4_146,            
                APL_EX4_147,            
                APL_EX4_148,            
                APL_EX4_149,            
                APL_EX4_150)            
       SELECT   LT.OWNERID,            
       DT.NEWAPPLICATIONID,            
                         LT.APL_EX4_1,            
                         LT.APL_EX4_2,            
                         LT.APL_EX4_3,            
                         LT.APL_EX4_4,            
                         LT.APL_EX4_5,            
                         LT.APL_EX4_6,            
                         LT.APL_EX4_7,            
                         LT.APL_EX4_8,            
                         LT.APL_EX4_9,            
                         LT.APL_EX4_10,            
                         LT.APL_EX4_11,            
                         LT.APL_EX4_12,            
                         LT.APL_EX4_13,            
                         LT.APL_EX4_14,            
                         LT.APL_EX4_15,            
                         LT.APL_EX4_16,            
                         LT.APL_EX4_17,            
                         LT.APL_EX4_18,            
                         LT.APL_EX4_19,            
                         LT.APL_EX4_20,            
                         LT.APL_EX4_21,            
                         LT.APL_EX4_22,            
                         LT.APL_EX4_23,            
                         LT.APL_EX4_24,            
                         LT.APL_EX4_25,            
                         LT.APL_EX4_26,            
                  LT.APL_EX4_27,            
                         LT.APL_EX4_28,            
             LT.APL_EX4_29,            
                         LT.APL_EX4_30,            
                         LT.APL_EX4_31,            
                         LT.APL_EX4_32,            
                         LT.APL_EX4_33,            
                         LT.APL_EX4_34,            
                         LT.APL_EX4_35,            
                         LT.APL_EX4_36,            
                         LT.APL_EX4_37,            
                         LT.APL_EX4_38,            
                         LT.APL_EX4_39,            
                         LT.APL_EX4_40,            
                         LT.APL_EX4_41,            
                         LT.APL_EX4_42,            
                         LT.APL_EX4_43,            
                         LT.APL_EX4_44,            
                         LT.APL_EX4_45,            
                         LT.APL_EX4_46,            
                         LT.APL_EX4_47,            
                         LT.APL_EX4_48,            
                         LT.APL_EX4_49,            
                         LT.APL_EX4_50,            
                         LT.APL_EX4_51,            
                         LT.APL_EX4_52,            
                         LT.APL_EX4_53,            
         LT.APL_EX4_54,            
                         LT.APL_EX4_55,            
                         LT.APL_EX4_56,            
                         LT.APL_EX4_57,            
                         LT.APL_EX4_58,            
                         LT.APL_EX4_59,            
                         LT.APL_EX4_60,            
                         LT.APL_EX4_61,            
                         LT.APL_EX4_62,            
                         LT.APL_EX4_63,            
                         LT.APL_EX4_64,            
                         LT.APL_EX4_65,            
                         LT.APL_EX4_66,            
                         LT.APL_EX4_67,            
                         LT.APL_EX4_68,            
                         LT.APL_EX4_69,            
                         LT.APL_EX4_70,            
                         LT.APL_EX4_71,            
                         LT.APL_EX4_72,            
                         LT.APL_EX4_73,            
                         LT.APL_EX4_74,            
                         LT.APL_EX4_75,            
                         LT.APL_EX4_76,            
                         LT.APL_EX4_77,            
                         LT.APL_EX4_78,            
                         LT.APL_EX4_79,            
                         LT.APL_EX4_80,            
                         LT.APL_EX4_81,            
                         LT.APL_EX4_82,            
               LT.APL_EX4_83,            
                         LT.APL_EX4_84,            
                         LT.APL_EX4_85,            
                         LT.APL_EX4_86,            
                         LT.APL_EX4_87,            
                         LT.APL_EX4_88,            
                         LT.APL_EX4_89,            
                         LT.APL_EX4_90,            
                         LT.APL_EX4_91,            
                         LT.APL_EX4_92,            
                         LT.APL_EX4_93,            
                         LT.APL_EX4_94,            
                         LT.APL_EX4_95,            
                         LT.APL_EX4_96,            
                         LT.APL_EX4_97,            
                         LT.APL_EX4_98,            
                         LT.APL_EX4_99,            
                         LT.APL_EX4_100,            
                         LT.APL_EX4_101,            
                         LT.APL_EX4_102,            
                         LT.APL_EX4_103,            
                         LT.APL_EX4_104,            
                         LT.APL_EX4_105,            
               LT.APL_EX4_106,            
                         LT.APL_EX4_107,            
                         LT.APL_EX4_108,            
                         LT.APL_EX4_109,            
                         LT.APL_EX4_110,            
                         LT.APL_EX4_111,            
                         LT.APL_EX4_112,            
                         LT.APL_EX4_113,            
                         LT.APL_EX4_114,            
                         LT.APL_EX4_115,            
                         LT.APL_EX4_116,            
                         LT.APL_EX4_117,            
                         LT.APL_EX4_118,            
                         LT.APL_EX4_119,            
                         LT.APL_EX4_120,            
                         LT.APL_EX4_121,            
                         LT.APL_EX4_122,            
                         LT.APL_EX4_123,            
                         LT.APL_EX4_124,            
                         LT.APL_EX4_125,            
                         LT.APL_EX4_126,            
                         LT.APL_EX4_127,            
                         LT.APL_EX4_128,            
                         LT.APL_EX4_129,            
                         LT.APL_EX4_130,            
                         LT.APL_EX4_131,            
                         LT.APL_EX4_132,            
                         LT.APL_EX4_133,            
                         LT.APL_EX4_134,            
                         LT.APL_EX4_135,            
                         LT.APL_EX4_136,            
                         LT.APL_EX4_137,            
                         LT.APL_EX4_138,            
                         LT.APL_EX4_139,            
                         LT.APL_EX4_140,            
                         LT.APL_EX4_141,            
                         LT.APL_EX4_142,            
                         LT.APL_EX4_143,            
                         LT.APL_EX4_144,            
                         LT.APL_EX4_145,            
                         LT.APL_EX4_146,            
                         LT.APL_EX4_147,            
                         LT.APL_EX4_148,            
                         LT.APL_EX4_149,            
                         LT.APL_EX4_150            
         FROM #APLEX4TMP LT         
   INNER JOIN #APLIDTEMP DT ON LT.APL_EX4_ID = DT.APPLICATIONID          
         WHERE LT.OWNERID = 985;            
            
  INSERT INTO APL_EX5(OWNERID,            
       APL_EX5_ID,            
       APL_EX5_1,            
       APL_EX5_2,            
       APL_EX5_3,            
       APL_EX5_4,            
       APL_EX5_5,            
       APL_EX5_6,            
       APL_EX5_7,            
       APL_EX5_8,            
       APL_EX5_9,            
       APL_EX5_10,            
       APL_EX5_11,            
       APL_EX5_12,            
       APL_EX5_13,            
       APL_EX5_14,            
       APL_EX5_15,           
       APL_EX5_16,            
       APL_EX5_17,            
       APL_EX5_18,            
       APL_EX5_19,            
       APL_EX5_20,            
       APL_EX5_21,            
       APL_EX5_22,            
       APL_EX5_23,            
       APL_EX5_24,            
       APL_EX5_25,            
       APL_EX5_26,            
       APL_EX5_27,            
       APL_EX5_28,            
       APL_EX5_29,            
       APL_EX5_30,            
       APL_EX5_31,            
       APL_EX5_32,            
       APL_EX5_33,            
       APL_EX5_34,            
       APL_EX5_35,            
       APL_EX5_36,            
       APL_EX5_37,            
       APL_EX5_38,            
       APL_EX5_39,            
       APL_EX5_40,            
       APL_EX5_41,            
       APL_EX5_42,            
       APL_EX5_43,            
       APL_EX5_44,            
       APL_EX5_45,            
       APL_EX5_46,            
       APL_EX5_47,            
       APL_EX5_48,            
   APL_EX5_49,            
       APL_EX5_50,            
       APL_EX5_51,            
       APL_EX5_52,            
       APL_EX5_53,            
       APL_EX5_54,            
       APL_EX5_55,            
       APL_EX5_56,            
       APL_EX5_57,            
       APL_EX5_58,            
       APL_EX5_59,            
       APL_EX5_60,            
       APL_EX5_61,            
       APL_EX5_62,            
       APL_EX5_63,            
       APL_EX5_64,            
       APL_EX5_65,            
       APL_EX5_66,            
       APL_EX5_67,            
       APL_EX5_68,            
       APL_EX5_69,            
       APL_EX5_70,            
       APL_EX5_71,            
       APL_EX5_72,            
       APL_EX5_73,            
       APL_EX5_74,            
       APL_EX5_75,            
       APL_EX5_76,            
       APL_EX5_77,            
       APL_EX5_78,            
       APL_EX5_79,            
       APL_EX5_80,            
       APL_EX5_81,            
       APL_EX5_82,            
       APL_EX5_83,            
       APL_EX5_84,            
       APL_EX5_85,            
       APL_EX5_86,            
       APL_EX5_87,            
       APL_EX5_88,            
       APL_EX5_89,            
       APL_EX5_90,            
       APL_EX5_91,            
       APL_EX5_92,            
       APL_EX5_93,            
       APL_EX5_94,            
       APL_EX5_95,            
       APL_EX5_96,            
       APL_EX5_97,            
       APL_EX5_98,            
       APL_EX5_99,            
       APL_EX5_100,            
       APL_EX5_101,            
       APL_EX5_102,            
       APL_EX5_103,            
       APL_EX5_104,            
       APL_EX5_105,            
       APL_EX5_106,            
       APL_EX5_107,            
       APL_EX5_108,            
       APL_EX5_109,            
       APL_EX5_110,            
       APL_EX5_111,            
       APL_EX5_112,            
       APL_EX5_113,            
       APL_EX5_114,            
       APL_EX5_115,            
       APL_EX5_116,            
       APL_EX5_117,            
       APL_EX5_118,            
       APL_EX5_119,            
       APL_EX5_120,            
       APL_EX5_121,            
   APL_EX5_122,            
       APL_EX5_123,            
       APL_EX5_124,            
       APL_EX5_125,            
       APL_EX5_126,            
       APL_EX5_127,            
       APL_EX5_128,            
       APL_EX5_129,            
       APL_EX5_130,            
       APL_EX5_131,            
       APL_EX5_132,            
       APL_EX5_133,            
       APL_EX5_134,            
       APL_EX5_135,            
       APL_EX5_136,            
       APL_EX5_137,            
       APL_EX5_138,            
       APL_EX5_139,            
       APL_EX5_140,            
       APL_EX5_141,            
       APL_EX5_142,            
       APL_EX5_143,            
       APL_EX5_144,            
       APL_EX5_145,            
       APL_EX5_146,            
       APL_EX5_147,            
       APL_EX5_148,            
       APL_EX5_149,            
       APL_EX5_150,            
       APL_EX5_151,            
       APL_EX5_152,            
       APL_EX5_153,            
       APL_EX5_154,            
       APL_EX5_155,            
       APL_EX5_156,            
       APL_EX5_157,            
       APL_EX5_158,            
       APL_EX5_159,            
       APL_EX5_160,            
       APL_EX5_161,            
       APL_EX5_162,            
       APL_EX5_163,            
       APL_EX5_164,            
       APL_EX5_165,            
       APL_EX5_166,            
       APL_EX5_167,            
       APL_EX5_168,            
       APL_EX5_169,            
       APL_EX5_170,            
       APL_EX5_171,            
       APL_EX5_172,            
       APL_EX5_173,            
       APL_EX5_174,            
       APL_EX5_175,            
       APL_EX5_176,            
       APL_EX5_177,            
       APL_EX5_178,            
       APL_EX5_179,   
       APL_EX5_180,            
       APL_EX5_181,            
       APL_EX5_182,            
       APL_EX5_183,            
       APL_EX5_184,            
       APL_EX5_185,            
       APL_EX5_186,            
       APL_EX5_187,            
       APL_EX5_188,            
       APL_EX5_189,            
       APL_EX5_190,            
       APL_EX5_191,            
       APL_EX5_192,            
       APL_EX5_193,            
       APL_EX5_194,            
       APL_EX5_195,            
       APL_EX5_196,            
       APL_EX5_197,            
       APL_EX5_198,            
       APL_EX5_199,            
       APL_EX5_200)            
      SELECT LT.OWNERID,            
                DT.NEWAPPLICATIONID,            
                LT.APL_EX5_1,            
                LT.APL_EX5_2,            
                LT.APL_EX5_3,            
                LT.APL_EX5_4,            
                LT.APL_EX5_5,            
                LT.APL_EX5_6,            
                LT.APL_EX5_7,            
                LT.APL_EX5_8,            
                LT.APL_EX5_9,            
                LT.APL_EX5_10,            
                LT.APL_EX5_11,            
                LT.APL_EX5_12,            
                LT.APL_EX5_13,            
                LT.APL_EX5_14,            
                LT.APL_EX5_15,            
                LT.APL_EX5_16,            
                LT.APL_EX5_17,            
                LT.APL_EX5_18,            
                LT.APL_EX5_19,            
                LT.APL_EX5_20,            
                LT.APL_EX5_21,            
                LT.APL_EX5_22,            
                LT.APL_EX5_23,            
                LT.APL_EX5_24,            
                LT.APL_EX5_25,            
                LT.APL_EX5_26,            
                LT.APL_EX5_27,            
                LT.APL_EX5_28,            
                LT.APL_EX5_29,            
                LT.APL_EX5_30,            
                LT.APL_EX5_31,            
                LT.APL_EX5_32,            
                LT.APL_EX5_33,            
                LT.APL_EX5_34,            
                LT.APL_EX5_35,            
                LT.APL_EX5_36,            
                LT.APL_EX5_37,            
                LT.APL_EX5_38,            
                LT.APL_EX5_39,            
                LT.APL_EX5_40,            
                LT.APL_EX5_41,            
                LT.APL_EX5_42,            
                LT.APL_EX5_43,            
                LT.APL_EX5_44,            
                LT.APL_EX5_45,            
                LT.APL_EX5_46,            
                LT.APL_EX5_47,            
                LT.APL_EX5_48,            
                LT.APL_EX5_49,            
                LT.APL_EX5_50,            
                LT.APL_EX5_51,            
                LT.APL_EX5_52,            
                LT.APL_EX5_53,            
                LT.APL_EX5_54,            
                LT.APL_EX5_55,            
                LT.APL_EX5_56,            
                LT.APL_EX5_57,            
                LT.APL_EX5_58,            
                LT.APL_EX5_59,            
                LT.APL_EX5_60,            
                LT.APL_EX5_61,            
                LT.APL_EX5_62,            
                LT.APL_EX5_63,            
                LT.APL_EX5_64,            
                LT.APL_EX5_65,            
                LT.APL_EX5_66,            
            LT.APL_EX5_67,            
                LT.APL_EX5_68,            
                LT.APL_EX5_69,            
                LT.APL_EX5_70,            
                LT.APL_EX5_71,            
                LT.APL_EX5_72,            
                LT.APL_EX5_73,            
                LT.APL_EX5_74,            
                LT.APL_EX5_75,            
                LT.APL_EX5_76,            
                LT.APL_EX5_77,            
                LT.APL_EX5_78,            
                LT.APL_EX5_79,            
                LT.APL_EX5_80,            
                LT.APL_EX5_81,            
                LT.APL_EX5_82,            
                LT.APL_EX5_83,            
                LT.APL_EX5_84,            
                LT.APL_EX5_85,            
                LT.APL_EX5_86,            
                LT.APL_EX5_87,            
                LT.APL_EX5_88,            
                LT.APL_EX5_89,            
                LT.APL_EX5_90,            
                LT.APL_EX5_91,            
                LT.APL_EX5_92,            
                LT.APL_EX5_93,            
                LT.APL_EX5_94,            
                LT.APL_EX5_95,            
                LT.APL_EX5_96,            
                LT.APL_EX5_97,            
                LT.APL_EX5_98,            
                LT.APL_EX5_99,            
                LT.APL_EX5_100,            
                LT.APL_EX5_101,            
                LT.APL_EX5_102,            
                LT.APL_EX5_103,            
                LT.APL_EX5_104,            
                LT.APL_EX5_105,            
                LT.APL_EX5_106,            
                LT.APL_EX5_107,            
                LT.APL_EX5_108,            
                LT.APL_EX5_109,            
                LT.APL_EX5_110,            
                LT.APL_EX5_111,            
                LT.APL_EX5_112,            
                LT.APL_EX5_113,            
                LT.APL_EX5_114,            
                LT.APL_EX5_115,            
                LT.APL_EX5_116,            
                LT.APL_EX5_117,            
                LT.APL_EX5_118,            
                LT.APL_EX5_119,            
                LT.APL_EX5_120,            
                LT.APL_EX5_121,            
                LT.APL_EX5_122,            
                LT.APL_EX5_123,            
                LT.APL_EX5_124,            
                LT.APL_EX5_125,            
                LT.APL_EX5_126,            
                LT.APL_EX5_127,            
                LT.APL_EX5_128,            
                LT.APL_EX5_129,            
                LT.APL_EX5_130,            
                LT.APL_EX5_131,            
                LT.APL_EX5_132,            
                LT.APL_EX5_133,            
                LT.APL_EX5_134,            
                LT.APL_EX5_135,            
                LT.APL_EX5_136,            
                LT.APL_EX5_137,            
                LT.APL_EX5_138,            
                LT.APL_EX5_139,            
                LT.APL_EX5_140,            
                LT.APL_EX5_141,            
                LT.APL_EX5_142,            
                LT.APL_EX5_143,            
                LT.APL_EX5_144,            
                LT.APL_EX5_145,            
                LT.APL_EX5_146,            
                LT.APL_EX5_147,            
                LT.APL_EX5_148,            
                LT.APL_EX5_149,            
                LT.APL_EX5_150,            
                LT.APL_EX5_151,            
    LT.APL_EX5_152,            
                LT.APL_EX5_153,            
                LT.APL_EX5_154,            
                LT.APL_EX5_155,            
                LT.APL_EX5_156,            
                LT.APL_EX5_157,            
                LT.APL_EX5_158,            
                LT.APL_EX5_159,            
                LT.APL_EX5_160,            
                LT.APL_EX5_161,            
                LT.APL_EX5_162,            
                LT.APL_EX5_163,            
                LT.APL_EX5_164,            
                LT.APL_EX5_165,            
                LT.APL_EX5_166,            
                LT.APL_EX5_167,            
                LT.APL_EX5_168,            
                LT.APL_EX5_169,            
                LT.APL_EX5_170,            
                LT.APL_EX5_171,            
                LT.APL_EX5_172,          
                LT.APL_EX5_173,            
                LT.APL_EX5_174,            
                LT.APL_EX5_175,            
                LT.APL_EX5_176,            
                LT.APL_EX5_177,            
                LT.APL_EX5_178,            
                LT.APL_EX5_179,            
                LT.APL_EX5_180,            
                LT.APL_EX5_181,            
                LT.APL_EX5_182,            
                LT.APL_EX5_183,            
                LT.APL_EX5_184,            
                LT.APL_EX5_185,            
                LT.APL_EX5_186,            
                LT.APL_EX5_187,            
                LT.APL_EX5_188,            
                LT.APL_EX5_189,            
                LT.APL_EX5_190,            
                LT.APL_EX5_191,            
                LT.APL_EX5_192,            
                LT.APL_EX5_193,            
                LT.APL_EX5_194,            
                LT.APL_EX5_195,            
                LT.APL_EX5_196,            
                LT.APL_EX5_197,            
                LT.APL_EX5_198,            
                LT.APL_EX5_199,            
                LT.APL_EX5_200            
    FROM #APLEX5TMP LT         
 INNER JOIN #APLIDTEMP DT ON LT.APL_EX5_ID = DT.APPLICATIONID           
    WHERE LT.OWNERID = 985;            
        
     /* INSERTING VERIFICATION ID'S OF THE APPLICATIONS INTO TEMP TABLE */                 
     SELECT LT.CUSTOMOBJECTID,         
            LT.RELATEDTOID,        
            0 AS NEWCUSTOMOBJECTID        
     INTO #VERIDTEMP            
     FROM VERIFICATION LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND LT.RELATEDTOID = AT.APPLICATIONID          
  WHERE LT.OWNERID = 985          
       AND LT.LAYOUTID IN (10204009,10204016,10204017,10204018);          
      
  SET @SUCCESSCOUNT = @@ROWCOUNT     
    
  IF(@SUCCESSCOUNT>0)    
  BEGIN    
    /* INSERTING RELEVANT VERIFICATION RECORDS AND THEIR DATA INTO TEMP TABLE */            
    SELECT *             
    INTO #VERDATATEMP             
    FROM VERIFICATION LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND LT.RELATEDTOID = AT.APPLICATIONID           
    WHERE LT.OWNERID = 985          
      AND LT.LAYOUTID IN (10204009,10204016,10204017,10204018);          
              
    /* EXTENSION TABLE 1 */            
    SELECT *             
    INTO #VEREX1TMP            
    FROM VER_EX1 LT INNER JOIN #VERIDTEMP AT ON LT.OWNERID = 985 AND  LT.VER_EX1_ID = AT.CUSTOMOBJECTID;          
              
    /* EXTENSION TABLE 2 */            
    SELECT *             
    INTO #VEREX2TMP            
    FROM VER_EX2 LT INNER JOIN #VERIDTEMP AT ON LT.OWNERID = 985 AND  LT.VER_EX2_ID = AT.CUSTOMOBJECTID;          
              
    /* EXTENSION TABLE 3 */            
    SELECT *             
    INTO #VEREX3TMP            
    FROM VER_EX3 LT INNER JOIN #VERIDTEMP AT ON LT.OWNERID = 985 AND  LT.VER_EX3_ID = AT.CUSTOMOBJECTID;          
              
    /* EXTENSION TABLE 4 */            
    SELECT *             
    INTO #VEREX4TMP            
    FROM VER_EX4 LT INNER JOIN #VERIDTEMP AT ON LT.OWNERID = 985 AND  LT.VER_EX4_ID = AT.CUSTOMOBJECTID;          
              
    /* EXTENSION TABLE 5 */            
    SELECT *             
    INTO #VEREX5TMP            
    FROM VER_EX5 LT INNER JOIN #VERIDTEMP AT ON LT.OWNERID = 985 AND  LT.VER_EX5_ID = AT.CUSTOMOBJECTID;          
          
    /* GENERATING NEW VERIFICATION ID'S FOR TO BE CLONED RECORDS */            
       EXEC GETNEXTIDBLOCK 985,100005,@SUCCESSCOUNT,@NEXTID OUT;           
              
    /* UPDATING NEW VERIFICATION ID'S AND TAGGING THEIR NEW APPLICATION ID'S TO THEM IN THE TEMP TABLE */        
    UPDATE LT            
           SET LT.CUSTOMOBJECTID = @NEXTID + P.ROWINDEX,            
               LT.RELATEDTOID = P.NEWAPPLICATIONID            
       FROM #VERDATATEMP LT         
       INNER JOIN(            
       SELECT N.NEWAPPLICATIONID,         
     P.CUSTOMOBJECTID,        
     ROW_NUMBER () OVER (ORDER BY P.CUSTOMOBJECTID ASC) AS ROWINDEX        
    FROM #VERIDTEMP P        
    INNER JOIN #APLIDTEMP N ON N.APPLICATIONID = P.RELATEDTOID        
    ) AS P ON P.CUSTOMOBJECTID = LT.CUSTOMOBJECTID        
       SET @SUCCESSCOUNT = @@ROWCOUNT;            
          
   UPDATE LT        
       SET LT.NEWCUSTOMOBJECTID = @NEXTID + P.ROWINDEX        
   FROM #VERIDTEMP LT        
   INNER JOIN (        
    SELECT P.CUSTOMOBJECTID,        
        ROW_NUMBER () OVER (ORDER BY P.CUSTOMOBJECTID ASC) AS ROWINDEX        
   FROM #VERIDTEMP P        
   ) AS P ON P.CUSTOMOBJECTID = LT.CUSTOMOBJECTID        
       
   /* UPDATING IDLIST FOR VERIFICATION OBJECT */                    
   UPDATE IL        
      SET IL.LASTID = (SELECT MAX(CUSTOMOBJECTID) FROM #VERDATATEMP WHERE OWNERID = 985)        
   FROM IDLIST IL        
   WHERE IL.OWNERID = 985        
     AND IL.ITEMID = 100005;        
         
   /* INSERTING DATA INTO VERIFICATION TABLES */        
   INSERT INTO VERIFICATION(LT.OWNERID,        
         LT.CUSTOMOBJECTID,        
         LT.SUBJECT,        
         LT.ASSIGNEDTOID,        
         LT.ASSIGNEDTONAME,        
         LT.CURRENTOWNERID,        
         LT.CURRENTOWNERNAME,        
         LT.DESCRIPTION,        
         LT.STATUSCODENAME,        
         LT.STATUSCODEID,        
         LT.RELATEDTONAME,        
         LT.RELATEDTOID,        
         LT.RELATEDTOTYPEID,        
         LT.RELATEDTOTYPENAME,        
         LT.CREATEDBYNAME,        
         LT.CREATEDBY,        
         LT.CREATEDON,        
         LT.LASTMODIFIEDBYNAME,        
         LT.LASTMODIFIEDBY,        
         LT.LASTMODIFIEDON,        
         LT.TERRITORYID,        
         LT.TERRITORYNAME,        
         LT.STATUSID,        
         LT.STATUS,        
         LT.STATUSCODECHANGEDON,        
         LT.PREVIOUSSTATUSCODEID,        
         LT.DATEOFBIRTH,        
         LT.CONTACTID,        
         LT.CONTACTNAME,        
         LT.EMAILID,        
         LT.PAN,        
         LT.VOTERID,        
         LT.MOBILE,        
         LT.AADHARNUMBER,        
         LT.RESIDENCEPHONE,        
         LT.EDUCATIONSTATUS,        
         LT.EDUCATIONSTATUSID,        
         LT.MARITALSTATUS,        
         LT.MARITALSTATUSID,        
         LT.NOOFFAMILYMEMBER,        
         LT.NOOFDEPENDENTMEMBER,        
         LT.NOOFEARNINGMEMBER,        
         LT.VEHICLEOWNED,        
         LT.VEHICLEOWNEDID,        
         LT.VEHICLECOUNT,        
         LT.EMPLOYMENTTYPE,        
         LT.EMPLOYMENTTYPEID,        
         LT.EMPLOYMENTTYPEPRIMARY,        
         LT.EMPLOYMENTTYPEPRIMARYID,        
         LT.TYPEOFLOCALITY,        
         LT.TYPEOFLOCALITYID,        
         LT.STRUCTURE,        
         LT.STRUCTUREID,        
         LT.STANDARDOFLIVING,        
         LT.STANDARDOFLIVINGID,        
         LT.TYPEOFHOUSE,        
         LT.TYPEOFHOUSEID,        
         LT.OWNERSHIPTYPE,        
         LT.OWNERSHIPTYPEID,        
         LT.ACCOMODATIONTYPE,        
         LT.ACCOMODATIONTYPEID,        
         LT.RESIDINGSINCE,        
         LT.WORKINGSINCE,        
         LT.VERIFYRELATIVE,        
         LT.VERIFYRELATIVEID,        
         LT.RELATIONSHIPWITHAPPLICANT,        
         LT.RELATIONSHIPWITHAPPLICANTID,        
         LT.VERIFYINGRELATIVENAME,        
         LT.VERIFYNEIGHBOUR,        
         LT.VERIFYNEIGHBOURID,        
         LT.VERIFYINGNEIGHBOURNAME,        
         LT.VERIFYINGNEIGHBOURFEEDBACK,        
         LT.VERIFYEMPLOYMENT,        
         LT.VERIFYEMPLOYMENTID,        
         LT.VERIFYINGEMPLOYMENTNAME,        
         LT.VERIFYINGEMPLOYMENTFEEDBACK,        
         LT.VERIFYINGEMPLOYMENTRELATION,        
         LT.VERIFYINGEMPLOYMENTRELATIONID,        
         LT.DESIGNATION,        
         LT.DESIGNATIONID,        
         LT.NETMONTHLYINCOME,        
         LT.CONFIRMDESIGNATION,        
         LT.CONFIRMDESIGNATIONID,        
         LT.CONFIRMINCOME,        
         LT.CONFIRMINCOMEID,        
         LT.OFFICETYPE,        
         LT.OFFICETYPEID,        
         LT.OFFICELOCATIONTYPE,        
   LT.OFFICELOCATIONTYPEID,        
         LT.NATUREOFBUSINESS,        
         LT.NATUREOFBUSINESSID,        
         LT.INDUSTRYTYPE,        
         LT.INDUSTRYTYPEID,        
         LT.LABOURCARDID,        
         LT.LABOURCARDEXPIRYDATE,        
         LT.TRADELICENSENUMBER,        
         LT.TRADELICENSEEXPIRYDATE,        
         LT.NUMBEROFPARTNERS,        
         LT.NAMEOFPOAHOLDER,        
         LT.NATUREOFSUBSIDIARY,        
         LT.NATUREOFSUBSIDIARYID,        
         LT.CKYCNUMBER,        
         LT.TAN,        
         LT.VERIFYINGAGENCY,        
         LT.VERIFIERNAME,        
         LT.OVERALLSTATUS,        
         LT.OVERALLSTATUSID,        
         LT.VERIFICATIONTYPE,        
         LT.VERIFICATIONTYPEID,        
         LT.MODE,        
         LT.MODEID,        
         LT.INITIATEDDATE,        
         LT.COMPLETEDDATE,        
         LT.VALIDTILLDATE,        
         LT.WAIVER,        
         LT.WAIVERID,        
         LT.RESIDENCEADDRESS1,        
         LT.RESIDENCEADDRESS2,        
         LT.RESIDENCECOUNTRY,        
         LT.RESIDENCESTATE,        
         LT.RESIDENCEDISTRICT,        
         LT.RESIDENCESUBDISTRICT,        
         LT.RESIDENCECITY,        
         LT.RESIDENCEZIPCODE,        
         LT.RESIDENCELOCALITY,        
         LT.OFFICEADDRESS1,        
         LT.OFFICEADDRESS2,        
         LT.OFFICECOUNTRY,        
         LT.OFFICESTATE,        
         LT.OFFICEDISTRICT,        
         LT.OFFICESUBDISTRICT,        
         LT.OFFICECITY,        
         LT.OFFICEZIPCODE,        
         LT.OFFICELOCALITY,        
         LT.RESIDENCECITYID,        
         LT.RESIDENCECOUNTRYID,        
         LT.RESIDENCESTATEID,        
         LT.RESIDENCEDISTRICTID,        
         LT.RESIDENCEZIPCODEID,        
         LT.RESIDENCESUBDISTRICTID,        
         LT.OFFICECITYID,        
         LT.OFFICECOUNTRYID,        
         LT.OFFICESTATEID,        
         LT.OFFICEDISTRICTID,        
         LT.OFFICEZIPCODEID,        
         LT.OFFICESUBDISTRICTID,        
         LT.LAYOUTID,        
         LT.PROCESSID,        
         LT.CREATEDBYTYPE,        
         LT.LASTMODIFIEDBYTYPE,        
         LT.IMPORTCYCLEID,        
         LT.UNIQUEID,        
         LT.ISESCALATED,        
         LT.ESCALATEDON,        
         LT.LASTACTIONID,        
         LT.ESCALATEDCOUNT,        
         LT.OPENESCALATEDCOUNT)        
        SELECT LT.OWNERID,         
      LT.CUSTOMOBJECTID,        
      LT.SUBJECT,        
      LT.ASSIGNEDTOID,        
      LT.ASSIGNEDTONAME,        
      LT.CURRENTOWNERID,        
      LT.CURRENTOWNERNAME,        
      LT.DESCRIPTION,        
      LT.STATUSCODENAME,        
      LT.STATUSCODEID,        
      LT.RELATEDTONAME,        
      LT.RELATEDTOID,        
      LT.RELATEDTOTYPEID,        
      LT.RELATEDTOTYPENAME,        
      LT.CREATEDBYNAME,        
      LT.CREATEDBY,        
      LT.CREATEDON,        
      LT.LASTMODIFIEDBYNAME,        
      LT.LASTMODIFIEDBY,        
      LT.LASTMODIFIEDON,        
      LT.TERRITORYID,        
      LT.TERRITORYNAME,        
      LT.STATUSID,        
      LT.STATUS,        
      LT.STATUSCODECHANGEDON,        
      LT.PREVIOUSSTATUSCODEID,        
      LT.DATEOFBIRTH,        
      LT.CONTACTID,        
      LT.CONTACTNAME,        
      LT.EMAILID,        
      LT.PAN,        
      LT.VOTERID,        
      LT.MOBILE,        
      LT.AADHARNUMBER,        
      LT.RESIDENCEPHONE,        
      LT.EDUCATIONSTATUS,        
      LT.EDUCATIONSTATUSID,        
      LT.MARITALSTATUS,        
      LT.MARITALSTATUSID,        
      LT.NOOFFAMILYMEMBER,        
      LT.NOOFDEPENDENTMEMBER,        
      LT.NOOFEARNINGMEMBER,        
      LT.VEHICLEOWNED,        
      LT.VEHICLEOWNEDID,        
      LT.VEHICLECOUNT,        
      LT.EMPLOYMENTTYPE,        
      LT.EMPLOYMENTTYPEID,     
      LT.EMPLOYMENTTYPEPRIMARY,        
      LT.EMPLOYMENTTYPEPRIMARYID,        
      LT.TYPEOFLOCALITY,        
      LT.TYPEOFLOCALITYID,        
      LT.STRUCTURE,        
      LT.STRUCTUREID,        
      LT.STANDARDOFLIVING,        
      LT.STANDARDOFLIVINGID,        
      LT.TYPEOFHOUSE,        
      LT.TYPEOFHOUSEID,        
      LT.OWNERSHIPTYPE,        
      LT.OWNERSHIPTYPEID,        
      LT.ACCOMODATIONTYPE,        
      LT.ACCOMODATIONTYPEID,        
      LT.RESIDINGSINCE,        
      LT.WORKINGSINCE,        
      LT.VERIFYRELATIVE,        
      LT.VERIFYRELATIVEID,        
      LT.RELATIONSHIPWITHAPPLICANT,        
      LT.RELATIONSHIPWITHAPPLICANTID,        
      LT.VERIFYINGRELATIVENAME,        
      LT.VERIFYNEIGHBOUR,        
      LT.VERIFYNEIGHBOURID,        
      LT.VERIFYINGNEIGHBOURNAME,        
      LT.VERIFYINGNEIGHBOURFEEDBACK,        
      LT.VERIFYEMPLOYMENT,        
      LT.VERIFYEMPLOYMENTID,        
      LT.VERIFYINGEMPLOYMENTNAME,        
      LT.VERIFYINGEMPLOYMENTFEEDBACK,        
      LT.VERIFYINGEMPLOYMENTRELATION,        
      LT.VERIFYINGEMPLOYMENTRELATIONID,        
      LT.DESIGNATION,        
      LT.DESIGNATIONID,        
      LT.NETMONTHLYINCOME,        
      LT.CONFIRMDESIGNATION,        
      LT.CONFIRMDESIGNATIONID,        
      LT.CONFIRMINCOME,        
      LT.CONFIRMINCOMEID,        
      LT.OFFICETYPE,        
      LT.OFFICETYPEID,        
      LT.OFFICELOCATIONTYPE,        
      LT.OFFICELOCATIONTYPEID,        
      LT.NATUREOFBUSINESS,        
      LT.NATUREOFBUSINESSID,        
      LT.INDUSTRYTYPE,        
      LT.INDUSTRYTYPEID,        
      LT.LABOURCARDID,        
      LT.LABOURCARDEXPIRYDATE,        
      LT.TRADELICENSENUMBER,        
      LT.TRADELICENSEEXPIRYDATE,        
      LT.NUMBEROFPARTNERS,        
      LT.NAMEOFPOAHOLDER,        
      LT.NATUREOFSUBSIDIARY,        
      LT.NATUREOFSUBSIDIARYID,        
      LT.CKYCNUMBER,        
      LT.TAN,        
      LT.VERIFYINGAGENCY,        
      LT.VERIFIERNAME,        
      LT.OVERALLSTATUS,        
      LT.OVERALLSTATUSID,        
      LT.VERIFICATIONTYPE,        
      LT.VERIFICATIONTYPEID,        
      LT.MODE,        
      LT.MODEID,        
      LT.INITIATEDDATE,        
      LT.COMPLETEDDATE,        
      LT.VALIDTILLDATE,        
      LT.WAIVER,        
      LT.WAIVERID,        
      LT.RESIDENCEADDRESS1,        
      LT.RESIDENCEADDRESS2,        
      LT.RESIDENCECOUNTRY,        
      LT.RESIDENCESTATE,        
      LT.RESIDENCEDISTRICT,        
      LT.RESIDENCESUBDISTRICT,        
      LT.RESIDENCECITY,        
      LT.RESIDENCEZIPCODE,        
      LT.RESIDENCELOCALITY,        
      LT.OFFICEADDRESS1,        
      LT.OFFICEADDRESS2,        
      LT.OFFICECOUNTRY,        
      LT.OFFICESTATE,        
      LT.OFFICEDISTRICT,        
      LT.OFFICESUBDISTRICT,        
      LT.OFFICECITY,        
      LT.OFFICEZIPCODE,        
      LT.OFFICELOCALITY,        
      LT.RESIDENCECITYID,        
      LT.RESIDENCECOUNTRYID,        
      LT.RESIDENCESTATEID,        
      LT.RESIDENCEDISTRICTID,        
      LT.RESIDENCEZIPCODEID,        
      LT.RESIDENCESUBDISTRICTID,        
      LT.OFFICECITYID,        
      LT.OFFICECOUNTRYID,        
      LT.OFFICESTATEID,        
      LT.OFFICEDISTRICTID,        
      LT.OFFICEZIPCODEID,        
      LT.OFFICESUBDISTRICTID,        
      LT.LAYOUTID,        
      LT.PROCESSID,        
      LT.CREATEDBYTYPE,        
      LT.LASTMODIFIEDBYTYPE,        
      LT.IMPORTCYCLEID,        
      LT.UNIQUEID,        
      LT.ISESCALATED,        
      LT.ESCALATEDON,        
      LT.LASTACTIONID,        
      LT.ESCALATEDCOUNT,        
      LT.OPENESCALATEDCOUNT        
         FROM #VERDATATEMP LT        
         WHERE LT.OWNERID = 985;        
         
     INSERT INTO VER_EX1(LT.OWNERID,        
       LT.VER_EX1_ID,        
       LT.VER_EX1_1,        
       LT.VER_EX1_2,        
       LT.VER_EX1_3,        
       LT.VER_EX1_4,        
       LT.VER_EX1_5,        
       LT.VER_EX1_6,     
       LT.VER_EX1_7,        
       LT.VER_EX1_8,        
       LT.VER_EX1_9,        
       LT.VER_EX1_10,        
       LT.VER_EX1_11,        
       LT.VER_EX1_12,        
       LT.VER_EX1_13,        
       LT.VER_EX1_14,        
       LT.VER_EX1_15,        
       LT.VER_EX1_16,        
       LT.VER_EX1_17,        
       LT.VER_EX1_18,        
       LT.VER_EX1_19,        
       LT.VER_EX1_20,        
       LT.VER_EX1_21,        
       LT.VER_EX1_22,        
       LT.VER_EX1_23,        
       LT.VER_EX1_24,        
       LT.VER_EX1_25,        
       LT.VER_EX1_26,        
       LT.VER_EX1_27,        
       LT.VER_EX1_28,        
       LT.VER_EX1_29,        
       LT.VER_EX1_30,        
       LT.VER_EX1_31,        
       LT.VER_EX1_32,        
       LT.VER_EX1_33,        
       LT.VER_EX1_34,        
       LT.VER_EX1_35,        
       LT.VER_EX1_36,        
       LT.VER_EX1_37,        
       LT.VER_EX1_38,        
       LT.VER_EX1_39,        
       LT.VER_EX1_40,        
       LT.VER_EX1_41,        
       LT.VER_EX1_42,        
       LT.VER_EX1_43,        
       LT.VER_EX1_44,        
       LT.VER_EX1_45,        
       LT.VER_EX1_46,        
       LT.VER_EX1_47,        
       LT.VER_EX1_48,        
       LT.VER_EX1_49,        
       LT.VER_EX1_50,        
       LT.VER_EX1_51,        
       LT.VER_EX1_52,        
       LT.VER_EX1_53,        
       LT.VER_EX1_54,        
       LT.VER_EX1_55,        
       LT.VER_EX1_56,        
       LT.VER_EX1_57,        
       LT.VER_EX1_58,        
       LT.VER_EX1_59,        
       LT.VER_EX1_60,        
       LT.VER_EX1_61,        
       LT.VER_EX1_62,        
       LT.VER_EX1_63,        
       LT.VER_EX1_64,        
       LT.VER_EX1_65,        
       LT.VER_EX1_66,        
       LT.VER_EX1_67,        
       LT.VER_EX1_68,        
       LT.VER_EX1_69,        
       LT.VER_EX1_70,        
       LT.VER_EX1_71,        
       LT.VER_EX1_72,        
       LT.VER_EX1_73,        
       LT.VER_EX1_74,        
       LT.VER_EX1_75,        
       LT.VER_EX1_76,        
       LT.VER_EX1_77,        
       LT.VER_EX1_78,        
       LT.VER_EX1_79,        
       LT.VER_EX1_80,        
       LT.VER_EX1_81,        
       LT.VER_EX1_82,        
       LT.VER_EX1_83,        
       LT.VER_EX1_84,        
       LT.VER_EX1_85,        
       LT.VER_EX1_86,        
       LT.VER_EX1_87,        
       LT.VER_EX1_88,        
       LT.VER_EX1_89,        
       LT.VER_EX1_90,        
       LT.VER_EX1_91,        
       LT.VER_EX1_92,        
       LT.VER_EX1_93,        
       LT.VER_EX1_94,        
       LT.VER_EX1_95,        
       LT.VER_EX1_96,        
       LT.VER_EX1_97,        
       LT.VER_EX1_98,        
       LT.VER_EX1_99,        
       LT.VER_EX1_100)        
     SELECT  LT.OWNERID,        
       VD.NEWCUSTOMOBJECTID,        
       LT.VER_EX1_1,        
       LT.VER_EX1_2,        
       LT.VER_EX1_3,        
       LT.VER_EX1_4,        
       LT.VER_EX1_5,        
       LT.VER_EX1_6,        
       LT.VER_EX1_7,        
       LT.VER_EX1_8,        
       LT.VER_EX1_9,        
       LT.VER_EX1_10,        
       LT.VER_EX1_11,        
       LT.VER_EX1_12,        
       LT.VER_EX1_13,        
       LT.VER_EX1_14,        
       LT.VER_EX1_15,        
       LT.VER_EX1_16,        
       LT.VER_EX1_17,        
       LT.VER_EX1_18,        
       LT.VER_EX1_19,        
       LT.VER_EX1_20,        
       LT.VER_EX1_21,        
       LT.VER_EX1_22,        
       LT.VER_EX1_23,        
       LT.VER_EX1_24,        
       LT.VER_EX1_25,        
       LT.VER_EX1_26,        
       LT.VER_EX1_27,        
       LT.VER_EX1_28,        
       LT.VER_EX1_29,        
       LT.VER_EX1_30,        
       LT.VER_EX1_31,        
       LT.VER_EX1_32,        
       LT.VER_EX1_33,        
       LT.VER_EX1_34,        
       LT.VER_EX1_35,        
       LT.VER_EX1_36,        
       LT.VER_EX1_37,        
       LT.VER_EX1_38,        
       LT.VER_EX1_39,        
       LT.VER_EX1_40,        
       LT.VER_EX1_41,        
       LT.VER_EX1_42,      
       LT.VER_EX1_43,        
       LT.VER_EX1_44,        
       LT.VER_EX1_45,        
       LT.VER_EX1_46,        
       LT.VER_EX1_47,        
       LT.VER_EX1_48,        
       LT.VER_EX1_49,        
       LT.VER_EX1_50,        
       LT.VER_EX1_51,        
       LT.VER_EX1_52,        
       LT.VER_EX1_53,        
       LT.VER_EX1_54,        
       LT.VER_EX1_55,        
       LT.VER_EX1_56,        
       LT.VER_EX1_57,        
       LT.VER_EX1_58,        
       LT.VER_EX1_59,        
       LT.VER_EX1_60,        
       LT.VER_EX1_61,        
       LT.VER_EX1_62,        
       LT.VER_EX1_63,        
       LT.VER_EX1_64,        
       LT.VER_EX1_65,        
       LT.VER_EX1_66,        
       LT.VER_EX1_67,        
       LT.VER_EX1_68,        
       LT.VER_EX1_69,        
       LT.VER_EX1_70,        
       LT.VER_EX1_71,        
       LT.VER_EX1_72,        
       LT.VER_EX1_73,        
       LT.VER_EX1_74,        
       LT.VER_EX1_75,        
       LT.VER_EX1_76,        
       LT.VER_EX1_77,        
       LT.VER_EX1_78,        
       LT.VER_EX1_79,        
       LT.VER_EX1_80,        
       LT.VER_EX1_81,        
       LT.VER_EX1_82,        
       LT.VER_EX1_83,        
       LT.VER_EX1_84,        
       LT.VER_EX1_85,        
       LT.VER_EX1_86,        
       LT.VER_EX1_87,        
       LT.VER_EX1_88,        
       LT.VER_EX1_89,        
       LT.VER_EX1_90,        
       LT.VER_EX1_91,        
       LT.VER_EX1_92,        
       LT.VER_EX1_93,        
       LT.VER_EX1_94,        
       LT.VER_EX1_95,        
       LT.VER_EX1_96,        
       LT.VER_EX1_97,        
       LT.VER_EX1_98,        
       LT.VER_EX1_99,        
       LT.VER_EX1_100        
       FROM  #VEREX1TMP LT         
       INNER JOIN #VERIDTEMP VD ON LT.CUSTOMOBJECTID = VD.CUSTOMOBJECTID        
       WHERE LT.OWNERID = 985        
         
                INSERT INTO VER_EX2(LT.OWNERID,        
       LT.VER_EX2_ID,        
       LT.VER_EX2_1,        
       LT.VER_EX2_2,        
       LT.VER_EX2_3,        
       LT.VER_EX2_4,        
       LT.VER_EX2_5,        
       LT.VER_EX2_6,        
       LT.VER_EX2_7,        
       LT.VER_EX2_8,        
       LT.VER_EX2_9,        
       LT.VER_EX2_10,        
       LT.VER_EX2_11,        
       LT.VER_EX2_12,        
       LT.VER_EX2_13,        
       LT.VER_EX2_14,        
       LT.VER_EX2_15,        
       LT.VER_EX2_16,        
       LT.VER_EX2_17,        
    LT.VER_EX2_18,        
       LT.VER_EX2_19,        
       LT.VER_EX2_20,        
       LT.VER_EX2_21,        
       LT.VER_EX2_22,        
       LT.VER_EX2_23,        
       LT.VER_EX2_24,        
       LT.VER_EX2_25,        
       LT.VER_EX2_26,        
       LT.VER_EX2_27,        
       LT.VER_EX2_28,        
       LT.VER_EX2_29,        
       LT.VER_EX2_30,        
       LT.VER_EX2_31,        
       LT.VER_EX2_32,        
       LT.VER_EX2_33,        
       LT.VER_EX2_34,        
       LT.VER_EX2_35,        
       LT.VER_EX2_36,        
       LT.VER_EX2_37,        
       LT.VER_EX2_38,        
       LT.VER_EX2_39,        
       LT.VER_EX2_40,        
       LT.VER_EX2_41,        
       LT.VER_EX2_42,        
       LT.VER_EX2_43,        
       LT.VER_EX2_44,        
       LT.VER_EX2_45,        
       LT.VER_EX2_46,        
       LT.VER_EX2_47,        
       LT.VER_EX2_48,        
       LT.VER_EX2_49,        
       LT.VER_EX2_50,        
       LT.VER_EX2_51,        
       LT.VER_EX2_52,        
       LT.VER_EX2_53,        
       LT.VER_EX2_54,        
       LT.VER_EX2_55,        
       LT.VER_EX2_56,        
       LT.VER_EX2_57,        
       LT.VER_EX2_58,        
       LT.VER_EX2_59,        
       LT.VER_EX2_60,        
       LT.VER_EX2_61,        
       LT.VER_EX2_62,        
       LT.VER_EX2_63,        
       LT.VER_EX2_64,        
       LT.VER_EX2_65,        
       LT.VER_EX2_66,        
       LT.VER_EX2_67,        
       LT.VER_EX2_68,        
       LT.VER_EX2_69,        
       LT.VER_EX2_70,        
       LT.VER_EX2_71,        
       LT.VER_EX2_72,        
       LT.VER_EX2_73,        
       LT.VER_EX2_74,        
       LT.VER_EX2_75,        
       LT.VER_EX2_76,        
       LT.VER_EX2_77,        
       LT.VER_EX2_78,        
       LT.VER_EX2_79,        
       LT.VER_EX2_80,        
       LT.VER_EX2_81,        
       LT.VER_EX2_82,        
       LT.VER_EX2_83,        
       LT.VER_EX2_84,        
       LT.VER_EX2_85,        
       LT.VER_EX2_86,        
       LT.VER_EX2_87,        
       LT.VER_EX2_88,        
       LT.VER_EX2_89,        
       LT.VER_EX2_90,        
       LT.VER_EX2_91,        
       LT.VER_EX2_92,        
       LT.VER_EX2_93,        
       LT.VER_EX2_94,        
       LT.VER_EX2_95,        
       LT.VER_EX2_96,        
       LT.VER_EX2_97,        
       LT.VER_EX2_98,        
       LT.VER_EX2_99,        
       LT.VER_EX2_100)        
     SELECT  LT.OWNERID,        
       VD.NEWCUSTOMOBJECTID,        
       LT.VER_EX2_1,        
       LT.VER_EX2_2,        
       LT.VER_EX2_3,        
       LT.VER_EX2_4,        
       LT.VER_EX2_5,        
       LT.VER_EX2_6,        
       LT.VER_EX2_7,        
       LT.VER_EX2_8,        
       LT.VER_EX2_9,        
       LT.VER_EX2_10,        
       LT.VER_EX2_11,        
       LT.VER_EX2_12,        
       LT.VER_EX2_13,        
       LT.VER_EX2_14,        
       LT.VER_EX2_15,        
       LT.VER_EX2_16,        
       LT.VER_EX2_17,        
       LT.VER_EX2_18,        
       LT.VER_EX2_19,        
       LT.VER_EX2_20,        
       LT.VER_EX2_21,        
       LT.VER_EX2_22,        
       LT.VER_EX2_23,        
       LT.VER_EX2_24,        
       LT.VER_EX2_25,        
       LT.VER_EX2_26,        
       LT.VER_EX2_27,        
       LT.VER_EX2_28,        
       LT.VER_EX2_29,        
       LT.VER_EX2_30,        
       LT.VER_EX2_31,        
       LT.VER_EX2_32,        
       LT.VER_EX2_33,        
       LT.VER_EX2_34,        
       LT.VER_EX2_35,        
       LT.VER_EX2_36,        
       LT.VER_EX2_37,        
       LT.VER_EX2_38,        
       LT.VER_EX2_39,        
       LT.VER_EX2_40,        
       LT.VER_EX2_41,        
       LT.VER_EX2_42,        
       LT.VER_EX2_43,        
       LT.VER_EX2_44,        
       LT.VER_EX2_45,        
       LT.VER_EX2_46,        
       LT.VER_EX2_47,        
       LT.VER_EX2_48,        
       LT.VER_EX2_49,        
       LT.VER_EX2_50,        
       LT.VER_EX2_51,        
       LT.VER_EX2_52,        
       LT.VER_EX2_53,        
       LT.VER_EX2_54,        
       LT.VER_EX2_55,        
       LT.VER_EX2_56,        
       LT.VER_EX2_57,        
       LT.VER_EX2_58,        
       LT.VER_EX2_59,        
       LT.VER_EX2_60,        
       LT.VER_EX2_61,        
       LT.VER_EX2_62,        
       LT.VER_EX2_63,        
       LT.VER_EX2_64,        
       LT.VER_EX2_65,        
       LT.VER_EX2_66,        
       LT.VER_EX2_67,        
       LT.VER_EX2_68,        
       LT.VER_EX2_69,        
       LT.VER_EX2_70,        
       LT.VER_EX2_71,        
       LT.VER_EX2_72,        
       LT.VER_EX2_73,        
       LT.VER_EX2_74,        
       LT.VER_EX2_75,        
       LT.VER_EX2_76,        
       LT.VER_EX2_77,        
       LT.VER_EX2_78,        
       LT.VER_EX2_79,        
       LT.VER_EX2_80,        
       LT.VER_EX2_81,        
       LT.VER_EX2_82,        
       LT.VER_EX2_83,        
       LT.VER_EX2_84,        
       LT.VER_EX2_85,        
       LT.VER_EX2_86,        
       LT.VER_EX2_87,        
       LT.VER_EX2_88,        
       LT.VER_EX2_89,        
       LT.VER_EX2_90,        
       LT.VER_EX2_91,        
       LT.VER_EX2_92,        
       LT.VER_EX2_93,        
       LT.VER_EX2_94,        
       LT.VER_EX2_95,        
       LT.VER_EX2_96,        
       LT.VER_EX2_97,        
       LT.VER_EX2_98,        
       LT.VER_EX2_99,        
       LT.VER_EX2_100        
       FROM  #VEREX2TMP LT         
       INNER JOIN #VERIDTEMP VD ON LT.CUSTOMOBJECTID = VD.CUSTOMOBJECTID        
       WHERE LT.OWNERID = 985        
         
     INSERT INTO VER_EX3(LT.OWNERID,        
       LT.VER_EX3_ID,        
       LT.VER_EX3_1,        
       LT.VER_EX3_2,        
       LT.VER_EX3_3,        
       LT.VER_EX3_4,        
       LT.VER_EX3_5,        
       LT.VER_EX3_6,        
       LT.VER_EX3_7,        
       LT.VER_EX3_8,        
       LT.VER_EX3_9,        
       LT.VER_EX3_10,        
       LT.VER_EX3_11,        
       LT.VER_EX3_12,        
       LT.VER_EX3_13,        
       LT.VER_EX3_14,        
       LT.VER_EX3_15,        
       LT.VER_EX3_16,        
       LT.VER_EX3_17,        
       LT.VER_EX3_18,        
       LT.VER_EX3_19,        
       LT.VER_EX3_20,        
       LT.VER_EX3_21,        
       LT.VER_EX3_22,        
       LT.VER_EX3_23,        
       LT.VER_EX3_24,        
       LT.VER_EX3_25,        
       LT.VER_EX3_26,        
       LT.VER_EX3_27,        
       LT.VER_EX3_28,        
       LT.VER_EX3_29,        
       LT.VER_EX3_30,        
       LT.VER_EX3_31,        
       LT.VER_EX3_32,        
       LT.VER_EX3_33,        
       LT.VER_EX3_34,        
       LT.VER_EX3_35,        
       LT.VER_EX3_36,        
       LT.VER_EX3_37,        
       LT.VER_EX3_38,        
       LT.VER_EX3_39,        
       LT.VER_EX3_40,        
       LT.VER_EX3_41,        
       LT.VER_EX3_42,        
       LT.VER_EX3_43,        
       LT.VER_EX3_44,        
       LT.VER_EX3_45,        
       LT.VER_EX3_46,        
       LT.VER_EX3_47,        
       LT.VER_EX3_48,        
       LT.VER_EX3_49,        
       LT.VER_EX3_50,        
       LT.VER_EX3_51,        
       LT.VER_EX3_52,        
       LT.VER_EX3_53,        
       LT.VER_EX3_54,        
       LT.VER_EX3_55,        
       LT.VER_EX3_56,        
       LT.VER_EX3_57,        
       LT.VER_EX3_58,        
       LT.VER_EX3_59,        
       LT.VER_EX3_60,        
       LT.VER_EX3_61,        
       LT.VER_EX3_62,        
       LT.VER_EX3_63,        
       LT.VER_EX3_64,        
       LT.VER_EX3_65,        
       LT.VER_EX3_66,        
       LT.VER_EX3_67,        
       LT.VER_EX3_68,        
       LT.VER_EX3_69,        
       LT.VER_EX3_70,        
       LT.VER_EX3_71,        
       LT.VER_EX3_72,        
       LT.VER_EX3_73,        
       LT.VER_EX3_74,        
       LT.VER_EX3_75,        
       LT.VER_EX3_76,        
       LT.VER_EX3_77,        
       LT.VER_EX3_78,        
       LT.VER_EX3_79,        
       LT.VER_EX3_80,        
       LT.VER_EX3_81,        
       LT.VER_EX3_82,        
       LT.VER_EX3_83,        
       LT.VER_EX3_84,        
       LT.VER_EX3_85,        
       LT.VER_EX3_86,        
       LT.VER_EX3_87,        
       LT.VER_EX3_88,        
       LT.VER_EX3_89,        
       LT.VER_EX3_90,        
       LT.VER_EX3_91,        
       LT.VER_EX3_92,        
       LT.VER_EX3_93,        
       LT.VER_EX3_94,        
       LT.VER_EX3_95,        
       LT.VER_EX3_96,        
       LT.VER_EX3_97,        
       LT.VER_EX3_98,        
       LT.VER_EX3_99,        
       LT.VER_EX3_100)        
     SELECT  LT.OWNERID,        
       VD.NEWCUSTOMOBJECTID,        
       LT.VER_EX3_1,        
       LT.VER_EX3_2,        
       LT.VER_EX3_3,        
       LT.VER_EX3_4,        
       LT.VER_EX3_5,        
       LT.VER_EX3_6,        
       LT.VER_EX3_7,        
       LT.VER_EX3_8,        
       LT.VER_EX3_9,        
       LT.VER_EX3_10,        
       LT.VER_EX3_11,        
       LT.VER_EX3_12,        
       LT.VER_EX3_13,        
       LT.VER_EX3_14,        
       LT.VER_EX3_15,        
       LT.VER_EX3_16,        
       LT.VER_EX3_17,        
       LT.VER_EX3_18,        
       LT.VER_EX3_19,        
       LT.VER_EX3_20,        
       LT.VER_EX3_21,        
       LT.VER_EX3_22,        
       LT.VER_EX3_23,        
       LT.VER_EX3_24,        
       LT.VER_EX3_25,        
       LT.VER_EX3_26,        
       LT.VER_EX3_27,        
       LT.VER_EX3_28,        
       LT.VER_EX3_29,        
       LT.VER_EX3_30,        
       LT.VER_EX3_31,        
       LT.VER_EX3_32,        
       LT.VER_EX3_33,        
       LT.VER_EX3_34,        
       LT.VER_EX3_35,        
       LT.VER_EX3_36,        
       LT.VER_EX3_37,        
       LT.VER_EX3_38,        
       LT.VER_EX3_39,        
       LT.VER_EX3_40,        
       LT.VER_EX3_41,        
       LT.VER_EX3_42,        
       LT.VER_EX3_43,        
       LT.VER_EX3_44,        
       LT.VER_EX3_45,        
       LT.VER_EX3_46,        
       LT.VER_EX3_47,        
       LT.VER_EX3_48,        
       LT.VER_EX3_49,        
       LT.VER_EX3_50,        
       LT.VER_EX3_51,        
       LT.VER_EX3_52,        
       LT.VER_EX3_53,        
       LT.VER_EX3_54,        
       LT.VER_EX3_55,        
       LT.VER_EX3_56,        
       LT.VER_EX3_57,        
       LT.VER_EX3_58,        
       LT.VER_EX3_59,        
       LT.VER_EX3_60,        
       LT.VER_EX3_61,        
       LT.VER_EX3_62,        
       LT.VER_EX3_63,        
       LT.VER_EX3_64,        
       LT.VER_EX3_65,        
       LT.VER_EX3_66,        
       LT.VER_EX3_67,        
       LT.VER_EX3_68,        
       LT.VER_EX3_69,        
       LT.VER_EX3_70,        
       LT.VER_EX3_71,        
       LT.VER_EX3_72,        
       LT.VER_EX3_73,        
       LT.VER_EX3_74,        
       LT.VER_EX3_75,        
       LT.VER_EX3_76,        
       LT.VER_EX3_77,        
       LT.VER_EX3_78,        
       LT.VER_EX3_79,        
       LT.VER_EX3_80,        
       LT.VER_EX3_81,        
       LT.VER_EX3_82,        
       LT.VER_EX3_83,        
       LT.VER_EX3_84,        
       LT.VER_EX3_85,        
       LT.VER_EX3_86,        
       LT.VER_EX3_87,        
       LT.VER_EX3_88,        
       LT.VER_EX3_89,        
       LT.VER_EX3_90,        
       LT.VER_EX3_91,        
       LT.VER_EX3_92,        
       LT.VER_EX3_93,        
       LT.VER_EX3_94,        
       LT.VER_EX3_95,        
       LT.VER_EX3_96,        
       LT.VER_EX3_97,        
       LT.VER_EX3_98,        
       LT.VER_EX3_99,        
       LT.VER_EX3_100        
       FROM  #VEREX3TMP LT         
       INNER JOIN #VERIDTEMP VD ON LT.CUSTOMOBJECTID = VD.CUSTOMOBJECTID        
       WHERE LT.OWNERID = 985        
        
    INSERT INTO VER_EX4(LT.OWNERID,        
         LT.VER_EX4_ID,        
         LT.VER_EX4_1,        
         LT.VER_EX4_2,        
         LT.VER_EX4_3,        
         LT.VER_EX4_4,        
         LT.VER_EX4_5,        
         LT.VER_EX4_6,        
         LT.VER_EX4_7,        
         LT.VER_EX4_8,        
         LT.VER_EX4_9,        
         LT.VER_EX4_10,        
         LT.VER_EX4_11,        
         LT.VER_EX4_12,        
         LT.VER_EX4_13,        
         LT.VER_EX4_14,        
         LT.VER_EX4_15,        
         LT.VER_EX4_16,        
         LT.VER_EX4_17,        
         LT.VER_EX4_18,        
         LT.VER_EX4_19,        
         LT.VER_EX4_20,        
         LT.VER_EX4_21,        
         LT.VER_EX4_22,        
         LT.VER_EX4_23,        
         LT.VER_EX4_24,        
         LT.VER_EX4_25,        
         LT.VER_EX4_26,        
         LT.VER_EX4_27,        
         LT.VER_EX4_28,        
         LT.VER_EX4_29,        
         LT.VER_EX4_30,        
         LT.VER_EX4_31,        
         LT.VER_EX4_32,        
         LT.VER_EX4_33,        
         LT.VER_EX4_34,        
         LT.VER_EX4_35,        
         LT.VER_EX4_36,        
         LT.VER_EX4_37,        
         LT.VER_EX4_38,        
         LT.VER_EX4_39,        
         LT.VER_EX4_40,        
         LT.VER_EX4_41,        
         LT.VER_EX4_42,        
         LT.VER_EX4_43,        
         LT.VER_EX4_44,        
         LT.VER_EX4_45,        
         LT.VER_EX4_46,        
         LT.VER_EX4_47,        
         LT.VER_EX4_48,        
         LT.VER_EX4_49,        
         LT.VER_EX4_50,        
         LT.VER_EX4_51,        
         LT.VER_EX4_52,        
         LT.VER_EX4_53,        
         LT.VER_EX4_54,        
         LT.VER_EX4_55,        
         LT.VER_EX4_56,        
         LT.VER_EX4_57,        
         LT.VER_EX4_58,        
         LT.VER_EX4_59,        
         LT.VER_EX4_60,        
         LT.VER_EX4_61,        
         LT.VER_EX4_62,        
         LT.VER_EX4_63,        
         LT.VER_EX4_64,        
         LT.VER_EX4_65,        
         LT.VER_EX4_66,        
         LT.VER_EX4_67,        
         LT.VER_EX4_68,        
         LT.VER_EX4_69,        
         LT.VER_EX4_70,        
         LT.VER_EX4_71,        
         LT.VER_EX4_72,        
         LT.VER_EX4_73,        
         LT.VER_EX4_74,        
         LT.VER_EX4_75,        
         LT.VER_EX4_76,        
         LT.VER_EX4_77,        
         LT.VER_EX4_78,        
         LT.VER_EX4_79,        
         LT.VER_EX4_80,        
         LT.VER_EX4_81,        
         LT.VER_EX4_82,        
         LT.VER_EX4_83,        
         LT.VER_EX4_84,        
         LT.VER_EX4_85,        
         LT.VER_EX4_86,        
         LT.VER_EX4_87,        
         LT.VER_EX4_88,        
         LT.VER_EX4_89,        
         LT.VER_EX4_90,        
         LT.VER_EX4_91,        
         LT.VER_EX4_92,        
         LT.VER_EX4_93,        
         LT.VER_EX4_94,        
         LT.VER_EX4_95,        
         LT.VER_EX4_96,        
         LT.VER_EX4_97,     
       LT.VER_EX4_98,        
         LT.VER_EX4_99,        
         LT.VER_EX4_100)        
       SELECT  LT.OWNERID,        
         VD.NEWCUSTOMOBJECTID,        
         LT.VER_EX4_1,        
         LT.VER_EX4_2,        
         LT.VER_EX4_3,        
         LT.VER_EX4_4,        
         LT.VER_EX4_5,        
         LT.VER_EX4_6,        
         LT.VER_EX4_7,        
         LT.VER_EX4_8,        
         LT.VER_EX4_9,        
         LT.VER_EX4_10,        
         LT.VER_EX4_11,        
         LT.VER_EX4_12,        
         LT.VER_EX4_13,        
         LT.VER_EX4_14,        
         LT.VER_EX4_15,        
         LT.VER_EX4_16,        
         LT.VER_EX4_17,        
         LT.VER_EX4_18,        
         LT.VER_EX4_19,        
         LT.VER_EX4_20,        
         LT.VER_EX4_21,        
         LT.VER_EX4_22,        
         LT.VER_EX4_23,        
         LT.VER_EX4_24,        
         LT.VER_EX4_25,        
         LT.VER_EX4_26,        
         LT.VER_EX4_27,        
         LT.VER_EX4_28,        
         LT.VER_EX4_29,        
         LT.VER_EX4_30,        
         LT.VER_EX4_31,        
         LT.VER_EX4_32,        
         LT.VER_EX4_33,        
         LT.VER_EX4_34,        
         LT.VER_EX4_35,        
         LT.VER_EX4_36,        
         LT.VER_EX4_37,        
         LT.VER_EX4_38,        
         LT.VER_EX4_39,        
         LT.VER_EX4_40,        
         LT.VER_EX4_41,        
         LT.VER_EX4_42,        
         LT.VER_EX4_43,        
         LT.VER_EX4_44,        
         LT.VER_EX4_45,        
         LT.VER_EX4_46,        
         LT.VER_EX4_47,        
         LT.VER_EX4_48,        
         LT.VER_EX4_49,        
         LT.VER_EX4_50,        
         LT.VER_EX4_51,        
         LT.VER_EX4_52,        
         LT.VER_EX4_53,        
         LT.VER_EX4_54,        
         LT.VER_EX4_55,        
         LT.VER_EX4_56,        
         LT.VER_EX4_57,        
         LT.VER_EX4_58,        
         LT.VER_EX4_59,        
         LT.VER_EX4_60,        
         LT.VER_EX4_61,        
         LT.VER_EX4_62,        
         LT.VER_EX4_63,        
         LT.VER_EX4_64,        
         LT.VER_EX4_65,        
         LT.VER_EX4_66,        
         LT.VER_EX4_67,        
         LT.VER_EX4_68,        
         LT.VER_EX4_69,        
         LT.VER_EX4_70,        
         LT.VER_EX4_71,        
         LT.VER_EX4_72,        
         LT.VER_EX4_73,        
         LT.VER_EX4_74,        
         LT.VER_EX4_75,        
         LT.VER_EX4_76,        
         LT.VER_EX4_77,        
         LT.VER_EX4_78,        
         LT.VER_EX4_79,        
         LT.VER_EX4_80,        
         LT.VER_EX4_81,        
         LT.VER_EX4_82,        
         LT.VER_EX4_83,        
         LT.VER_EX4_84,        
         LT.VER_EX4_85,        
         LT.VER_EX4_86,        
         LT.VER_EX4_87,        
         LT.VER_EX4_88,        
         LT.VER_EX4_89,        
         LT.VER_EX4_90,        
         LT.VER_EX4_91,        
         LT.VER_EX4_92,        
         LT.VER_EX4_93,        
         LT.VER_EX4_94,        
         LT.VER_EX4_95,        
         LT.VER_EX4_96,        
         LT.VER_EX4_97,        
         LT.VER_EX4_98,        
         LT.VER_EX4_99,        
         LT.VER_EX4_100        
         FROM  #VEREX4TMP LT         
         INNER JOIN #VERIDTEMP VD ON LT.CUSTOMOBJECTID = VD.CUSTOMOBJECTID        
         WHERE LT.OWNERID = 985              
                  
    INSERT INTO VER_EX5(LT.OWNERID,        
         LT.VER_EX5_ID,        
         LT.VER_EX5_1,        
         LT.VER_EX5_2,        
         LT.VER_EX5_3,        
         LT.VER_EX5_4,        
         LT.VER_EX5_5,        
         LT.VER_EX5_6,        
         LT.VER_EX5_7,        
         LT.VER_EX5_8,        
         LT.VER_EX5_9,        
         LT.VER_EX5_10,        
         LT.VER_EX5_11,        
         LT.VER_EX5_12,        
         LT.VER_EX5_13,        
         LT.VER_EX5_14,        
         LT.VER_EX5_15,        
         LT.VER_EX5_16,        
         LT.VER_EX5_17,        
         LT.VER_EX5_18,        
         LT.VER_EX5_19,        
         LT.VER_EX5_20,        
         LT.VER_EX5_21,        
         LT.VER_EX5_22,        
         LT.VER_EX5_23,        
         LT.VER_EX5_24,        
         LT.VER_EX5_25,        
         LT.VER_EX5_26,        
         LT.VER_EX5_27,        
         LT.VER_EX5_28,        
         LT.VER_EX5_29,        
         LT.VER_EX5_30,        
         LT.VER_EX5_31,        
         LT.VER_EX5_32,        
         LT.VER_EX5_33,        
         LT.VER_EX5_34,        
         LT.VER_EX5_35,        
         LT.VER_EX5_36,        
         LT.VER_EX5_37,        
         LT.VER_EX5_38,        
         LT.VER_EX5_39,        
         LT.VER_EX5_40,        
         LT.VER_EX5_41,        
         LT.VER_EX5_42,        
         LT.VER_EX5_43,        
         LT.VER_EX5_44,        
         LT.VER_EX5_45,        
         LT.VER_EX5_46,        
         LT.VER_EX5_47,        
         LT.VER_EX5_48,        
         LT.VER_EX5_49,        
         LT.VER_EX5_50,        
         LT.VER_EX5_51,        
         LT.VER_EX5_52,        
         LT.VER_EX5_53,        
         LT.VER_EX5_54,        
         LT.VER_EX5_55,        
         LT.VER_EX5_56,        
         LT.VER_EX5_57,        
         LT.VER_EX5_58,        
         LT.VER_EX5_59,        
         LT.VER_EX5_60,        
         LT.VER_EX5_61,        
         LT.VER_EX5_62,        
         LT.VER_EX5_63,        
         LT.VER_EX5_64,        
         LT.VER_EX5_65,        
         LT.VER_EX5_66,        
         LT.VER_EX5_67,        
         LT.VER_EX5_68,        
         LT.VER_EX5_69,        
         LT.VER_EX5_70,        
         LT.VER_EX5_71,        
         LT.VER_EX5_72,        
         LT.VER_EX5_73,        
         LT.VER_EX5_74,        
         LT.VER_EX5_75,        
         LT.VER_EX5_76,        
         LT.VER_EX5_77,        
         LT.VER_EX5_78,        
         LT.VER_EX5_79,        
         LT.VER_EX5_80,        
         LT.VER_EX5_81,        
         LT.VER_EX5_82,        
         LT.VER_EX5_83,        
         LT.VER_EX5_84,        
         LT.VER_EX5_85,        
         LT.VER_EX5_86,        
         LT.VER_EX5_87,        
         LT.VER_EX5_88,        
         LT.VER_EX5_89,        
         LT.VER_EX5_90,        
         LT.VER_EX5_91,        
         LT.VER_EX5_92,        
         LT.VER_EX5_93,        
         LT.VER_EX5_94,        
         LT.VER_EX5_95,        
         LT.VER_EX5_96,        
         LT.VER_EX5_97,        
         LT.VER_EX5_98,        
         LT.VER_EX5_99,        
         LT.VER_EX5_100)        
       SELECT  LT.OWNERID,        
         VD.NEWCUSTOMOBJECTID,        
         LT.VER_EX5_1,        
         LT.VER_EX5_2,        
         LT.VER_EX5_3,        
         LT.VER_EX5_4,        
         LT.VER_EX5_5,        
         LT.VER_EX5_6,        
         LT.VER_EX5_7,        
         LT.VER_EX5_8,        
         LT.VER_EX5_9,        
         LT.VER_EX5_10,        
         LT.VER_EX5_11,        
         LT.VER_EX5_12,        
         LT.VER_EX5_13,        
         LT.VER_EX5_14,        
         LT.VER_EX5_15,        
         LT.VER_EX5_16,        
         LT.VER_EX5_17,        
         LT.VER_EX5_18,        
         LT.VER_EX5_19,        
         LT.VER_EX5_20,        
         LT.VER_EX5_21,        
         LT.VER_EX5_22,        
         LT.VER_EX5_23,        
         LT.VER_EX5_24,        
         LT.VER_EX5_25,        
         LT.VER_EX5_26,        
         LT.VER_EX5_27,        
         LT.VER_EX5_28,        
         LT.VER_EX5_29,        
         LT.VER_EX5_30,        
         LT.VER_EX5_31,        
         LT.VER_EX5_32,        
         LT.VER_EX5_33,        
         LT.VER_EX5_34,        
         LT.VER_EX5_35,        
         LT.VER_EX5_36,        
         LT.VER_EX5_37,        
         LT.VER_EX5_38,        
         LT.VER_EX5_39,        
         LT.VER_EX5_40,        
         LT.VER_EX5_41,        
         LT.VER_EX5_42,        
         LT.VER_EX5_43,        
         LT.VER_EX5_44,        
         LT.VER_EX5_45,        
         LT.VER_EX5_46,        
         LT.VER_EX5_47,        
         LT.VER_EX5_48,        
         LT.VER_EX5_49,        
         LT.VER_EX5_50,        
         LT.VER_EX5_51,        
         LT.VER_EX5_52,        
         LT.VER_EX5_53,        
         LT.VER_EX5_54,        
         LT.VER_EX5_55,        
         LT.VER_EX5_56,        
         LT.VER_EX5_57,        
         LT.VER_EX5_58,        
         LT.VER_EX5_59,        
         LT.VER_EX5_60,        
         LT.VER_EX5_61,        
         LT.VER_EX5_62,        
         LT.VER_EX5_63,        
         LT.VER_EX5_64,        
         LT.VER_EX5_65,        
         LT.VER_EX5_66,        
         LT.VER_EX5_67,        
         LT.VER_EX5_68,        
         LT.VER_EX5_69,        
         LT.VER_EX5_70,        
         LT.VER_EX5_71,        
         LT.VER_EX5_72,        
         LT.VER_EX5_73,        
         LT.VER_EX5_74,        
         LT.VER_EX5_75,        
         LT.VER_EX5_76,        
         LT.VER_EX5_77,        
         LT.VER_EX5_78,        
         LT.VER_EX5_79,        
         LT.VER_EX5_80,        
         LT.VER_EX5_81,        
         LT.VER_EX5_82,        
         LT.VER_EX5_83,        
         LT.VER_EX5_84,        
         LT.VER_EX5_85,        
         LT.VER_EX5_86,        
         LT.VER_EX5_87,        
         LT.VER_EX5_88,        
         LT.VER_EX5_89,        
         LT.VER_EX5_90,        
         LT.VER_EX5_91,        
         LT.VER_EX5_92,        
     LT.VER_EX5_93,        
         LT.VER_EX5_94,        
         LT.VER_EX5_95,        
         LT.VER_EX5_96,        
         LT.VER_EX5_97,        
         LT.VER_EX5_98,        
         LT.VER_EX5_99,        
         LT.VER_EX5_100        
         FROM  #VEREX5TMP LT         
         INNER JOIN #VERIDTEMP VD ON LT.CUSTOMOBJECTID = VD.CUSTOMOBJECTID        
         WHERE LT.OWNERID = 985         
 END          
        
   /* INSERTING RELEVANT LIABILITY ID'S INTO TEMP TABLE */        
   SELECT LT.LIABILITYID,         
     LT.RELATEDTOID,        
     0 AS NEWLIABILITYID        
 INTO #LIAIDTEMP            
 FROM LIABILITY LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND LT.RELATEDTOID = AT.APPLICATIONID          
 WHERE LT.OWNERID = 985          
   AND LT.LAYOUTID IN (10204064,10204065);     
       
   SET @SUCCESSCOUNT = @@ROWCOUNT        
      
   IF(@SUCCESSCOUNT>0)    
   BEGIN    
  /* INSERTING RELEVANT LIABILITY RECORDS AND THEIR DATA INTO TEMP TABLE */         
  SELECT *        
  INTO #LIADATATEMP            
  FROM LIABILITY LT INNER JOIN #APLIDTEMP AT ON LT.OWNERID = 985 AND LT.RELATEDTOID = AT.APPLICATIONID          
  WHERE LT.OWNERID = 985          
  AND LT.LAYOUTID IN (10204064,10204065);         
     
  /* EXTENSION TABLE 1 */            
  SELECT *             
  INTO #LIAEX1TMP            
  FROM LIA_EX1 LT INNER JOIN #LIAIDTEMP AT ON LT.OWNERID = 985 AND  LT.LIA_EX1_ID = AT.LIABILITYID;          
              
  /* EXTENSION TABLE 2 */            
  SELECT *             
  INTO #LIAEX2TMP            
  FROM LIA_EX2 LT INNER JOIN #LIAIDTEMP AT ON LT.OWNERID = 985 AND  LT.LIA_EX2_ID = AT.LIABILITYID;          
              
  /* EXTENSION TABLE 3 */            
  SELECT *             
  INTO #LIAEX3TMP            
  FROM LIA_EX3 LT INNER JOIN #LIAIDTEMP AT ON LT.OWNERID = 985 AND  LT.LIA_EX3_ID = AT.LIABILITYID;          
            
  /* EXTENSION TABLE 4 */            
  SELECT *             
  INTO #LIAEX4TMP            
  FROM LIA_EX4 LT INNER JOIN #LIAIDTEMP AT ON LT.OWNERID = 985 AND  LT.LIA_EX4_ID = AT.LIABILITYID;          
            
  /* EXTENSION TABLE 5 */            
  SELECT *             
  INTO #LIAEX5TMP            
  FROM LIA_EX5 LT INNER JOIN #LIAIDTEMP AT ON LT.OWNERID = 985 AND  LT.LIA_EX5_ID = AT.LIABILITYID;          
        
  /* GENERATING NEW ID'S FOR LIABILITY RECORDS */        
  EXEC GETNEXTIDBLOCK 985,471,@SUCCESSCOUNT,@NEXTID OUT;        
        
  /* UPDATING NEW LIABILITY ID'S AND TAGGING THEIR NEW APPLICATION ID'S TO THEM IN THE TEMP TABLE */        
  UPDATE LT            
        SET LT.LIABILITYID = @NEXTID + P.ROWINDEX,            
            LT.RELATEDTOID = P.NEWAPPLICATIONID            
     FROM #LIADATATEMP LT            
     INNER JOIN(            
     SELECT N.NEWAPPLICATIONID,         
   P.LIABILITYID,        
   ROW_NUMBER () OVER (ORDER BY P.LIABILITYID ASC) AS ROWINDEX        
  FROM #LIAIDTEMP P        
  INNER JOIN #APLIDTEMP N ON N.APPLICATIONID = P.RELATEDTOID        
  ) AS P ON P.LIABILITYID = LT.LIABILITYID        
        
  UPDATE LT        
     SET LT.NEWLIABILITYID = @NEXTID + P.ROWINDEX        
  FROM #LIAIDTEMP LT        
  INNER JOIN (        
   SELECT P.LIABILITYID,        
      ROW_NUMBER () OVER (ORDER BY P.LIABILITYID ASC) AS ROWINDEX        
  FROM #LIAIDTEMP P        
  ) AS P ON P.LIABILITYID = LT.LIABILITYID        
       
  /* UPDATING IDLIST FOR LIABILITY OBJECT */                    
  UPDATE IL        
     SET IL.LASTID = (SELECT MAX(LIABILITYID) FROM #LIADATATEMP WHERE OWNERID = 985)        
  FROM IDLIST IL        
  WHERE IL.OWNERID = 985        
    AND IL.ITEMID  = 471;        
        
  /* INSERTING DATA INTO LIABILITY AND ITS RESPECTIVE EXTENSION TABLES */        
  INSERT INTO LIABILITY(OWNERID,        
         LIABILITYID,        
         CUSTOMOBJECTID,        
         DETAIL,        
         ASSIGNTO,        
         PRODUCTID,        
         LOANAMOUNT,        
         EMIAMOUNT,        
         STATUSCODEID,        
         STATUSID,        
         RELATEDTOTYPEID,        
         RELATEDTOID,        
         CREATEDBY,        
         CREATEDON,        
         LASTMODIFIEDBY,        
         LASTMODIFIEDON,        
         TOTALINSTALLMENTS,        
         INSTALLMENTSPAID,        
         BALANCEINSTALLMENT,        
         BOUNCES,        
         PRINCIPALOUTSTANDING,        
         LOANACCOUNTNUMBER,        
         SOURCEID,        
         TYPEID,        
         ASSIGNTONAME,        
         PRODUCTNAME,        
         STATUSCODE,        
         RELATEDTONAME,        
         SOURCENAME,        
         TYPE,        
         STATUS,        
         SUBJECT,        
         ASSIGNTOID,        
         LAYOUTID,        
         PROCESSID,        
         CREATEDBYTYPE,        
         LASTMODIFIEDBYTYPE,        
         PREVIOUSSTATUSCODEID,        
         STATUSCODECHANGEDON,        
         IMPORTCYCLEID,        
         UNIQUEID,        
         ACCOUNTOPENINGDATE,        
         LASTPAYMENTDATE,        
         DATEOFENQUIRY,        
         OWNERSHIPTYPE,        
         ENQUIRYAMOUNT,        
         OWNERSHIPTYPEID,        
         BALANCETENURE,        
         FINANCIERNAME,        
         LOANCLOSINGDATE,        
         ENQUIRYPURPOSE,        
         ENQUIRYPURPOSEID,        
         RELATEDTOTYPENAME)        
        SELECT LT.OWNERID,        
         LT.LIABILITYID,        
         LT.CUSTOMOBJECTID,      
         LT.DETAIL,        
         LT.ASSIGNTO,        
         LT.PRODUCTID,        
         LT.LOANAMOUNT,        
         LT.EMIAMOUNT,        
         LT.STATUSCODEID,        
         LT.STATUSID,        
         LT.RELATEDTOTYPEID,        
         LT.RELATEDTOID,        
         LT.CREATEDBY,        
         LT.CREATEDON,        
         LT.LASTMODIFIEDBY,        
         LT.LASTMODIFIEDON,        
         LT.TOTALINSTALLMENTS,        
         LT.INSTALLMENTSPAID,        
         LT.BALANCEINSTALLMENT,        
         LT.BOUNCES,        
         LT.PRINCIPALOUTSTANDING,        
         LT.LOANACCOUNTNUMBER,        
         LT.SOURCEID,        
         LT.TYPEID,        
         LT.ASSIGNTONAME,        
         LT.PRODUCTNAME,        
         LT.STATUSCODE,        
         LT.RELATEDTONAME,        
         LT.SOURCENAME,        
         LT.TYPE,        
         LT.STATUS,        
         LT.SUBJECT,        
         LT.ASSIGNTOID,        
         LT.LAYOUTID,        
         LT.PROCESSID,        
         LT.CREATEDBYTYPE,        
         LT.LASTMODIFIEDBYTYPE,        
         LT.PREVIOUSSTATUSCODEID,        
         LT.STATUSCODECHANGEDON,        
         LT.IMPORTCYCLEID,        
         LT.UNIQUEID,        
         LT.ACCOUNTOPENINGDATE,        
         LT.LASTPAYMENTDATE,        
         LT.DATEOFENQUIRY,        
         LT.OWNERSHIPTYPE,        
         LT.ENQUIRYAMOUNT,        
         LT.OWNERSHIPTYPEID,        
         LT.BALANCETENURE,        
         LT.FINANCIERNAME,        
         LT.LOANCLOSINGDATE,        
         LT.ENQUIRYPURPOSE,        
         LT.ENQUIRYPURPOSEID,        
         LT.RELATEDTOTYPENAME        
      FROM #LIADATATEMP LT        
      WHERE LT.OWNERID = 985;        
          
  INSERT INTO LIA_EX1(LT.OWNERID,        
       LT.LIA_EX1_ID,        
       LT.LIA_EX1_1,        
       LT.LIA_EX1_2,        
       LT.LIA_EX1_3,        
       LT.LIA_EX1_4,        
       LT.LIA_EX1_5,        
       LT.LIA_EX1_6,        
       LT.LIA_EX1_7,        
       LT.LIA_EX1_8,        
       LT.LIA_EX1_9,        
       LT.LIA_EX1_10,        
       LT.LIA_EX1_11,        
       LT.LIA_EX1_12,        
       LT.LIA_EX1_13,        
       LT.LIA_EX1_14,        
       LT.LIA_EX1_15,        
       LT.LIA_EX1_16,        
       LT.LIA_EX1_17,        
       LT.LIA_EX1_18,        
       LT.LIA_EX1_19,        
       LT.LIA_EX1_20,        
       LT.LIA_EX1_21,        
       LT.LIA_EX1_22,        
       LT.LIA_EX1_23,        
       LT.LIA_EX1_24,        
       LT.LIA_EX1_25,        
       LT.LIA_EX1_26,        
       LT.LIA_EX1_27,        
       LT.LIA_EX1_28,        
       LT.LIA_EX1_29,        
       LT.LIA_EX1_30,        
       LT.LIA_EX1_31,        
       LT.LIA_EX1_32,        
       LT.LIA_EX1_33,        
       LT.LIA_EX1_34,        
       LT.LIA_EX1_35,        
       LT.LIA_EX1_36,        
       LT.LIA_EX1_37,        
       LT.LIA_EX1_38,        
       LT.LIA_EX1_39,        
       LT.LIA_EX1_40,        
       LT.LIA_EX1_41,        
       LT.LIA_EX1_42,        
       LT.LIA_EX1_43,        
       LT.LIA_EX1_44,        
       LT.LIA_EX1_45,        
       LT.LIA_EX1_46,        
       LT.LIA_EX1_47,        
       LT.LIA_EX1_48,        
       LT.LIA_EX1_49,        
       LT.LIA_EX1_50,        
       LT.LIA_EX1_51,        
       LT.LIA_EX1_52,        
       LT.LIA_EX1_53,        
       LT.LIA_EX1_54,        
       LT.LIA_EX1_55,        
       LT.LIA_EX1_56,        
       LT.LIA_EX1_57,        
       LT.LIA_EX1_58,        
       LT.LIA_EX1_59,        
       LT.LIA_EX1_60,        
       LT.LIA_EX1_61,        
       LT.LIA_EX1_62,        
       LT.LIA_EX1_63,        
       LT.LIA_EX1_64,        
       LT.LIA_EX1_65,        
       LT.LIA_EX1_66,        
       LT.LIA_EX1_67,        
       LT.LIA_EX1_68,        
       LT.LIA_EX1_69,        
       LT.LIA_EX1_70,        
       LT.LIA_EX1_71,        
       LT.LIA_EX1_72,        
       LT.LIA_EX1_73,        
       LT.LIA_EX1_74,        
       LT.LIA_EX1_75,        
       LT.LIA_EX1_76,        
       LT.LIA_EX1_77,        
       LT.LIA_EX1_78,        
       LT.LIA_EX1_79,        
       LT.LIA_EX1_80,        
       LT.LIA_EX1_81,        
       LT.LIA_EX1_82,        
       LT.LIA_EX1_83,        
       LT.LIA_EX1_84,        
       LT.LIA_EX1_85,        
       LT.LIA_EX1_86,        
       LT.LIA_EX1_87,        
       LT.LIA_EX1_88,        
       LT.LIA_EX1_89,        
       LT.LIA_EX1_90,        
       LT.LIA_EX1_91,        
       LT.LIA_EX1_92,        
       LT.LIA_EX1_93,        
       LT.LIA_EX1_94,        
       LT.LIA_EX1_95,        
       LT.LIA_EX1_96,        
       LT.LIA_EX1_97,        
       LT.LIA_EX1_98,        
       LT.LIA_EX1_99,        
       LT.LIA_EX1_100)        
      SELECT  LT.OWNERID,        
        LD.NEWLIABILITYID,        
        LT.LIA_EX1_1,        
        LT.LIA_EX1_2,        
        LT.LIA_EX1_3,        
        LT.LIA_EX1_4,        
        LT.LIA_EX1_5,        
        LT.LIA_EX1_6,        
        LT.LIA_EX1_7,        
        LT.LIA_EX1_8,        
        LT.LIA_EX1_9,        
        LT.LIA_EX1_10,        
        LT.LIA_EX1_11,        
        LT.LIA_EX1_12,        
        LT.LIA_EX1_13,        
        LT.LIA_EX1_14,        
        LT.LIA_EX1_15,        
        LT.LIA_EX1_16,        
        LT.LIA_EX1_17,        
        LT.LIA_EX1_18,        
        LT.LIA_EX1_19,        
        LT.LIA_EX1_20,        
        LT.LIA_EX1_21,        
        LT.LIA_EX1_22,        
        LT.LIA_EX1_23,        
        LT.LIA_EX1_24,        
        LT.LIA_EX1_25,        
        LT.LIA_EX1_26,        
        LT.LIA_EX1_27,        
        LT.LIA_EX1_28,        
        LT.LIA_EX1_29,        
        LT.LIA_EX1_30,        
        LT.LIA_EX1_31,        
        LT.LIA_EX1_32,        
        LT.LIA_EX1_33,        
        LT.LIA_EX1_34,        
        LT.LIA_EX1_35,        
        LT.LIA_EX1_36,        
        LT.LIA_EX1_37,        
        LT.LIA_EX1_38,        
        LT.LIA_EX1_39,        
        LT.LIA_EX1_40,        
        LT.LIA_EX1_41,        
        LT.LIA_EX1_42,        
        LT.LIA_EX1_43,        
        LT.LIA_EX1_44,        
        LT.LIA_EX1_45,        
        LT.LIA_EX1_46,        
        LT.LIA_EX1_47,        
        LT.LIA_EX1_48,        
        LT.LIA_EX1_49,        
        LT.LIA_EX1_50,        
        LT.LIA_EX1_51,        
        LT.LIA_EX1_52,        
        LT.LIA_EX1_53,        
        LT.LIA_EX1_54,        
        LT.LIA_EX1_55,        
        LT.LIA_EX1_56,        
        LT.LIA_EX1_57,        
        LT.LIA_EX1_58,        
        LT.LIA_EX1_59,        
        LT.LIA_EX1_60,        
        LT.LIA_EX1_61,        
        LT.LIA_EX1_62,        
        LT.LIA_EX1_63,        
        LT.LIA_EX1_64,        
        LT.LIA_EX1_65,        
        LT.LIA_EX1_66,        
        LT.LIA_EX1_67,        
        LT.LIA_EX1_68,        
        LT.LIA_EX1_69,        
        LT.LIA_EX1_70,        
        LT.LIA_EX1_71,        
        LT.LIA_EX1_72,        
        LT.LIA_EX1_73,        
        LT.LIA_EX1_74,        
        LT.LIA_EX1_75,        
        LT.LIA_EX1_76,        
        LT.LIA_EX1_77,        
        LT.LIA_EX1_78,        
        LT.LIA_EX1_79,        
        LT.LIA_EX1_80,        
        LT.LIA_EX1_81,        
        LT.LIA_EX1_82,        
        LT.LIA_EX1_83,        
        LT.LIA_EX1_84,        
        LT.LIA_EX1_85,        
        LT.LIA_EX1_86,        
        LT.LIA_EX1_87,        
        LT.LIA_EX1_88,      
        LT.LIA_EX1_89,        
        LT.LIA_EX1_90,        
        LT.LIA_EX1_91,        
        LT.LIA_EX1_92,        
        LT.LIA_EX1_93,        
        LT.LIA_EX1_94,        
        LT.LIA_EX1_95,        
        LT.LIA_EX1_96,        
        LT.LIA_EX1_97,        
        LT.LIA_EX1_98,        
        LT.LIA_EX1_99,        
        LT.LIA_EX1_100        
        FROM  #LIAEX1TMP LT         
        INNER JOIN #LIAIDTEMP LD ON LT.LIA_EX1_ID = LD.LIABILITYID        
        WHERE LT.OWNERID = 985        
          
  INSERT INTO LIA_EX2(LT.OWNERID,        
        LT.LIA_EX2_ID,        
        LT.LIA_EX2_1,        
        LT.LIA_EX2_2,        
        LT.LIA_EX2_3,        
        LT.LIA_EX2_4,        
        LT.LIA_EX2_5,        
        LT.LIA_EX2_6,        
        LT.LIA_EX2_7,        
        LT.LIA_EX2_8,        
        LT.LIA_EX2_9,        
        LT.LIA_EX2_10,        
        LT.LIA_EX2_11,        
        LT.LIA_EX2_12,        
        LT.LIA_EX2_13,        
        LT.LIA_EX2_14,        
        LT.LIA_EX2_15,        
        LT.LIA_EX2_16,        
        LT.LIA_EX2_17,        
        LT.LIA_EX2_18,        
        LT.LIA_EX2_19,        
        LT.LIA_EX2_20,        
        LT.LIA_EX2_21,        
        LT.LIA_EX2_22,        
        LT.LIA_EX2_23,        
        LT.LIA_EX2_24,        
        LT.LIA_EX2_25,        
        LT.LIA_EX2_26,        
        LT.LIA_EX2_27,        
        LT.LIA_EX2_28,        
        LT.LIA_EX2_29,        
        LT.LIA_EX2_30,        
        LT.LIA_EX2_31,        
        LT.LIA_EX2_32,        
        LT.LIA_EX2_33,        
        LT.LIA_EX2_34,        
        LT.LIA_EX2_35,        
        LT.LIA_EX2_36,        
        LT.LIA_EX2_37,        
        LT.LIA_EX2_38,        
        LT.LIA_EX2_39,        
        LT.LIA_EX2_40,        
        LT.LIA_EX2_41,        
        LT.LIA_EX2_42,        
        LT.LIA_EX2_43,        
        LT.LIA_EX2_44,        
        LT.LIA_EX2_45,        
        LT.LIA_EX2_46,        
        LT.LIA_EX2_47,        
        LT.LIA_EX2_48,        
        LT.LIA_EX2_49,        
        LT.LIA_EX2_50,        
        LT.LIA_EX2_51,        
        LT.LIA_EX2_52,        
        LT.LIA_EX2_53,        
        LT.LIA_EX2_54,        
        LT.LIA_EX2_55,        
        LT.LIA_EX2_56,        
        LT.LIA_EX2_57,        
        LT.LIA_EX2_58,        
        LT.LIA_EX2_59,        
        LT.LIA_EX2_60,        
        LT.LIA_EX2_61,        
        LT.LIA_EX2_62,        
        LT.LIA_EX2_63,        
        LT.LIA_EX2_64,        
        LT.LIA_EX2_65,        
        LT.LIA_EX2_66,        
        LT.LIA_EX2_67,        
        LT.LIA_EX2_68,        
        LT.LIA_EX2_69,        
        LT.LIA_EX2_70,        
        LT.LIA_EX2_71,        
        LT.LIA_EX2_72,        
        LT.LIA_EX2_73,        
        LT.LIA_EX2_74,        
        LT.LIA_EX2_75,        
        LT.LIA_EX2_76,        
        LT.LIA_EX2_77,        
        LT.LIA_EX2_78,        
        LT.LIA_EX2_79,        
        LT.LIA_EX2_80,        
        LT.LIA_EX2_81,        
        LT.LIA_EX2_82,        
        LT.LIA_EX2_83,        
        LT.LIA_EX2_84,        
        LT.LIA_EX2_85,        
        LT.LIA_EX2_86,        
        LT.LIA_EX2_87,        
        LT.LIA_EX2_88,        
        LT.LIA_EX2_89,        
        LT.LIA_EX2_90,        
        LT.LIA_EX2_91,        
        LT.LIA_EX2_92,        
        LT.LIA_EX2_93,        
        LT.LIA_EX2_94,        
        LT.LIA_EX2_95,        
        LT.LIA_EX2_96,        
        LT.LIA_EX2_97,        
        LT.LIA_EX2_98,        
        LT.LIA_EX2_99,        
        LT.LIA_EX2_100)        
      SELECT  LT.OWNERID,        
        LD.NEWLIABILITYID,        
        LT.LIA_EX2_1,        
        LT.LIA_EX2_2,        
        LT.LIA_EX2_3,        
        LT.LIA_EX2_4,        
        LT.LIA_EX2_5,        
        LT.LIA_EX2_6,        
        LT.LIA_EX2_7,        
        LT.LIA_EX2_8,        
        LT.LIA_EX2_9,        
        LT.LIA_EX2_10,        
        LT.LIA_EX2_11,        
        LT.LIA_EX2_12,        
        LT.LIA_EX2_13,        
        LT.LIA_EX2_14,        
        LT.LIA_EX2_15,        
        LT.LIA_EX2_16,        
        LT.LIA_EX2_17,        
        LT.LIA_EX2_18,        
        LT.LIA_EX2_19,        
        LT.LIA_EX2_20,        
        LT.LIA_EX2_21,        
        LT.LIA_EX2_22,        
        LT.LIA_EX2_23,        
        LT.LIA_EX2_24,        
        LT.LIA_EX2_25,        
        LT.LIA_EX2_26,        
        LT.LIA_EX2_27,        
        LT.LIA_EX2_28,        
        LT.LIA_EX2_29,        
        LT.LIA_EX2_30,        
        LT.LIA_EX2_31,        
        LT.LIA_EX2_32,                LT.LIA_EX2_33,        
        LT.LIA_EX2_34,        
        LT.LIA_EX2_35,        
        LT.LIA_EX2_36,        
        LT.LIA_EX2_37,        
        LT.LIA_EX2_38,        
        LT.LIA_EX2_39,        
        LT.LIA_EX2_40,        
        LT.LIA_EX2_41,        
        LT.LIA_EX2_42,        
        LT.LIA_EX2_43,        
        LT.LIA_EX2_44,        
        LT.LIA_EX2_45,        
        LT.LIA_EX2_46,        
        LT.LIA_EX2_47,        
        LT.LIA_EX2_48,        
        LT.LIA_EX2_49,        
        LT.LIA_EX2_50,        
        LT.LIA_EX2_51,        
        LT.LIA_EX2_52,        
        LT.LIA_EX2_53,        
        LT.LIA_EX2_54,        
        LT.LIA_EX2_55,        
        LT.LIA_EX2_56,        
        LT.LIA_EX2_57,        
        LT.LIA_EX2_58,        
        LT.LIA_EX2_59,        
        LT.LIA_EX2_60,        
        LT.LIA_EX2_61,        
        LT.LIA_EX2_62,        
        LT.LIA_EX2_63,        
        LT.LIA_EX2_64,        
        LT.LIA_EX2_65,        
        LT.LIA_EX2_66,        
        LT.LIA_EX2_67,        
        LT.LIA_EX2_68,        
        LT.LIA_EX2_69,        
        LT.LIA_EX2_70,        
        LT.LIA_EX2_71,        
        LT.LIA_EX2_72,        
        LT.LIA_EX2_73,        
        LT.LIA_EX2_74,        
        LT.LIA_EX2_75,        
        LT.LIA_EX2_76,        
        LT.LIA_EX2_77,        
        LT.LIA_EX2_78,        
        LT.LIA_EX2_79,        
        LT.LIA_EX2_80,        
        LT.LIA_EX2_81,        
        LT.LIA_EX2_82,        
        LT.LIA_EX2_83,        
        LT.LIA_EX2_84,        
        LT.LIA_EX2_85,        
        LT.LIA_EX2_86,        
        LT.LIA_EX2_87,        
        LT.LIA_EX2_88,        
        LT.LIA_EX2_89,        
        LT.LIA_EX2_90,        
        LT.LIA_EX2_91,        
        LT.LIA_EX2_92,        
        LT.LIA_EX2_93,        
        LT.LIA_EX2_94,        
        LT.LIA_EX2_95,        
        LT.LIA_EX2_96,        
        LT.LIA_EX2_97,        
        LT.LIA_EX2_98,        
        LT.LIA_EX2_99,        
        LT.LIA_EX2_100        
        FROM  #LIAEX2TMP LT         
        INNER JOIN #LIAIDTEMP LD ON LT.LIA_EX2_ID = LD.LIABILITYID        
        WHERE LT.OWNERID = 985        
          
  INSERT INTO LIA_EX3(LT.OWNERID,        
        LT.LIA_EX3_ID,        
        LT.LIA_EX3_1,        
        LT.LIA_EX3_2,        
        LT.LIA_EX3_3,        
        LT.LIA_EX3_4,        
        LT.LIA_EX3_5,        
        LT.LIA_EX3_6,        
        LT.LIA_EX3_7,        
        LT.LIA_EX3_8,        
        LT.LIA_EX3_9,        
        LT.LIA_EX3_10,        
        LT.LIA_EX3_11,        
        LT.LIA_EX3_12,        
        LT.LIA_EX3_13,        
        LT.LIA_EX3_14,        
        LT.LIA_EX3_15,        
        LT.LIA_EX3_16,        
        LT.LIA_EX3_17,        
        LT.LIA_EX3_18,        
        LT.LIA_EX3_19,        
        LT.LIA_EX3_20,        
        LT.LIA_EX3_21,        
        LT.LIA_EX3_22,        
        LT.LIA_EX3_23,        
        LT.LIA_EX3_24,        
        LT.LIA_EX3_25,        
        LT.LIA_EX3_26,        
        LT.LIA_EX3_27,        
        LT.LIA_EX3_28,        
        LT.LIA_EX3_29,        
        LT.LIA_EX3_30,        
        LT.LIA_EX3_31,        
        LT.LIA_EX3_32,        
        LT.LIA_EX3_33,        
        LT.LIA_EX3_34,        
        LT.LIA_EX3_35,        
        LT.LIA_EX3_36,        
        LT.LIA_EX3_37,        
        LT.LIA_EX3_38,        
        LT.LIA_EX3_39,        
        LT.LIA_EX3_40,        
        LT.LIA_EX3_41,        
        LT.LIA_EX3_42,        
        LT.LIA_EX3_43,        
        LT.LIA_EX3_44,        
        LT.LIA_EX3_45,        
        LT.LIA_EX3_46,        
        LT.LIA_EX3_47,        
        LT.LIA_EX3_48,        
        LT.LIA_EX3_49,        
        LT.LIA_EX3_50,        
        LT.LIA_EX3_51,        
        LT.LIA_EX3_52,        
        LT.LIA_EX3_53,        
        LT.LIA_EX3_54,        
        LT.LIA_EX3_55,        
        LT.LIA_EX3_56,        
        LT.LIA_EX3_57,        
        LT.LIA_EX3_58,                LT.LIA_EX3_59,        
        LT.LIA_EX3_60,        
        LT.LIA_EX3_61,        
        LT.LIA_EX3_62,        
        LT.LIA_EX3_63,        
        LT.LIA_EX3_64,        
        LT.LIA_EX3_65,        
        LT.LIA_EX3_66,        
        LT.LIA_EX3_67,        
        LT.LIA_EX3_68,        
        LT.LIA_EX3_69,        
        LT.LIA_EX3_70,        
        LT.LIA_EX3_71,        
        LT.LIA_EX3_72,        
        LT.LIA_EX3_73,        
        LT.LIA_EX3_74,        
        LT.LIA_EX3_75,        
        LT.LIA_EX3_76,        
        LT.LIA_EX3_77,        
        LT.LIA_EX3_78,        
        LT.LIA_EX3_79,        
        LT.LIA_EX3_80,        
        LT.LIA_EX3_81,        
        LT.LIA_EX3_82,        
        LT.LIA_EX3_83,        
        LT.LIA_EX3_84,        
        LT.LIA_EX3_85,        
        LT.LIA_EX3_86,        
        LT.LIA_EX3_87,        
        LT.LIA_EX3_88,        
        LT.LIA_EX3_89,        
        LT.LIA_EX3_90,        
        LT.LIA_EX3_91,        
        LT.LIA_EX3_92,        
        LT.LIA_EX3_93,        
        LT.LIA_EX3_94,        
        LT.LIA_EX3_95,        
        LT.LIA_EX3_96,        
        LT.LIA_EX3_97,        
        LT.LIA_EX3_98,        
        LT.LIA_EX3_99,        
        LT.LIA_EX3_100)        
      SELECT  LT.OWNERID,        
        LD.NEWLIABILITYID,        
        LT.LIA_EX3_1,        
        LT.LIA_EX3_2,        
        LT.LIA_EX3_3,        
        LT.LIA_EX3_4,        
        LT.LIA_EX3_5,        
        LT.LIA_EX3_6,        
        LT.LIA_EX3_7,        
        LT.LIA_EX3_8,        
        LT.LIA_EX3_9,        
        LT.LIA_EX3_10,        
        LT.LIA_EX3_11,        
        LT.LIA_EX3_12,        
        LT.LIA_EX3_13,        
        LT.LIA_EX3_14,        
        LT.LIA_EX3_15,        
        LT.LIA_EX3_16,        
        LT.LIA_EX3_17,        
        LT.LIA_EX3_18,        
        LT.LIA_EX3_19,        
        LT.LIA_EX3_20,        
        LT.LIA_EX3_21,        
        LT.LIA_EX3_22,        
        LT.LIA_EX3_23,        
        LT.LIA_EX3_24,        
        LT.LIA_EX3_25,        
        LT.LIA_EX3_26,        
        LT.LIA_EX3_27,        
        LT.LIA_EX3_28,        
        LT.LIA_EX3_29,        
        LT.LIA_EX3_30,        
        LT.LIA_EX3_31,        
        LT.LIA_EX3_32,        
        LT.LIA_EX3_33,        
        LT.LIA_EX3_34,        
        LT.LIA_EX3_35,        
        LT.LIA_EX3_36,        
        LT.LIA_EX3_37,        
        LT.LIA_EX3_38,        
        LT.LIA_EX3_39,        
        LT.LIA_EX3_40,        
        LT.LIA_EX3_41,        
        LT.LIA_EX3_42,        
        LT.LIA_EX3_43,        
        LT.LIA_EX3_44,        
        LT.LIA_EX3_45,        
        LT.LIA_EX3_46,        
        LT.LIA_EX3_47,        
        LT.LIA_EX3_48,        
        LT.LIA_EX3_49,        
        LT.LIA_EX3_50,        
        LT.LIA_EX3_51,        
        LT.LIA_EX3_52,        
        LT.LIA_EX3_53,        
        LT.LIA_EX3_54,        
        LT.LIA_EX3_55,        
        LT.LIA_EX3_56,        
        LT.LIA_EX3_57,        
        LT.LIA_EX3_58,        
        LT.LIA_EX3_59,        
        LT.LIA_EX3_60,        
        LT.LIA_EX3_61,        
        LT.LIA_EX3_62,        
        LT.LIA_EX3_63,        
        LT.LIA_EX3_64,        
        LT.LIA_EX3_65,        
        LT.LIA_EX3_66,        
        LT.LIA_EX3_67,        
        LT.LIA_EX3_68,        
        LT.LIA_EX3_69,        
        LT.LIA_EX3_70,        
        LT.LIA_EX3_71,        
        LT.LIA_EX3_72,        
        LT.LIA_EX3_73,        
        LT.LIA_EX3_74,        
        LT.LIA_EX3_75,        
        LT.LIA_EX3_76,        
        LT.LIA_EX3_77,        
        LT.LIA_EX3_78,        
        LT.LIA_EX3_79,        
        LT.LIA_EX3_80,        
        LT.LIA_EX3_81,        
        LT.LIA_EX3_82,        
        LT.LIA_EX3_83,        
        LT.LIA_EX3_84,        
        LT.LIA_EX3_85,        
        LT.LIA_EX3_86,        
        LT.LIA_EX3_87,        
        LT.LIA_EX3_88,        
        LT.LIA_EX3_89,        
        LT.LIA_EX3_90,        
        LT.LIA_EX3_91,        
        LT.LIA_EX3_92,        
        LT.LIA_EX3_93,        
        LT.LIA_EX3_94,        
        LT.LIA_EX3_95,        
        LT.LIA_EX3_96,        
        LT.LIA_EX3_97,        
        LT.LIA_EX3_98,        
        LT.LIA_EX3_99,        
        LT.LIA_EX3_100        
        FROM  #LIAEX3TMP LT         
        INNER JOIN #LIAIDTEMP LD ON LT.LIA_EX3_ID = LD.LIABILITYID        
        WHERE LT.OWNERID = 985        
          
  INSERT INTO LIA_EX4(LT.OWNERID,        
        LT.LIA_EX4_ID,        
        LT.LIA_EX4_1,        
        LT.LIA_EX4_2,        
        LT.LIA_EX4_3,        
        LT.LIA_EX4_4,        
        LT.LIA_EX4_5,        
        LT.LIA_EX4_6,        
        LT.LIA_EX4_7,        
        LT.LIA_EX4_8,        
        LT.LIA_EX4_9,        
        LT.LIA_EX4_10,        
        LT.LIA_EX4_11,        
        LT.LIA_EX4_12,        
        LT.LIA_EX4_13,        
        LT.LIA_EX4_14,        
        LT.LIA_EX4_15,        
        LT.LIA_EX4_16,        
        LT.LIA_EX4_17,        
        LT.LIA_EX4_18,        
        LT.LIA_EX4_19,        
        LT.LIA_EX4_20,        
        LT.LIA_EX4_21,        
        LT.LIA_EX4_22,        
        LT.LIA_EX4_23,        
        LT.LIA_EX4_24,        
        LT.LIA_EX4_25,        
        LT.LIA_EX4_26,        
        LT.LIA_EX4_27,        
        LT.LIA_EX4_28,        
        LT.LIA_EX4_29,        
        LT.LIA_EX4_30,        
        LT.LIA_EX4_31,        
        LT.LIA_EX4_32,        
        LT.LIA_EX4_33,        
        LT.LIA_EX4_34,        
        LT.LIA_EX4_35,        
        LT.LIA_EX4_36,        
        LT.LIA_EX4_37,        
        LT.LIA_EX4_38,        
        LT.LIA_EX4_39,        
        LT.LIA_EX4_40,        
        LT.LIA_EX4_41,        
        LT.LIA_EX4_42,        
        LT.LIA_EX4_43,        
        LT.LIA_EX4_44,        
        LT.LIA_EX4_45,        
        LT.LIA_EX4_46,        
        LT.LIA_EX4_47,        
        LT.LIA_EX4_48,        
        LT.LIA_EX4_49,        
        LT.LIA_EX4_50,        
        LT.LIA_EX4_51,        
        LT.LIA_EX4_52,        
        LT.LIA_EX4_53,        
        LT.LIA_EX4_54,        
        LT.LIA_EX4_55,        
        LT.LIA_EX4_56,        
        LT.LIA_EX4_57,        
        LT.LIA_EX4_58,        
        LT.LIA_EX4_59,        
        LT.LIA_EX4_60,        
        LT.LIA_EX4_61,        
        LT.LIA_EX4_62,        
        LT.LIA_EX4_63,        
        LT.LIA_EX4_64,        
        LT.LIA_EX4_65,        
        LT.LIA_EX4_66,        
        LT.LIA_EX4_67,        
        LT.LIA_EX4_68,        
        LT.LIA_EX4_69,        
        LT.LIA_EX4_70,        
        LT.LIA_EX4_71,        
        LT.LIA_EX4_72,        
        LT.LIA_EX4_73,        
        LT.LIA_EX4_74,        
        LT.LIA_EX4_75,        
        LT.LIA_EX4_76,        
        LT.LIA_EX4_77,        
        LT.LIA_EX4_78,        
        LT.LIA_EX4_79,        
        LT.LIA_EX4_80,        
        LT.LIA_EX4_81,        
        LT.LIA_EX4_82,        
        LT.LIA_EX4_83,        
        LT.LIA_EX4_84,        
        LT.LIA_EX4_85,        
        LT.LIA_EX4_86,        
        LT.LIA_EX4_87,        
        LT.LIA_EX4_88,        
        LT.LIA_EX4_89,        
        LT.LIA_EX4_90,        
        LT.LIA_EX4_91,        
        LT.LIA_EX4_92,        
        LT.LIA_EX4_93,        
        LT.LIA_EX4_94,        
        LT.LIA_EX4_95,        
        LT.LIA_EX4_96,        
        LT.LIA_EX4_97,        
        LT.LIA_EX4_98,        
        LT.LIA_EX4_99,        
        LT.LIA_EX4_100)        
      SELECT  LT.OWNERID,        
        LD.NEWLIABILITYID,        
        LT.LIA_EX4_1,        
        LT.LIA_EX4_2,        
        LT.LIA_EX4_3,        
        LT.LIA_EX4_4,        
        LT.LIA_EX4_5,        
        LT.LIA_EX4_6,        
        LT.LIA_EX4_7,        
        LT.LIA_EX4_8,        
   LT.LIA_EX4_9,        
        LT.LIA_EX4_10,        
        LT.LIA_EX4_11,        
        LT.LIA_EX4_12,        
        LT.LIA_EX4_13,        
        LT.LIA_EX4_14,        
        LT.LIA_EX4_15,        
        LT.LIA_EX4_16,        
        LT.LIA_EX4_17,        
        LT.LIA_EX4_18,        
        LT.LIA_EX4_19,        
        LT.LIA_EX4_20,        
        LT.LIA_EX4_21,        
        LT.LIA_EX4_22,        
        LT.LIA_EX4_23,        
        LT.LIA_EX4_24,        
        LT.LIA_EX4_25,        
        LT.LIA_EX4_26,        
        LT.LIA_EX4_27,        
        LT.LIA_EX4_28,        
        LT.LIA_EX4_29,        
        LT.LIA_EX4_30,        
        LT.LIA_EX4_31,        
        LT.LIA_EX4_32,        
        LT.LIA_EX4_33,        
        LT.LIA_EX4_34,        
        LT.LIA_EX4_35,        
        LT.LIA_EX4_36,        
        LT.LIA_EX4_37,        
        LT.LIA_EX4_38,        
        LT.LIA_EX4_39,        
        LT.LIA_EX4_40,        
        LT.LIA_EX4_41,        
        LT.LIA_EX4_42,        
        LT.LIA_EX4_43,        
        LT.LIA_EX4_44,        
        LT.LIA_EX4_45,        
        LT.LIA_EX4_46,        
        LT.LIA_EX4_47,        
        LT.LIA_EX4_48,        
        LT.LIA_EX4_49,        
        LT.LIA_EX4_50,        
        LT.LIA_EX4_51,        
        LT.LIA_EX4_52,        
        LT.LIA_EX4_53,        
        LT.LIA_EX4_54,        
        LT.LIA_EX4_55,        
        LT.LIA_EX4_56,        
        LT.LIA_EX4_57,        
        LT.LIA_EX4_58,        
        LT.LIA_EX4_59,        
        LT.LIA_EX4_60,        
        LT.LIA_EX4_61,        
        LT.LIA_EX4_62,        
        LT.LIA_EX4_63,        
        LT.LIA_EX4_64,        
        LT.LIA_EX4_65,        
        LT.LIA_EX4_66,        
        LT.LIA_EX4_67,        
        LT.LIA_EX4_68,        
        LT.LIA_EX4_69,        
        LT.LIA_EX4_70,        
        LT.LIA_EX4_71,        
        LT.LIA_EX4_72,        
        LT.LIA_EX4_73,        
        LT.LIA_EX4_74,        
        LT.LIA_EX4_75,        
        LT.LIA_EX4_76,        
        LT.LIA_EX4_77,        
        LT.LIA_EX4_78,        
        LT.LIA_EX4_79,        
        LT.LIA_EX4_80,        
        LT.LIA_EX4_81,        
        LT.LIA_EX4_82,        
        LT.LIA_EX4_83,        
        LT.LIA_EX4_84,        
        LT.LIA_EX4_85,        
        LT.LIA_EX4_86,        
        LT.LIA_EX4_87,        
        LT.LIA_EX4_88,        
        LT.LIA_EX4_89,        
        LT.LIA_EX4_90,        
        LT.LIA_EX4_91,        
        LT.LIA_EX4_92,        
        LT.LIA_EX4_93,        
        LT.LIA_EX4_94,        
        LT.LIA_EX4_95,        
        LT.LIA_EX4_96,        
        LT.LIA_EX4_97,        
        LT.LIA_EX4_98,        
        LT.LIA_EX4_99,        
        LT.LIA_EX4_100        
        FROM  #LIAEX4TMP LT         
        INNER JOIN #LIAIDTEMP LD ON LT.LIA_EX4_ID = LD.LIABILITYID        
        WHERE LT.OWNERID = 985              
                
  INSERT INTO LIA_EX5(LT.OWNERID,        
        LT.LIA_EX5_ID,        
        LT.LIA_EX5_1,        
        LT.LIA_EX5_2,        
        LT.LIA_EX5_3,        
        LT.LIA_EX5_4,        
        LT.LIA_EX5_5,        
        LT.LIA_EX5_6,        
        LT.LIA_EX5_7,        
        LT.LIA_EX5_8,        
        LT.LIA_EX5_9,        
        LT.LIA_EX5_10,        
        LT.LIA_EX5_11,        
        LT.LIA_EX5_12,        
        LT.LIA_EX5_13,        
        LT.LIA_EX5_14,        
        LT.LIA_EX5_15,        
        LT.LIA_EX5_16,        
        LT.LIA_EX5_17,        
        LT.LIA_EX5_18,        
        LT.LIA_EX5_19,        
        LT.LIA_EX5_20,        
        LT.LIA_EX5_21,        
        LT.LIA_EX5_22,        
        LT.LIA_EX5_23,        
        LT.LIA_EX5_24,        
        LT.LIA_EX5_25,        
        LT.LIA_EX5_26,        
        LT.LIA_EX5_27,        
        LT.LIA_EX5_28,        
        LT.LIA_EX5_29,        
        LT.LIA_EX5_30,        
        LT.LIA_EX5_31,        
        LT.LIA_EX5_32,        
        LT.LIA_EX5_33,        
        LT.LIA_EX5_34,        
        LT.LIA_EX5_35,        
        LT.LIA_EX5_36,        
        LT.LIA_EX5_37,        
        LT.LIA_EX5_38,        
        LT.LIA_EX5_39,        
    LT.LIA_EX5_40,        
        LT.LIA_EX5_41,        
        LT.LIA_EX5_42,        
        LT.LIA_EX5_43,        
        LT.LIA_EX5_44,        
        LT.LIA_EX5_45,        
        LT.LIA_EX5_46,        
        LT.LIA_EX5_47,        
        LT.LIA_EX5_48,        
        LT.LIA_EX5_49,        
        LT.LIA_EX5_50,        
        LT.LIA_EX5_51,        
        LT.LIA_EX5_52,        
        LT.LIA_EX5_53,        
        LT.LIA_EX5_54,        
        LT.LIA_EX5_55,        
        LT.LIA_EX5_56,        
        LT.LIA_EX5_57,        
        LT.LIA_EX5_58,        
        LT.LIA_EX5_59,        
        LT.LIA_EX5_60,        
    LT.LIA_EX5_61,        
        LT.LIA_EX5_62,        
        LT.LIA_EX5_63,        
        LT.LIA_EX5_64,        
        LT.LIA_EX5_65,        
        LT.LIA_EX5_66,        
        LT.LIA_EX5_67,        
        LT.LIA_EX5_68,        
        LT.LIA_EX5_69,        
        LT.LIA_EX5_70,        
        LT.LIA_EX5_71,        
        LT.LIA_EX5_72,        
        LT.LIA_EX5_73,        
        LT.LIA_EX5_74,        
        LT.LIA_EX5_75,        
        LT.LIA_EX5_76,        
        LT.LIA_EX5_77,        
        LT.LIA_EX5_78,        
        LT.LIA_EX5_79,        
        LT.LIA_EX5_80,        
        LT.LIA_EX5_81,        
        LT.LIA_EX5_82,        
        LT.LIA_EX5_83,        
        LT.LIA_EX5_84,        
        LT.LIA_EX5_85,        
        LT.LIA_EX5_86,        
        LT.LIA_EX5_87,        
        LT.LIA_EX5_88,        
        LT.LIA_EX5_89,        
        LT.LIA_EX5_90,        
        LT.LIA_EX5_91,        
        LT.LIA_EX5_92,        
        LT.LIA_EX5_93,        
        LT.LIA_EX5_94,        
        LT.LIA_EX5_95,        
        LT.LIA_EX5_96,        
        LT.LIA_EX5_97,        
        LT.LIA_EX5_98,        
        LT.LIA_EX5_99,        
        LT.LIA_EX5_100)        
      SELECT  LT.OWNERID,        
        LD.NEWLIABILITYID,        
        LT.LIA_EX5_1,        
        LT.LIA_EX5_2,        
        LT.LIA_EX5_3,        
        LT.LIA_EX5_4,        
        LT.LIA_EX5_5,        
        LT.LIA_EX5_6,        
        LT.LIA_EX5_7,        
        LT.LIA_EX5_8,        
        LT.LIA_EX5_9,        
        LT.LIA_EX5_10,        
        LT.LIA_EX5_11,        
        LT.LIA_EX5_12,        
        LT.LIA_EX5_13,        
        LT.LIA_EX5_14,        
        LT.LIA_EX5_15,        
        LT.LIA_EX5_16,        
        LT.LIA_EX5_17,        
        LT.LIA_EX5_18,        
        LT.LIA_EX5_19,        
        LT.LIA_EX5_20,        
        LT.LIA_EX5_21,        
        LT.LIA_EX5_22,        
        LT.LIA_EX5_23,        
        LT.LIA_EX5_24,        
        LT.LIA_EX5_25,        
        LT.LIA_EX5_26,        
        LT.LIA_EX5_27,        
        LT.LIA_EX5_28,        
        LT.LIA_EX5_29,        
        LT.LIA_EX5_30,        
        LT.LIA_EX5_31,        
        LT.LIA_EX5_32,        
        LT.LIA_EX5_33,        
        LT.LIA_EX5_34,        
        LT.LIA_EX5_35,        
        LT.LIA_EX5_36,        
        LT.LIA_EX5_37,        
        LT.LIA_EX5_38,        
        LT.LIA_EX5_39,        
        LT.LIA_EX5_40,        
        LT.LIA_EX5_41,        
        LT.LIA_EX5_42,        
        LT.LIA_EX5_43,        
        LT.LIA_EX5_44,        
        LT.LIA_EX5_45,        
        LT.LIA_EX5_46,        
        LT.LIA_EX5_47,        
        LT.LIA_EX5_48,        
        LT.LIA_EX5_49,        
        LT.LIA_EX5_50,        
        LT.LIA_EX5_51,        
        LT.LIA_EX5_52,        
        LT.LIA_EX5_53,        
        LT.LIA_EX5_54,        
        LT.LIA_EX5_55,        
        LT.LIA_EX5_56,        
        LT.LIA_EX5_57,        
        LT.LIA_EX5_58,        
        LT.LIA_EX5_59,        
        LT.LIA_EX5_60,        
        LT.LIA_EX5_61,        
        LT.LIA_EX5_62,        
        LT.LIA_EX5_63,        
        LT.LIA_EX5_64,        
        LT.LIA_EX5_65,        
        LT.LIA_EX5_66,        
        LT.LIA_EX5_67,        
        LT.LIA_EX5_68,        
        LT.LIA_EX5_69,        
        LT.LIA_EX5_70,        
        LT.LIA_EX5_71,        
        LT.LIA_EX5_72,        
        LT.LIA_EX5_73,        
        LT.LIA_EX5_74,        
        LT.LIA_EX5_75,        
        LT.LIA_EX5_76,        
        LT.LIA_EX5_77,        
        LT.LIA_EX5_78,        
        LT.LIA_EX5_79,        
        LT.LIA_EX5_80,        
        LT.LIA_EX5_81,        
        LT.LIA_EX5_82,        
        LT.LIA_EX5_83,        
        LT.LIA_EX5_84,        
        LT.LIA_EX5_85,        
        LT.LIA_EX5_86,        
        LT.LIA_EX5_87,        
        LT.LIA_EX5_88,        
        LT.LIA_EX5_89,        
        LT.LIA_EX5_90,        
        LT.LIA_EX5_91,        
        LT.LIA_EX5_92,        
        LT.LIA_EX5_93,        
        LT.LIA_EX5_94,        
        LT.LIA_EX5_95,        
        LT.LIA_EX5_96,        
        LT.LIA_EX5_97,        
        LT.LIA_EX5_98,        
        LT.LIA_EX5_99,        
        LT.LIA_EX5_100        
        FROM  #LIAEX5TMP LT         
        INNER JOIN #LIAIDTEMP LD ON LT.LIA_EX5_ID = LD.LIABILITYID        
        WHERE LT.OWNERID = 985       
 END         
        
    /* INSERTING RELEVANT ID INTO TEMP TABLE */   SELECT AttachmentID,    
     0 AS NATID,    
     ItemID    
 INTO #ATCTMPID    
 FROM ATTACHMENTMASTER AT     
 INNER JOIN #APLIDTEMP LT ON AT.ITEMID = LT.APPLICATIONID    
 WHERE AT.OWNERID=985    
    
 SET @SUCCESSCOUNT = @@ROWCOUNT    
    
 IF(@SUCCESSCOUNT>0)    
  BEGIN    
    
   /* INSERTING ATTACHMENT DATA INTO TEMP TABLE */    
   SELECT *     
   INTO #ATCTMPDATA    
   FROM ATTACHMENTMASTER AT    
   INNER JOIN #APLIDTEMP LT ON AT.ITEMID = LT.APPLICATIONID    
   WHERE AT.OWNERID=985;    
    
   /* GENERATING NEW ID'S FOR THE ATTACHMENTS */    
   EXEC GETNEXTIDBLOCK 985,129,@SUCCESSCOUNT,@NEXTID OUT;             
    
   /* UPDATING GENERATED ATTACHMENT ID INTO TEMP TABLE */    
   UPDATE LT    
      SET LT.ATTACHMENTID = @NEXTID + P.ROWINDEX,    
       LT.ITEMID = P.NEWAPPLICATIONID            
   FROM #ATCTMPDATA LT            
   INNER JOIN(            
   SELECT P.ATTACHMENTID,    
       N.NEWAPPLICATIONID,    
       ROW_NUMBER () OVER (ORDER BY P.ATTACHMENTID ASC) AS ROWINDEX            
   FROM #ATCTMPID P            
   INNER JOIN #APLIDTEMP N ON N.APPLICATIONID = P.ITEMID    
   ) AS P ON LT.ATTACHMENTID = P.ATTACHMENTID    
    
   /*UPDATING NEW ATTACHMENT ID INTO TEMP TABLE */    
   UPDATE LT    
      SET LT.NATID = @NEXTID + P.ROWINDEX    
   FROM #ATCTMPID LT            
   INNER JOIN(            
   SELECT P.ATTACHMENTID,    
       ROW_NUMBER () OVER (ORDER BY P.ATTACHMENTID ASC) AS ROWINDEX            
   FROM #ATCTMPID P            
   ) AS P ON LT.ATTACHMENTID = P.ATTACHMENTID    
    
   /* UPDATING IDLIST FOR ATTACHMENT OBJECT */    
   UPDATE IL    
      SET IL.LASTID = (SELECT MAX(ATTACHMENTID) FROM #ATCTMPDATA WHERE OWNERID = 985)    
   FROM IDLIST IL    
   WHERE IL.OwnerID = 985    
     AND IL.ItemID = 129    
    
   /* INSERTING DATA INTO SYSTEM TABLE */    
   INSERT INTO ATTACHMENTMASTER(OwnerID,    
           AttachmentID,    
           ItemType,    
           ItemID,    
           AttachedID,    
           AttachedOn,    
           AttachedBy,    
           fieldMapping,    
           CustomFieldID)    
          SELECT LT.OwnerID,     
           LT.AttachmentID,    
           LT.ItemType,    
           LT.ItemID,    
           LT.AttachedID,    
           LT.AttachedOn,    
           LT.AttachedBy,    
           LT.fieldMapping,    
           LT.CustomFieldID    
          FROM #ATCTMPDATA LT    
          WHERE LT.OWNERID = 985    
  END    
    
 SELECT 'YES' AS VALUE;        
    
END     

CREATE     PROCEDURE MPI_CLONE_APPLICATION_ATTACHMENT(@USERID INT,@ORIGINALAPPLICATIONID INT,@NEWAPPLICATIONID INT) AS      
/*       
 Created On : - 28th May, 2024; Created By: - Pradyuman Sharma      
 Details : - Clone Attachment data inside new cloned loan application.   
 exec MPI_CLONE_APPLICATION_ATTACHMENT 1,10373,10694  
*/      
BEGIN      
      
 /* DECLARING VARIABLES TO BE USED */      
 DECLARE @SUCCESSCOUNT INT, @NEXTID INT;      
 DECLARE @TODAY DATETIME = GETUTCDATE();  
 DECLARE @ERRORMESSAGE NVARCHAR(256);  
   
 BEGIN TRY      
  BEGIN TRAN   
  
 /* INSERTING RELEVANT ID INTO TEMP TABLE */         
 SELECT ROW_NUMBER() OVER (ORDER BY ITEMID) AS ROWINDEX,      
     ATTACHMENTID      
 INTO #ATCTMPID        
 FROM ATTACHMENTMASTER AT         
 WHERE AT.OWNERID=985 AND AT.ITEMID = @ORIGINALAPPLICATIONID;      
      
 SET @SUCCESSCOUNT = @@ROWCOUNT;      
      
    /* GENERATING NEW LIABILITY ID'S FOR TO BE CLONED RECORDS */           
    EXEC GETNEXTIDBLOCK 985, 129, @SUCCESSCOUNT, @NEXTID OUT;      
      
 /* INSERTING DATA INTO LIABILITY TABLES */       
 INSERT INTO ATTACHMENTMASTER(OWNERID,ATTACHMENTID,ITEMTYPE,ITEMID,ATTACHEDID,ATTACHEDON,ATTACHEDBY,FIELDMAPPING,CUSTOMFIELDID)        
    SELECT LT.OwnerID,AT.ROWINDEX + @NEXTID,LT.ITEMTYPE,@NEWAPPLICATIONID,LT.ATTACHEDID,LT.ATTACHEDON,LT.ATTACHEDBY,LT.FIELDMAPPING,LT.CUSTOMFIELDID        
    FROM ATTACHMENTMASTER LT      
   INNER JOIN #ATCTMPID AT ON LT.AttachmentID = AT.AttachmentID      
    WHERE LT.OWNERID = 985;     
     
 UPDATE IDLIST SET LASTID = (SELECT MAX(ATTACHMENTID) FROM ATTACHMENTMASTER WHERE OWNERID = 985) WHERE OWNERID = 985 AND ITEMID = 129 /*ATTACHMENTMASTER*/                
  
 --BEGIN    
  --THROW 99001, 'eror in dms', 1;    
 --END;   
  
 COMMIT;  
  END TRY              
  BEGIN CATCH    
  ROLLBACK;    
    
  SELECT @ERRORMESSAGE = SUBSTRING(ERROR_MESSAGE(), 0, 255);    
 INSERT INTO MPI_CLONE_LOG VALUES(@TODAY,@USERID,@ERRORMESSAGE,'Log for DMS insertion')    
 BEGIN    
  THROW 99001, @ERRORMESSAGE, 1;    
 END;    
    
  END CATCH    
END  

CREATE   PROC [dbo].[MPI_CLONE_APPLICATION_LIABILITY] (@USERID INT, @ORIGINALAPPLICATIONID INT, @NEWAPPLICATIONID INT) AS              
/*              
  Created On: 22-May-2024; Created By: Shahbaz Shaikh;              
  Modified On: 28-May-2024; Modified By: Pradyuman Sharma              
  Details: Clone Verificaiton Data inside newly cloned loan application.              
  EXEC MPI_CLONE_APPLICATION_LIABILITY 1,10373,10694              
*/              
BEGIN              
              
  /* DECLARING VARIABLES TO BE USED */              
  DECLARE @SUCCESSCOUNT INT, @NEXTID INT;              
  DECLARE @TODAY DATETIME = GETUTCDATE();             
  DECLARE  @ERRORMESSAGE NVARCHAR(256);            
              
  BEGIN TRY              
  BEGIN TRAN            
  /* Liability Data */              
  SELECT               
    ROW_NUMBER() OVER (ORDER BY CUSTOMOBJECTID) AS ROWINDEX,              
    LT.LIABILITYID              
  INTO #LIAIDTEMP              
  FROM LIABILITY LT              
  WHERE LT.OWNERID = 985              
   AND LT.LAYOUTID IN (10204064,10204065)              
   AND LT.RelatedToId = @ORIGINALAPPLICATIONID;              
                
  SET @SUCCESSCOUNT = @@ROWCOUNT;              
              
  /* GENERATING NEW LIABILITY ID'S FOR TO BE CLONED RECORDS */                   
  EXEC GETNEXTIDBLOCK 985, 471, @SUCCESSCOUNT, @NEXTID OUT;              
              
  /* INSERTING DATA INTO LIABILITY TABLES */               
  INSERT INTO LIABILITY(OWNERID, LIABILITYID,              
 CUSTOMOBJECTID,DETAIL,ASSIGNTO,PRODUCTID,LOANAMOUNT,EMIAMOUNT,              
 STATUSCODEID,STATUSID,RELATEDTOTYPEID,RELATEDTOID,CREATEDBY,CREATEDON,LASTMODIFIEDBY,LASTMODIFIEDON,              
 TOTALINSTALLMENTS,INSTALLMENTSPAID,BALANCEINSTALLMENT,BOUNCES,PRINCIPALOUTSTANDING,LOANACCOUNTNUMBER,              
 SOURCEID,TYPEID,ASSIGNTONAME,PRODUCTNAME,STATUSCODE,RELATEDTONAME,SOURCENAME,[TYPE],[STATUS],[SUBJECT],ASSIGNTOID,              
 LAYOUTID,PROCESSID,CREATEDBYTYPE,LASTMODIFIEDBYTYPE,PREVIOUSSTATUSCODEID,STATUSCODECHANGEDON,IMPORTCYCLEID,UNIQUEID,              
 ACCOUNTOPENINGDATE,LASTPAYMENTDATE,DATEOFENQUIRY,OWNERSHIPTYPE,ENQUIRYAMOUNT,OWNERSHIPTYPEID,BALANCETENURE,              
 FINANCIERNAME,LOANCLOSINGDATE,ENQUIRYPURPOSE,ENQUIRYPURPOSEID,RELATEDTOTYPENAME              
  )               
   SELECT LT.OWNERID, V1.ROWINDEX + @NEXTID,LT.CUSTOMOBJECTID,LT.DETAIL,LT.ASSIGNTO,LT.PRODUCTID,LT.LOANAMOUNT,LT.EMIAMOUNT,              
 5099/*draft*/,STATUSID,RELATEDTOTYPEID,@NEWAPPLICATIONID,CREATEDBY,CREATEDON,LASTMODIFIEDBY,LASTMODIFIEDON,              
 TOTALINSTALLMENTS,INSTALLMENTSPAID,BALANCEINSTALLMENT,BOUNCES,PRINCIPALOUTSTANDING,LOANACCOUNTNUMBER,              
 SOURCEID,TYPEID,ASSIGNTONAME,PRODUCTNAME,STATUSCODE,RELATEDTONAME,SOURCENAME,[TYPE],[STATUS],[SUBJECT],ASSIGNTOID,              
 LAYOUTID,PROCESSID,CREATEDBYTYPE,LASTMODIFIEDBYTYPE,PREVIOUSSTATUSCODEID,STATUSCODECHANGEDON,IMPORTCYCLEID,UNIQUEID,              
 ACCOUNTOPENINGDATE,LASTPAYMENTDATE,DATEOFENQUIRY,OWNERSHIPTYPE,ENQUIRYAMOUNT,OWNERSHIPTYPEID,BALANCETENURE,              
 FINANCIERNAME,LOANCLOSINGDATE,ENQUIRYPURPOSE,ENQUIRYPURPOSEID,RELATEDTOTYPENAME              
  FROM LIABILITY LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIABILITYID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
              
  /* INSERTING DATA INTO LIABILITY EXTENSION TABLES 1*/              
  INSERT INTO LIA_EX1(OWNERID,LIA_EX1_ID,              
   LIA_EX1_1,LIA_EX1_2,LIA_EX1_3,LIA_EX1_4,LIA_EX1_5,LIA_EX1_6,LIA_EX1_7,LIA_EX1_8,LIA_EX1_9,LIA_EX1_10,              
   LIA_EX1_11,LIA_EX1_12,LIA_EX1_13,LIA_EX1_14,LIA_EX1_15,LIA_EX1_16,LIA_EX1_17,LIA_EX1_18,LIA_EX1_19,LIA_EX1_20,              
   LIA_EX1_21,LIA_EX1_22,LIA_EX1_23,LIA_EX1_24,LIA_EX1_25,LIA_EX1_26,LIA_EX1_27,LIA_EX1_28,LIA_EX1_29,LIA_EX1_30,              
   LIA_EX1_31,LIA_EX1_32,LIA_EX1_33,LIA_EX1_34,LIA_EX1_35,LIA_EX1_36,LIA_EX1_37,LIA_EX1_38,LIA_EX1_39,LIA_EX1_40,   
   LIA_EX1_41,LIA_EX1_42,LIA_EX1_43,LIA_EX1_44,LIA_EX1_45,LIA_EX1_46,LIA_EX1_47,LIA_EX1_48,LIA_EX1_49,LIA_EX1_50,              
   LIA_EX1_51,LIA_EX1_52,LIA_EX1_53,LIA_EX1_54,LIA_EX1_55,LIA_EX1_56,LIA_EX1_57,LIA_EX1_58,LIA_EX1_59,LIA_EX1_60,              
   LIA_EX1_61,LIA_EX1_62,LIA_EX1_63,LIA_EX1_64,LIA_EX1_65,LIA_EX1_66,LIA_EX1_67,LIA_EX1_68,LIA_EX1_69,LIA_EX1_70,              
   LIA_EX1_71,LIA_EX1_72,LIA_EX1_73,LIA_EX1_74,LIA_EX1_75,LIA_EX1_76,LIA_EX1_77,LIA_EX1_78,LIA_EX1_79,LIA_EX1_80,           
   LIA_EX1_81,LIA_EX1_82,LIA_EX1_83,LIA_EX1_84,LIA_EX1_85,LIA_EX1_86,LIA_EX1_87,LIA_EX1_88,LIA_EX1_89,LIA_EX1_90,              
   LIA_EX1_91,LIA_EX1_92,LIA_EX1_93,LIA_EX1_94,LIA_EX1_95,LIA_EX1_96,LIA_EX1_97,LIA_EX1_98,LIA_EX1_99,LIA_EX1_100)               
   SELECT OWNERID, V1.ROWINDEX + @NEXTID,              
   LT.LIA_EX1_1,LT.LIA_EX1_2,LT.LIA_EX1_3,LT.LIA_EX1_4,LT.LIA_EX1_5,LT.LIA_EX1_6,LT.LIA_EX1_7,LT.LIA_EX1_8,LT.LIA_EX1_9,LT.LIA_EX1_10,              
   LT.LIA_EX1_11,LT.LIA_EX1_12,LT.LIA_EX1_13,'Not Applicable'/*LIA_EX1_14*/,LT.LIA_EX1_15,LT.LIA_EX1_16,LT.LIA_EX1_17,LT.LIA_EX1_18,LT.LIA_EX1_19,LT.LIA_EX1_20,              
   LT.LIA_EX1_21,LT.LIA_EX1_22,LT.LIA_EX1_23,LT.LIA_EX1_24,LT.LIA_EX1_25,LT.LIA_EX1_26,LT.LIA_EX1_27,LT.LIA_EX1_28,LT.LIA_EX1_29,LT.LIA_EX1_30,              
   LT.LIA_EX1_31,LT.LIA_EX1_32,LT.LIA_EX1_33,LT.LIA_EX1_34,LT.LIA_EX1_35,LT.LIA_EX1_36,LT.LIA_EX1_37,LT.LIA_EX1_38,LT.LIA_EX1_39,LT.LIA_EX1_40,              
   LT.LIA_EX1_41,LT.LIA_EX1_42,LT.LIA_EX1_43,LT.LIA_EX1_44,LT.LIA_EX1_45,LT.LIA_EX1_46,LT.LIA_EX1_47,LT.LIA_EX1_48,LT.LIA_EX1_49,LT.LIA_EX1_50,              
   LT.LIA_EX1_51,LT.LIA_EX1_52,LT.LIA_EX1_53,LT.LIA_EX1_54,LT.LIA_EX1_55,LT.LIA_EX1_56,LT.LIA_EX1_57,LT.LIA_EX1_58,LT.LIA_EX1_59,LT.LIA_EX1_60,              
   LT.LIA_EX1_61,LT.LIA_EX1_62,LT.LIA_EX1_63,LT.LIA_EX1_64,LT.LIA_EX1_65,LT.LIA_EX1_66,LT.LIA_EX1_67,LT.LIA_EX1_68,LT.LIA_EX1_69,LT.LIA_EX1_70,              
   LT.LIA_EX1_71,LT.LIA_EX1_72,LT.LIA_EX1_73,LT.LIA_EX1_74,LT.LIA_EX1_75,LT.LIA_EX1_76,LT.LIA_EX1_77,LT.LIA_EX1_78,LT.LIA_EX1_79,LT.LIA_EX1_80,              
   LT.LIA_EX1_81,LT.LIA_EX1_82,LT.LIA_EX1_83,LT.LIA_EX1_84,LT.LIA_EX1_85,LT.LIA_EX1_86,LT.LIA_EX1_87,LT.LIA_EX1_88,LT.LIA_EX1_89,LT.LIA_EX1_90,              
   LT.LIA_EX1_91,LT.LIA_EX1_92,LT.LIA_EX1_93,LT.LIA_EX1_94,LT.LIA_EX1_95,LT.LIA_EX1_96,LT.LIA_EX1_97,LT.LIA_EX1_98,LT.LIA_EX1_99,LT.LIA_EX1_100              
  FROM LIA_EX1 LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIA_EX1_ID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
                
              
  /* INSERTING DATA INTO LIABILITY EXTENSION TABLES 2*/              
  INSERT INTO LIA_EX2(OWNERID,LIA_EX2_ID,              
   LIA_EX2_1,LIA_EX2_2,LIA_EX2_3,LIA_EX2_4,LIA_EX2_5,LIA_EX2_6,LIA_EX2_7,LIA_EX2_8,LIA_EX2_9,LIA_EX2_10,              
   LIA_EX2_11,LIA_EX2_12,LIA_EX2_13,LIA_EX2_14,LIA_EX2_15,LIA_EX2_16,LIA_EX2_17,LIA_EX2_18,LIA_EX2_19,LIA_EX2_20,              
   LIA_EX2_21,LIA_EX2_22,LIA_EX2_23,LIA_EX2_24,LIA_EX2_25,LIA_EX2_26,LIA_EX2_27,LIA_EX2_28,LIA_EX2_29,LIA_EX2_30,              
   LIA_EX2_31,LIA_EX2_32,LIA_EX2_33,LIA_EX2_34,LIA_EX2_35,LIA_EX2_36,LIA_EX2_37,LIA_EX2_38,LIA_EX2_39,LIA_EX2_40,              
   LIA_EX2_41,LIA_EX2_42,LIA_EX2_43,LIA_EX2_44,LIA_EX2_45,LIA_EX2_46,LIA_EX2_47,LIA_EX2_48,LIA_EX2_49,LIA_EX2_50,              
   LIA_EX2_51,LIA_EX2_52,LIA_EX2_53,LIA_EX2_54,LIA_EX2_55,LIA_EX2_56,LIA_EX2_57,LIA_EX2_58,LIA_EX2_59,LIA_EX2_60,              
   LIA_EX2_61,LIA_EX2_62,LIA_EX2_63,LIA_EX2_64,LIA_EX2_65,LIA_EX2_66,LIA_EX2_67,LIA_EX2_68,LIA_EX2_69,LIA_EX2_70,              
   LIA_EX2_71,LIA_EX2_72,LIA_EX2_73,LIA_EX2_74,LIA_EX2_75,LIA_EX2_76,LIA_EX2_77,LIA_EX2_78,LIA_EX2_79,LIA_EX2_80,              
   LIA_EX2_81,LIA_EX2_82,LIA_EX2_83,LIA_EX2_84,LIA_EX2_85,LIA_EX2_86,LIA_EX2_87,LIA_EX2_88,LIA_EX2_89,LIA_EX2_90,              
   LIA_EX2_91,LIA_EX2_92,LIA_EX2_93,LIA_EX2_94,LIA_EX2_95,LIA_EX2_96,LIA_EX2_97,LIA_EX2_98,LIA_EX2_99,LIA_EX2_100)            
   SELECT OWNERID, V1.ROWINDEX + @NEXTID,              
   LT.LIA_EX2_1,LT.LIA_EX2_2,LT.LIA_EX2_3,LT.LIA_EX2_4,LT.LIA_EX2_5,LT.LIA_EX2_6,LT.LIA_EX2_7,LT.LIA_EX2_8,LT.LIA_EX2_9,LT.LIA_EX2_10,            
   LT.LIA_EX2_11,LT.LIA_EX2_12,LT.LIA_EX2_13,LT.LIA_EX2_14,LT.LIA_EX2_15,LT.LIA_EX2_16,LT.LIA_EX2_17,LT.LIA_EX2_18,LT.LIA_EX2_19,LT.LIA_EX2_20,              
   LT.LIA_EX2_21,LT.LIA_EX2_22,LT.LIA_EX2_23,LT.LIA_EX2_24,LT.LIA_EX2_25,LT.LIA_EX2_26,LT.LIA_EX2_27,LT.LIA_EX2_28,LT.LIA_EX2_29,LT.LIA_EX2_30,              
   LT.LIA_EX2_31,LT.LIA_EX2_32,LT.LIA_EX2_33,LT.LIA_EX2_34,LT.LIA_EX2_35,LT.LIA_EX2_36,LT.LIA_EX2_37,LT.LIA_EX2_38,LT.LIA_EX2_39,LT.LIA_EX2_40,              
   LT.LIA_EX2_41,LT.LIA_EX2_42,LT.LIA_EX2_43,LT.LIA_EX2_44,LT.LIA_EX2_45,LT.LIA_EX2_46,LT.LIA_EX2_47,LT.LIA_EX2_48,LT.LIA_EX2_49,LT.LIA_EX2_50,              
   LT.LIA_EX2_51,LT.LIA_EX2_52,LT.LIA_EX2_53,LT.LIA_EX2_54,LT.LIA_EX2_55,LT.LIA_EX2_56,LT.LIA_EX2_57,LT.LIA_EX2_58,LT.LIA_EX2_59,LT.LIA_EX2_60,              
   LT.LIA_EX2_61,LT.LIA_EX2_62,LT.LIA_EX2_63,LT.LIA_EX2_64,LT.LIA_EX2_65,LT.LIA_EX2_66,LT.LIA_EX2_67,LT.LIA_EX2_68,LT.LIA_EX2_69,LT.LIA_EX2_70,              
   LT.LIA_EX2_71,LT.LIA_EX2_72,LT.LIA_EX2_73,LT.LIA_EX2_74,LT.LIA_EX2_75,LT.LIA_EX2_76,LT.LIA_EX2_77,LT.LIA_EX2_78,LT.LIA_EX2_79,LT.LIA_EX2_80,              
   LT.LIA_EX2_81,LT.LIA_EX2_82,LT.LIA_EX2_83,LT.LIA_EX2_84,LT.LIA_EX2_85,LT.LIA_EX2_86,LT.LIA_EX2_87,LT.LIA_EX2_88,LT.LIA_EX2_89,LT.LIA_EX2_90,              
   LT.LIA_EX2_91,LT.LIA_EX2_92,LT.LIA_EX2_93,LT.LIA_EX2_94,LT.LIA_EX2_95,LT.LIA_EX2_96,LT.LIA_EX2_97,LT.LIA_EX2_98,LT.LIA_EX2_99,LT.LIA_EX2_100              
  FROM LIA_EX2 LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIA_EX2_ID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
                
              
  /* INSERTING DATA INTO LIABILITY EXTENSION TABLES 3*/              
  INSERT INTO LIA_EX3(OWNERID,LIA_EX3_ID,              
   LIA_EX3_1,LIA_EX3_2,LIA_EX3_3,LIA_EX3_4,LIA_EX3_5,LIA_EX3_6,LIA_EX3_7,LIA_EX3_8,LIA_EX3_9,LIA_EX3_10,              
   LIA_EX3_11,LIA_EX3_12,LIA_EX3_13,LIA_EX3_14,LIA_EX3_15,LIA_EX3_16,LIA_EX3_17,LIA_EX3_18,LIA_EX3_19,LIA_EX3_20,              
   LIA_EX3_21,LIA_EX3_22,LIA_EX3_23,LIA_EX3_24,LIA_EX3_25,LIA_EX3_26,LIA_EX3_27,LIA_EX3_28,LIA_EX3_29,LIA_EX3_30,              
   LIA_EX3_31,LIA_EX3_32,LIA_EX3_33,LIA_EX3_34,LIA_EX3_35,LIA_EX3_36,LIA_EX3_37,LIA_EX3_38,LIA_EX3_39,LIA_EX3_40,              
   LIA_EX3_41,LIA_EX3_42,LIA_EX3_43,LIA_EX3_44,LIA_EX3_45,LIA_EX3_46,LIA_EX3_47,LIA_EX3_48,LIA_EX3_49,LIA_EX3_50,              
   LIA_EX3_51,LIA_EX3_52,LIA_EX3_53,LIA_EX3_54,LIA_EX3_55,LIA_EX3_56,LIA_EX3_57,LIA_EX3_58,LIA_EX3_59,LIA_EX3_60,              
   LIA_EX3_61,LIA_EX3_62,LIA_EX3_63,LIA_EX3_64,LIA_EX3_65,LIA_EX3_66,LIA_EX3_67,LIA_EX3_68,LIA_EX3_69,LIA_EX3_70,              
   LIA_EX3_71,LIA_EX3_72,LIA_EX3_73,LIA_EX3_74,LIA_EX3_75,LIA_EX3_76,LIA_EX3_77,LIA_EX3_78,LIA_EX3_79,LIA_EX3_80,              
   LIA_EX3_81,LIA_EX3_82,LIA_EX3_83,LIA_EX3_84,LIA_EX3_85,LIA_EX3_86,LIA_EX3_87,LIA_EX3_88,LIA_EX3_89,LIA_EX3_90,              
   LIA_EX3_91,LIA_EX3_92,LIA_EX3_93,LIA_EX3_94,LIA_EX3_95,LIA_EX3_96,LIA_EX3_97,LIA_EX3_98,LIA_EX3_99,LIA_EX3_100)               
   SELECT OWNERID, V1.ROWINDEX + @NEXTID,              
   LT.LIA_EX3_1,LT.LIA_EX3_2,LT.LIA_EX3_3,LT.LIA_EX3_4,LT.LIA_EX3_5,LT.LIA_EX3_6,LT.LIA_EX3_7,LT.LIA_EX3_8,LT.LIA_EX3_9,LT.LIA_EX3_10,              
   LT.LIA_EX3_11,LT.LIA_EX3_12,LT.LIA_EX3_13,LT.LIA_EX3_14,LT.LIA_EX3_15,LT.LIA_EX3_16,LT.LIA_EX3_17,LT.LIA_EX3_18,LT.LIA_EX3_19,LT.LIA_EX3_20,              
   LT.LIA_EX3_21,LT.LIA_EX3_22,LT.LIA_EX3_23,LT.LIA_EX3_24,LT.LIA_EX3_25,LT.LIA_EX3_26,LT.LIA_EX3_27,LT.LIA_EX3_28,LT.LIA_EX3_29,LT.LIA_EX3_30,              
   LT.LIA_EX3_31,LT.LIA_EX3_32,LT.LIA_EX3_33,LT.LIA_EX3_34,LT.LIA_EX3_35,LT.LIA_EX3_36,LT.LIA_EX3_37,LT.LIA_EX3_38,LT.LIA_EX3_39,LT.LIA_EX3_40,              
   LT.LIA_EX3_41,LT.LIA_EX3_42,LT.LIA_EX3_43,LT.LIA_EX3_44,LT.LIA_EX3_45,LT.LIA_EX3_46,LT.LIA_EX3_47,LT.LIA_EX3_48,LT.LIA_EX3_49,LT.LIA_EX3_50,              
   LT.LIA_EX3_51,LT.LIA_EX3_52,LT.LIA_EX3_53,LT.LIA_EX3_54,LT.LIA_EX3_55,LT.LIA_EX3_56,LT.LIA_EX3_57,LT.LIA_EX3_58,LT.LIA_EX3_59,LT.LIA_EX3_60,              
   LT.LIA_EX3_61,LT.LIA_EX3_62,LT.LIA_EX3_63,LT.LIA_EX3_64,LT.LIA_EX3_65,LT.LIA_EX3_66,LT.LIA_EX3_67,LT.LIA_EX3_68,LT.LIA_EX3_69,LT.LIA_EX3_70,              
   LT.LIA_EX3_71,LT.LIA_EX3_72,LT.LIA_EX3_73,LT.LIA_EX3_74,LT.LIA_EX3_75,LT.LIA_EX3_76,LT.LIA_EX3_77,LT.LIA_EX3_78,LT.LIA_EX3_79,LT.LIA_EX3_80,              
   LT.LIA_EX3_81,LT.LIA_EX3_82,LT.LIA_EX3_83,LT.LIA_EX3_84,LT.LIA_EX3_85,LT.LIA_EX3_86,LT.LIA_EX3_87,LT.LIA_EX3_88,LT.LIA_EX3_89,LT.LIA_EX3_90,              
   LT.LIA_EX3_91,LT.LIA_EX3_92,LT.LIA_EX3_93,LT.LIA_EX3_94,LT.LIA_EX3_95,LT.LIA_EX3_96,LT.LIA_EX3_97,LT.LIA_EX3_98,LT.LIA_EX3_99,LT.LIA_EX3_100              
  FROM LIA_EX3 LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIA_EX3_ID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
               
              
  /* INSERTING DATA INTO LIABILITY EXTENSION TABLES 4*/              
  INSERT INTO LIA_EX4(OWNERID,LIA_EX4_ID,              
   LIA_EX4_1,LIA_EX4_2,LIA_EX4_3,LIA_EX4_4,LIA_EX4_5,LIA_EX4_6,LIA_EX4_7,LIA_EX4_8,LIA_EX4_9,LIA_EX4_10,              
   LIA_EX4_11,LIA_EX4_12,LIA_EX4_13,LIA_EX4_14,LIA_EX4_15,LIA_EX4_16,LIA_EX4_17,LIA_EX4_18,LIA_EX4_19,LIA_EX4_20,              
   LIA_EX4_21,LIA_EX4_22,LIA_EX4_23,LIA_EX4_24,LIA_EX4_25,LIA_EX4_26,LIA_EX4_27,LIA_EX4_28,LIA_EX4_29,LIA_EX4_30,              
   LIA_EX4_31,LIA_EX4_32,LIA_EX4_33,LIA_EX4_34,LIA_EX4_35,LIA_EX4_36,LIA_EX4_37,LIA_EX4_38,LIA_EX4_39,LIA_EX4_40,              
   LIA_EX4_41,LIA_EX4_42,LIA_EX4_43,LIA_EX4_44,LIA_EX4_45,LIA_EX4_46,LIA_EX4_47,LIA_EX4_48,LIA_EX4_49,LIA_EX4_50,              
   LIA_EX4_51,LIA_EX4_52,LIA_EX4_53,LIA_EX4_54,LIA_EX4_55,LIA_EX4_56,LIA_EX4_57,LIA_EX4_58,LIA_EX4_59,LIA_EX4_60,              
   LIA_EX4_61,LIA_EX4_62,LIA_EX4_63,LIA_EX4_64,LIA_EX4_65,LIA_EX4_66,LIA_EX4_67,LIA_EX4_68,LIA_EX4_69,LIA_EX4_70,              
   LIA_EX4_71,LIA_EX4_72,LIA_EX4_73,LIA_EX4_74,LIA_EX4_75,LIA_EX4_76,LIA_EX4_77,LIA_EX4_78,LIA_EX4_79,LIA_EX4_80,              
   LIA_EX4_81,LIA_EX4_82,LIA_EX4_83,LIA_EX4_84,LIA_EX4_85,LIA_EX4_86,LIA_EX4_87,LIA_EX4_88,LIA_EX4_89,LIA_EX4_90,              
   LIA_EX4_91,LIA_EX4_92,LIA_EX4_93,LIA_EX4_94,LIA_EX4_95,LIA_EX4_96,LIA_EX4_97,LIA_EX4_98,LIA_EX4_99,LIA_EX4_100)               
   SELECT OWNERID, V1.ROWINDEX + @NEXTID,              
   LT.LIA_EX4_1,LT.LIA_EX4_2,LT.LIA_EX4_3,LT.LIA_EX4_4,LT.LIA_EX4_5,LT.LIA_EX4_6,LT.LIA_EX4_7,LT.LIA_EX4_8,LT.LIA_EX4_9,LT.LIA_EX4_10,              
   LT.LIA_EX4_11,LT.LIA_EX4_12,LT.LIA_EX4_13,LT.LIA_EX4_14,LT.LIA_EX4_15,LT.LIA_EX4_16,LT.LIA_EX4_17,LT.LIA_EX4_18,LT.LIA_EX4_19,LT.LIA_EX4_20,              
   LT.LIA_EX4_21,LT.LIA_EX4_22,LT.LIA_EX4_23,LT.LIA_EX4_24,LT.LIA_EX4_25,LT.LIA_EX4_26,LT.LIA_EX4_27,LT.LIA_EX4_28,LT.LIA_EX4_29,LT.LIA_EX4_30,              
   LT.LIA_EX4_31,LT.LIA_EX4_32,LT.LIA_EX4_33,LT.LIA_EX4_34,LT.LIA_EX4_35,LT.LIA_EX4_36,LT.LIA_EX4_37,LT.LIA_EX4_38,LT.LIA_EX4_39,LT.LIA_EX4_40,              
   LT.LIA_EX4_41,LT.LIA_EX4_42,LT.LIA_EX4_43,LT.LIA_EX4_44,LT.LIA_EX4_45,LT.LIA_EX4_46,LT.LIA_EX4_47,LT.LIA_EX4_48,LT.LIA_EX4_49,LT.LIA_EX4_50,              
   LT.LIA_EX4_51,LT.LIA_EX4_52,LT.LIA_EX4_53,LT.LIA_EX4_54,LT.LIA_EX4_55,LT.LIA_EX4_56,LT.LIA_EX4_57,LT.LIA_EX4_58,LT.LIA_EX4_59,LT.LIA_EX4_60,              
   LT.LIA_EX4_61,LT.LIA_EX4_62,LT.LIA_EX4_63,LT.LIA_EX4_64,LT.LIA_EX4_65,LT.LIA_EX4_66,LT.LIA_EX4_67,LT.LIA_EX4_68,LT.LIA_EX4_69,LT.LIA_EX4_70,              
   LT.LIA_EX4_71,LT.LIA_EX4_72,LT.LIA_EX4_73,LT.LIA_EX4_74,LT.LIA_EX4_75,LT.LIA_EX4_76,LT.LIA_EX4_77,LT.LIA_EX4_78,LT.LIA_EX4_79,LT.LIA_EX4_80,              
   LT.LIA_EX4_81,LT.LIA_EX4_82,LT.LIA_EX4_83,LT.LIA_EX4_84,LT.LIA_EX4_85,LT.LIA_EX4_86,LT.LIA_EX4_87,LT.LIA_EX4_88,LT.LIA_EX4_89,LT.LIA_EX4_90,              
   LT.LIA_EX4_91,LT.LIA_EX4_92,LT.LIA_EX4_93,LT.LIA_EX4_94,LT.LIA_EX4_95,LT.LIA_EX4_96,LT.LIA_EX4_97,LT.LIA_EX4_98,LT.LIA_EX4_99,LT.LIA_EX4_100              
  FROM LIA_EX4 LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIA_EX4_ID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
              
  /* INSERTING DATA INTO LIABILITY EXTENSION TABLES 5*/              
  INSERT INTO LIA_EX5(OWNERID,LIA_EX5_ID,              
   LIA_EX5_1,LIA_EX5_2,LIA_EX5_3,LIA_EX5_4,LIA_EX5_5,LIA_EX5_6,LIA_EX5_7,LIA_EX5_8,LIA_EX5_9,LIA_EX5_10,              
   LIA_EX5_11,LIA_EX5_12,LIA_EX5_13,LIA_EX5_14,LIA_EX5_15,LIA_EX5_16,LIA_EX5_17,LIA_EX5_18,LIA_EX5_19,LIA_EX5_20,              
   LIA_EX5_21,LIA_EX5_22,LIA_EX5_23,LIA_EX5_24,LIA_EX5_25,LIA_EX5_26,LIA_EX5_27,LIA_EX5_28,LIA_EX5_29,LIA_EX5_30,              
   LIA_EX5_31,LIA_EX5_32,LIA_EX5_33,LIA_EX5_34,LIA_EX5_35,LIA_EX5_36,LIA_EX5_37,LIA_EX5_38,LIA_EX5_39,LIA_EX5_40,              
   LIA_EX5_41,LIA_EX5_42,LIA_EX5_43,LIA_EX5_44,LIA_EX5_45,LIA_EX5_46,LIA_EX5_47,LIA_EX5_48,LIA_EX5_49,LIA_EX5_50,              
   LIA_EX5_51,LIA_EX5_52,LIA_EX5_53,LIA_EX5_54,LIA_EX5_55,LIA_EX5_56,LIA_EX5_57,LIA_EX5_58,LIA_EX5_59,LIA_EX5_60,              
   LIA_EX5_61,LIA_EX5_62,LIA_EX5_63,LIA_EX5_64,LIA_EX5_65,LIA_EX5_66,LIA_EX5_67,LIA_EX5_68,LIA_EX5_69,LIA_EX5_70,              
   LIA_EX5_71,LIA_EX5_72,LIA_EX5_73,LIA_EX5_74,LIA_EX5_75,LIA_EX5_76,LIA_EX5_77,LIA_EX5_78,LIA_EX5_79,LIA_EX5_80,              
   LIA_EX5_81,LIA_EX5_82,LIA_EX5_83,LIA_EX5_84,LIA_EX5_85,LIA_EX5_86,LIA_EX5_87,LIA_EX5_88,LIA_EX5_89,LIA_EX5_90,              
   LIA_EX5_91,LIA_EX5_92,LIA_EX5_93,LIA_EX5_94,LIA_EX5_95,LIA_EX5_96,LIA_EX5_97,LIA_EX5_98,LIA_EX5_99,LIA_EX5_100)               
   SELECT OWNERID, V1.ROWINDEX + @NEXTID,              
   LT.LIA_EX5_1,LT.LIA_EX5_2,LT.LIA_EX5_3,LT.LIA_EX5_4,LT.LIA_EX5_5,LT.LIA_EX5_6,LT.LIA_EX5_7,LT.LIA_EX5_8,LT.LIA_EX5_9,LT.LIA_EX5_10,              
   LT.LIA_EX5_11,LT.LIA_EX5_12,LT.LIA_EX5_13,LT.LIA_EX5_14,LT.LIA_EX5_15,LT.LIA_EX5_16,LT.LIA_EX5_17,LT.LIA_EX5_18,LT.LIA_EX5_19,LT.LIA_EX5_20,              
   LT.LIA_EX5_21,LT.LIA_EX5_22,LT.LIA_EX5_23,LT.LIA_EX5_24,LT.LIA_EX5_25,LT.LIA_EX5_26,LT.LIA_EX5_27,LT.LIA_EX5_28,LT.LIA_EX5_29,LT.LIA_EX5_30,              
   LT.LIA_EX5_31,LT.LIA_EX5_32,LT.LIA_EX5_33,LT.LIA_EX5_34,LT.LIA_EX5_35,LT.LIA_EX5_36,LT.LIA_EX5_37,LT.LIA_EX5_38,LT.LIA_EX5_39,LT.LIA_EX5_40,              
   LT.LIA_EX5_41,LT.LIA_EX5_42,LT.LIA_EX5_43,LT.LIA_EX5_44,LT.LIA_EX5_45,LT.LIA_EX5_46,LT.LIA_EX5_47,LT.LIA_EX5_48,LT.LIA_EX5_49,LT.LIA_EX5_50,              
   LT.LIA_EX5_51,LT.LIA_EX5_52,LT.LIA_EX5_53,LT.LIA_EX5_54,LT.LIA_EX5_55,LT.LIA_EX5_56,LT.LIA_EX5_57,LT.LIA_EX5_58,LT.LIA_EX5_59,LT.LIA_EX5_60,              
   LT.LIA_EX5_61,LT.LIA_EX5_62,LT.LIA_EX5_63,LT.LIA_EX5_64,LT.LIA_EX5_65,LT.LIA_EX5_66,LT.LIA_EX5_67,LT.LIA_EX5_68,LT.LIA_EX5_69,LT.LIA_EX5_70,              
   LT.LIA_EX5_71,LT.LIA_EX5_72,LT.LIA_EX5_73,LT.LIA_EX5_74,LT.LIA_EX5_75,LT.LIA_EX5_76,LT.LIA_EX5_77,LT.LIA_EX5_78,LT.LIA_EX5_79,LT.LIA_EX5_80,              
   LT.LIA_EX5_81,LT.LIA_EX5_82,LT.LIA_EX5_83,LT.LIA_EX5_84,LT.LIA_EX5_85,LT.LIA_EX5_86,LT.LIA_EX5_87,LT.LIA_EX5_88,LT.LIA_EX5_89,LT.LIA_EX5_90,              
   LT.LIA_EX5_91,LT.LIA_EX5_92,LT.LIA_EX5_93,LT.LIA_EX5_94,LT.LIA_EX5_95,LT.LIA_EX5_96,LT.LIA_EX5_97,LT.LIA_EX5_98,LT.LIA_EX5_99,LT.LIA_EX5_100              
  FROM LIA_EX5 LT               
  INNER JOIN #LIAIDTEMP V1              
    ON  LT.OWNERID = 985              
 AND LT.LIA_EX5_ID = V1.LIABILITYID              
  WHERE LT.OWNERID = 985;              
  
  UPDATE IDLIST SET LASTID = (SELECT MAX(LIABILITYID) FROM Liability WHERE OWNERID = 985) WHERE OWNERID = 985 AND ITEMID = 471 /* LIABILITY OBJECT */                          
  
  --BEGIN            
  --THROW 99001, 'IN LIABILITY ERROR', 1;            
  --END;            
            
  COMMIT;            
  END TRY                      
  BEGIN CATCH            
  ROLLBACK;            
            
  SELECT @ERRORMESSAGE = SUBSTRING(ERROR_MESSAGE(), 0, 255);            
  INSERT INTO MPI_CLONE_LOG VALUES(@TODAY,@USERID,@ERRORMESSAGE,'Log for Liability insertion')            
  BEGIN            
  THROW 99001, @ERRORMESSAGE, 1;            
  END;            
         
  END CATCH              
            
END;

CREATE    PROC [dbo].[MPI_CLONE_DELETE_FA_WHEN_ERROR] (@FA_ID INT) AS      
/*      
  Created On: 30-May-2024; Created By: Prateek Pathre;      
  Details: delete FA when there is an Error      
*/      
BEGIN      
  DELETE AM FROM ATTACHMENTMASTER AM  
  INNER JOIN VERIFICATION V ON V.OWNERID = AM.OWNERID AND AM.ITEMID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE AM FROM ATTACHMENTMASTER AM  
  INNER JOIN APPLICATION A ON A.OWNERID = AM.OWNERID AND A.APPLICATIONID = AM.ITEMID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L1 FROM LIA_EX1 L1  
  INNER JOIN LIABILITY L ON L1.OWNERID = L.OWNERID AND L.LIABILITYID = L1.LIA_EX1_ID   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L2 FROM LIA_EX2 L2  
  INNER JOIN LIABILITY L ON L2.OWNERID = L.OWNERID AND L.LIABILITYID = L2.LIA_EX2_ID   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L3 FROM LIA_EX3 L3  
  INNER JOIN LIABILITY L ON L3.OWNERID = L.OWNERID AND L.LIABILITYID = L3.LIA_EX3_ID   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L4 FROM LIA_EX4 L4  
  INNER JOIN LIABILITY L ON L4.OWNERID = L.OWNERID AND L.LIABILITYID = L4.LIA_EX4_ID   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L5 FROM LIA_EX5 L5  
  INNER JOIN LIABILITY L ON L5.OWNERID = L.OWNERID AND L.LIABILITYID = L5.LIA_EX5_ID   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE L FROM LIABILITY L   
  INNER JOIN APPLICATION A ON A.OWNERID = L.OWNERID AND A.APPLICATIONID = L.RELATEDTOID  
  WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE V1 FROM VER_EX1 V1   
  INNER JOIN VERIFICATION V ON V1.OWNERID = V.OWNERID AND V1.VER_EX1_ID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE V2 FROM VER_EX2 V2   
  INNER JOIN VERIFICATION V ON V2.OWNERID = V.OWNERID AND V2.VER_EX2_ID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE V3 FROM VER_EX3 V3  
  INNER JOIN VERIFICATION V ON V3.OWNERID = V.OWNERID AND V3.VER_EX3_ID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE V4 FROM VER_EX4 V4   
  INNER JOIN VERIFICATION V ON V4.OWNERID = V.OWNERID AND V4.VER_EX4_ID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE V5 FROM VER_EX5 V5   
  INNER JOIN VERIFICATION V ON V5.OWNERID = V.OWNERID AND V5.VER_EX5_ID = V.CUSTOMOBJECTID  
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE V FROM VERIFICATION V   
  INNER JOIN APPLICATION A ON A.OWNERID = V.OWNERID AND A.APPLICATIONID = V.RELATEDTOID  
  WHERE V.OWNERID=985 AND A.RELATEDTOID = @FA_ID;  
  
  DELETE A1 FROM APL_EX1 A1   
  INNER JOIN APPLICATION APL ON APL.OWNERID = A1.OWNERID AND APL.APPLICATIONID = A1.APL_EX1_ID  
  WHERE APL.OWNERID = 985 AND APL.RELATEDTOID = @FA_ID;  
    
  DELETE A2 FROM APL_EX2 A2   
  INNER JOIN APPLICATION APL ON APL.OWNERID = A2.OWNERID AND APL.APPLICATIONID = A2.APL_EX2_ID  
  WHERE APL.OWNERID = 985 AND APL.RELATEDTOID = @FA_ID;  
  
  DELETE A3 FROM APL_EX3 A3   
  INNER JOIN APPLICATION APL ON APL.OWNERID = A3.OWNERID AND APL.APPLICATIONID = A3.APL_EX3_ID  
  WHERE APL.OWNERID = 985 AND APL.RELATEDTOID = @FA_ID;  
  
  DELETE A4 FROM APL_EX4 A4   
  INNER JOIN APPLICATION APL ON APL.OWNERID = A4.OWNERID AND APL.APPLICATIONID = A4.APL_EX4_ID  
  WHERE APL.OWNERID = 985 AND APL.RELATEDTOID = @FA_ID;  
  
  DELETE A5 FROM APL_EX5 A5  
  INNER JOIN APPLICATION APL ON APL.OWNERID = A5.OWNERID AND APL.APPLICATIONID = A5.APL_EX5_ID  
  WHERE APL.OWNERID = 985 AND APL.RELATEDTOID = @FA_ID;  
  
  DELETE A FROM APPLICATION A WHERE A.OWNERID = 985 AND A.RELATEDTOID = @FA_ID;  
    
  DELETE FROM FIA_EX1 WHERE OWNERID = 985 AND FIA_EX1_ID = @FA_ID  
  DELETE FROM FIA_EX2 WHERE OWNERID = 985 AND FIA_EX2_ID = @FA_ID  
  DELETE FROM FIA_EX3 WHERE OWNERID = 985 AND FIA_EX3_ID = @FA_ID  
  DELETE FROM FIA_EX4 WHERE OWNERID = 985 AND FIA_EX4_ID = @FA_ID  
  DELETE FROM FIA_EX5 WHERE OWNERID = 985 AND FIA_EX5_ID = @FA_ID  
    
  DELETE FROM FINANCIALAPPLICATION WHERE OWNERID = 985 AND CUSTOMOBJECTID = @FA_ID  
END;

CREATE PROCEDURE [dbo].[MPI_GET_CLONE_FINANCIAL_APPLICATION] (@FINANCIALAPPLICATION INT)  
/*  
 CREATED BY : ALI ASGAR BAJI; CREATED ON : 14.05.2024  
 DESC : GET THE FINANCIAL APPLICATION AND APPLICATION DETAILS FOR CLONNING  
 EXEC MPI_GET_CLONE_FINANCIAL_APPLICATION 102071;  
*/  
AS  
BEGIN   
   
 SELECT   
   A.APPLICATIONID AS APPLICATIONID,  
   A.APPLICATIONNAME AS APPLICATIONNAME,  
   DATEADD(MI, 480, A3.APL_EX3_34) AS DOB,  
   CASE WHEN A1.APL_EX1_53 = N'P' THEN N'Primary'  
  WHEN A1.APL_EX1_53 = N'C' THEN N'Co-Borrower'  
  WHEN A1.APL_EX1_53 = N'S' THEN N'Supporter'  
   END AS TYPE  
 FROM APPLICATION A  
 INNER JOIN APL_EX1 A1 ON A.OWNERID = A1.OWNERID AND A.APPLICATIONID = A1.APL_EX1_ID  
 INNER JOIN APL_EX3 A3 ON A.OWNERID = A3.OWNERID AND A.APPLICATIONID = A3.APL_EX3_ID  
 WHERE A.OWNERID=985 and A.RelatedToTypeID = 100286 AND A.RelatedToID = @FINANCIALAPPLICATION  
  
END ;

CREATE PROCEDURE [dbo].[MPI_GET_CLONE_FINANCIAL_APPLICATION] (@FINANCIALAPPLICATION INT)  
/*  
 CREATED BY : ALI ASGAR BAJI; CREATED ON : 14.05.2024  
 DESC : GET THE FINANCIAL APPLICATION AND APPLICATION DETAILS FOR CLONNING  
 EXEC MPI_GET_CLONE_FINANCIAL_APPLICATION 102071;  
*/  
AS  
BEGIN   
   
 SELECT   
   A.APPLICATIONID AS APPLICATIONID,  
   A.APPLICATIONNAME AS APPLICATIONNAME,  
   DATEADD(MI, 480, A3.APL_EX3_34) AS DOB,  
   CASE WHEN A1.APL_EX1_53 = N'P' THEN N'Primary'  
  WHEN A1.APL_EX1_53 = N'C' THEN N'Co-Borrower'  
  WHEN A1.APL_EX1_53 = N'S' THEN N'Supporter'  
   END AS TYPE  
 FROM APPLICATION A  
 INNER JOIN APL_EX1 A1 ON A.OWNERID = A1.OWNERID AND A.APPLICATIONID = A1.APL_EX1_ID  
 INNER JOIN APL_EX3 A3 ON A.OWNERID = A3.OWNERID AND A.APPLICATIONID = A3.APL_EX3_ID  
 WHERE A.OWNERID=985 and A.RelatedToTypeID = 100286 AND A.RelatedToID = @FINANCIALAPPLICATION  
  
END ;

CREATE   PROC MPI_GENERATE_LOAN_APP_REQUEST (@USERID INT,@ORIGINALID INT)     
AS    
/*    
  Created By : Pradyuman Sharma; Created On 22-May-24; Modified On: 23-May-24    
  Details : Create Auto Loan Creation Request;    
  MPI_GENERATE_LOAN_APP_REQUEST 0,102643    
*/    
BEGIN    
 DECLARE @ROLEID INT;  
 SELECT @ROLEID = CURRENTROLEID FROM PersonalSettings (NOLOCK) WHERE OwnerID=985 AND UserID = @USERID;  
  
 SELECT CONCAT(    
    N'[    
        {    
            "ItemType": "FinancialApplication",    
            "ProcessMode": "create",    
            "OutputFieldList": [    
                "customobjectid",    
                "STATUSCODEID",    
                "CREATEDON"    
            ],    
            "ObjectData": {    
    "LayoutId": "10204014",    
    "StatusCodeId": "100002",    
                "Fia_ex2_83":"', FIA_EX2_83, N'",    
                "Fia_ex2_47":"', FIA_EX2_47, N'",    
                "Fia_ex2_49":"', FIA_EX2_49, N'",    
                "Fia_ex2_46":"', CONVERT(VARCHAR(11),FIA_EX2_46,101), N'",    
                "Fia_ex1_28":"', FIA_EX1_28, N'",    
                "Fia_ex3_80":"', FIA_EX3_80, N'",    
                "Subject":"'   , SUBJECT   , N'",    
                "AssignedToId":"', @USERID, N'",    
    "CreatedBy":"', @USERID, N'",    
                "Fia_ex5_85":"', CASE WHEN @ROLEID IN (1006,1007) THEN (SELECT TOP 1 USERNAME FROM AZ_USER WHERE APPOWNERID = 985 AND USERID = @USERID)  
                   ELSE FIA_EX5_85 END, N'",    
                "Fia_ex4_18":"', FIA_EX4_18, N'", /*Borrower Type*/    
    "Fia_ex5_2":"',  FIA_EX5_2, N'", /*Customer Type*/    
                "Fia_ex5_9":"',  FIA_EX5_9, N'", /*Customer CIF*/    
    "Fia_ex1_9":"',  FIA_EX1_9, N'",    
    "Fia_ex1_20":"', FIA_EX1_20, N'",    
    "Fia_ex1_21":"', FIA_EX1_21, N'",    
    "Fia_ex1_22":"', FIA_EX1_22, N'",    
    "Fia_ex1_23":"', FIA_EX1_23, N'",    
    "Fia_ex1_24":"', FIA_EX1_24, N'",    
    "Fia_ex1_25":"', FIA_EX1_25, N'",    
    "Fia_ex1_33":"', FIA_EX1_33, N'",    
    "Fia_ex1_46":"', FIA_EX1_46, N'",  
    "Fia_ex1_47":"', FIA_EX1_47, N'",  
    "Fia_ex1_51":"', FIA_EX1_51, N'",    
    "Fia_ex1_52":"', FIA_EX1_52, N'",    
    "Fia_ex1_53":"', FIA_EX1_53, N'",    
    "Fia_ex1_54":"', FIA_EX1_54, N'",    
    "Fia_ex2_87":"', FIA_EX2_87, N'",    
    "Fia_ex2_88":"', FIA_EX2_88, N'",    
    "Fia_ex2_89":"', FIA_EX2_89, N'",    
    "Fia_ex2_90":"', FIA_EX2_90, N'",    
    "Fia_ex2_91":"', FIA_EX2_91, N'",    
    "Fia_ex2_92":"', FIA_EX2_92, N'",    
    "Fia_ex3_6":"',  FIA_EX3_6, N'",    
    "Fia_ex3_18":"', FIA_EX3_18, N'",    
    "Fia_ex3_20":"', FIA_EX3_20, N'",    
    "Fia_ex3_40":"', FIA_EX3_40, N'",        
    "Fia_ex3_41":"', FIA_EX3_41, N'",     
    "Fia_ex3_42":"', FIA_EX3_42, N'",     
    "Fia_ex3_43":"', FIA_EX3_43, N'",     
    "Fia_ex3_46":"', FIA_EX3_46, N'",     
    "Fia_ex3_47":"', FIA_EX3_47, N'",     
    "Fia_ex3_48":"', FIA_EX3_48, N'",     
    "Fia_ex3_50":"', FIA_EX3_50, N'",     
    "Fia_ex3_75":"', FIA_EX3_75, N'",     
    "Fia_ex3_76":"', FIA_EX3_76, N'",     
    "Fia_ex3_77":"', FIA_EX3_77, N'",     
    "Fia_ex3_78":"', FIA_EX3_78, N'",     
    "Fia_ex3_79":"', FIA_EX3_79, N'",     
    "Fia_ex3_86":"', FIA_EX3_86, N'",     
    "Fia_ex3_90":"', FIA_EX3_90, N'",     
    "Fia_ex3_93":"', FIA_EX3_93, N'",     
    "Fia_ex4_12":"', FIA_EX4_12, N'",     
    "Fia_ex4_39":"', FIA_EX4_39, N'",     
    "Fia_ex4_40":"', FIA_EX4_40, N'",     
    "Fia_ex4_41":"', FIA_EX4_41, N'",     
    "Fia_ex4_74":"', FIA_EX4_74, N'",     
    "Fia_ex4_77":"', FIA_EX4_77, N'",     
    "Fia_ex4_100":"', FIA_EX4_100, N'",     
    "Fia_ex5_10":"', FIA_EX5_10, N'",    
    "Fia_ex5_70":"', CASE WHEN @ROLEID IN (1008,1009) THEN (SELECT TOP 1 USERNAME FROM AZ_USER WHERE APPOWNERID = 985 AND USERID = @USERID)  
                      ELSE '' END, N'",    
    "Fia_ex5_71":"', FIA_EX5_71, N'",    
    "Fia_ex5_72":"', FIA_EX5_72, N'",         
    "Fia_ex5_86":"', FIA_EX5_86, N'",    
    "Fia_ex5_99":"', FIA_EX5_99, N'",    
    "Fia_ex2_42":"', FIA_EX2_42, N'",    
    "Fia_ex5_124":"', FIA_EX5_124, N'",    
    "Fia_ex5_125":"', FIA_EX5_125, N'",    
    "Fia_ex4_140":"', FIA_EX4_140, N'",    
            }    
        }    
    ]') AS REQUEST,    
   -1 AS REQUESTID    
   FROM FinancialApplication FA    
  INNER JOIN FIA_EX1 F1 ON FA.OWNERID = F1.OWNERID AND FA.CUSTOMOBJECTID = F1.FIA_EX1_ID    
  INNER JOIN FIA_EX2 F2 ON FA.OWNERID = F2.OWNERID AND FA.CUSTOMOBJECTID = F2.FIA_EX2_ID    
  INNER JOIN FIA_EX3 F3 ON FA.OWNERID = F3.OWNERID AND FA.CUSTOMOBJECTID = F3.FIA_EX3_ID    
  INNER JOIN FIA_EX4 F4 ON FA.OWNERID = F4.OWNERID AND FA.CUSTOMOBJECTID = F4.FIA_EX4_ID    
  INNER JOIN FIA_EX5 F5 ON FA.OWNERID = F5.OWNERID AND FA.CUSTOMOBJECTID = F5.FIA_EX5_ID    
 WHERE FA.CustomObjectId = @ORIGINALID;    
END;  