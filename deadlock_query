SELECT TOP 50
OBJECTNAME = OBJECT_SCHEMA_NAME(QT.OBJECTID,DBID) + '.' + OBJECT_NAME(QT.OBJECTID, QT.DBID),
STATEMENTTEXT = SUBSTRING(QT.TEXT, (QS.STATEMENT_START_OFFSET/2) + 1, 
((CASE STATEMENT_END_OFFSET WHEN -1 THEN DATALENGTH(QT.TEXT) ELSE QS.STATEMENT_END_OFFSET END - QS.STATEMENT_START_OFFSET)/2) + 1), /* QUERY WITHIN THE PROC */
TEXTDATA = QT.TEXT, /*THE SQL TEXT THAT WAS EXECUTED*/
DISKREADS = QS.TOTAL_PHYSICAL_READS, /* THE WORST READS, DISK READS */
MEMORYREADS = QS.TOTAL_LOGICAL_READS, /* LOGICAL READS ARE MEMORY READS */
EXECUTIONS = QS.EXECUTION_COUNT, /* THE COUNTS OF THE QUERY BEING EXECUTED SINCE REBOOT */
TOTALCPUTIME_MS = QS.TOTAL_WORKER_TIME/1000, /* THE CPU TIME THAT THE QUERY CONSUMES */
AVERAGECPUTIME_MS = QS.TOTAL_WORKER_TIME/(1000*QS.EXECUTION_COUNT), /*THE AVERAGE CPU TIME FOR THE QUERY */
AVGDISKWAITANDCPUTIME_MS = QS.TOTAL_ELAPSED_TIME/(1000*QS.EXECUTION_COUNT), /* THE AVERAGE DURATION TO EXECUTE THE PLAN - CPU AND DISK */
MEMORYWRITES = QS.MAX_LOGICAL_WRITES,
DATECACHED = QS.CREATION_TIME,
DATABASENAME = DB_NAME(QT.DBID),
LASTEXECUTIONTIME = QS.LAST_EXECUTION_TIME
FROM SYS.DM_EXEC_QUERY_STATS AS QS
CROSS APPLY SYS.DM_EXEC_SQL_TEXT(QS.SQL_HANDLE) AS QT
WHERE DB_NAME(QT.DBID) = 'MPI_PROD' 
ORDER BY TOTAL_LOGICAL_READS DESC;
